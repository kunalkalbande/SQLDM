<ManagementPack ContentReadable="true" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Manifest>
    <Identity>
      <ID>Idera.SQLDM</ID>
      <Version>1.0.14.34</Version>
    </Identity>
    <Name>Idera.SQLDM</Name>
    <References>
      <Reference Alias="SCDW">
        <ID>Microsoft.SystemCenter.DataWarehouse.Library</ID>
        <Version>6.1.7221.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="SC">
        <ID>Microsoft.SystemCenter.Library</ID>
        <Version>6.1.7221.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Windows">
        <ID>Microsoft.Windows.Library</ID>
        <Version>6.1.7221.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Health">
        <ID>System.Health.Library</ID>
        <Version>6.1.7221.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="System">
        <ID>System.Library</ID>
        <Version>6.1.7221.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
    </References>
  </Manifest>
  <TypeDefinitions>
    <EntityTypes>
      <ClassTypes>
        <ClassType ID="Idera.SQLDM.DMservice" Accessibility="Public" Abstract="false" Base="Windows!Microsoft.Windows.LocalApplication" Hosted="true" Singleton="false">
          <Property ID="Version" Type="string" Key="false" CaseSensitive="false" MinLength="0" Length="256" />
          <Property ID="DmPath" Type="string" Key="false" CaseSensitive="false" MinLength="0" Length="256" />
          <Property ID="DmDatabase" Type="string" Key="false" CaseSensitive="false" MinLength="0" Length="256" />
        </ClassType>
        <ClassType ID="Idera.SQLDM.SqlInstance" Accessibility="Public" Abstract="false" Base="Windows!Microsoft.Windows.ApplicationComponent" Hosted="true" Singleton="false">
          <Property ID="InstanceName" Type="string" Key="true" CaseSensitive="false" MinLength="0" Length="256" />
          <Property ID="RealServerName" Type="string" Key="false" CaseSensitive="false" MinLength="0" Length="256" />
          <Property ID="ServerVersion" Type="string" Key="false" CaseSensitive="false" MinLength="0" Length="256" />
          <Property ID="ServerEdition" Type="string" Key="false" CaseSensitive="false" MinLength="0" Length="256" />
          <Property ID="MaintenanceModeEnabled" Type="bool" Key="false" CaseSensitive="false" MinLength="0" Length="1" />
        </ClassType>
      </ClassTypes>
      <RelationshipTypes>
        <RelationshipType ID="Idera.SQLDM.SqldmHostsSqlInstance" Accessibility="Internal" Abstract="false" Base="System!System.Hosting">
          <Source>Idera.SQLDM.DMservice</Source>
          <Target>Idera.SQLDM.SqlInstance</Target>
        </RelationshipType>
      </RelationshipTypes>
    </EntityTypes>
    <ModuleTypes>
      <DataSourceModuleType ID="Idera.SQLDM.DataSource.SqlInst.AlertCounts" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="InstanceName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="SchedScript" TypeID="Idera.SQLDM.Timed.PoSh.PropertyBagProvider">
                <Debug>$Config/Debug$</Debug>
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
              </DataSource>
              <ConditionDetection ID="Filter" TypeID="System!System.ExpressionFilter">
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">Property[@Name='InstanceName']</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Config/InstanceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </ConditionDetection>
            </MemberModules>
            <Composition>
              <Node ID="Filter">
                <Node ID="SchedScript" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="Idera.SQLDM.DataSource.SqlInst.AlertData" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="InstanceName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="string" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="SchedPoll" TypeID="Idera.SQLDM.Timed.PoSH.DMalert.Poller">
                <Debug>$Config/Debug$</Debug>
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
              </DataSource>
              <ConditionDetection ID="Filter" TypeID="System!System.ExpressionFilter">
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">Property[@Name='InstanceName']</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Config/InstanceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </ConditionDetection>
            </MemberModules>
            <Composition>
              <Node ID="Filter">
                <Node ID="SchedPoll" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="Idera.SQLDM.DataSource.SqlInst.AlertData.MapToEvent" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="InstanceName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="string" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="InstAlerts" TypeID="Idera.SQLDM.DataSource.SqlInst.AlertData">
                <Debug>$Config/Debug$</Debug>
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
                <InstanceName>$Config/InstanceName$</InstanceName>
              </DataSource>
              <ConditionDetection ID="Mapper" TypeID="System!System.Event.GenericDataMapper">
                <EventOriginId>$MPElement$</EventOriginId>
                <PublisherId>$MPElement$</PublisherId>
                <PublisherName>$Data/Property[@Name='Heading']$</PublisherName>
                <Channel>SQL DM</Channel>
                <LoggingComputer>$Target/Host/Host/Property[Type='Windows!Microsoft.Windows.Computer']/NetworkName$</LoggingComputer>
                <EventNumber>$Data/Property[@Name='Metric']$</EventNumber>
                <EventCategory>0</EventCategory>
                <EventLevel>$Data/Property[@Name='OMSeverity']$</EventLevel>
                <UserName>None</UserName>
                <Description><![CDATA[%11]]></Description>
                <Params>
                  <Param>$Data/Property[@Name='InstanceName']$</Param>
                  <Param>$Data/Property[@Name='OccurredUTC']$</Param>
                  <Param>$Data/Property[@Name='DBName']$</Param>
                  <Param>$Data/Property[@Name='TblName']$</Param>
                  <Param>$Data/Property[@Name='Severity']$</Param>
                  <Param>$Data/Property[@Name='SevString']$</Param>
                  <Param>$Data/Property[@Name='SevChange']$</Param>
                  <Param>$Data/Property[@Name='SevChangeStr']$</Param>
                  <Param>$Data/Property[@Name='Value']$</Param>
                  <Param>$Data/Property[@Name='Heading']$</Param>
                  <Param>$Data/Property[@Name='Message']$</Param>
                </Params>
              </ConditionDetection>
            </MemberModules>
            <Composition>
              <Node ID="Mapper">
                <Node ID="InstAlerts" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.Event.Data</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="Idera.SQLDM.DMalert.MapToEvent.DataSource" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="string" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="Poller" TypeID="Idera.SQLDM.Timed.PoSH.DMalert.Poller">
                <Debug>$Config/Debug$</Debug>
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
              </DataSource>
              <ConditionDetection ID="Mapper" TypeID="System!System.Event.GenericDataMapper">
                <EventOriginId>$MPElement$</EventOriginId>
                <PublisherId>$MPElement$</PublisherId>
                <PublisherName>$Data/Property[@Name='InstanceName']$</PublisherName>
                <Channel>SQL DM</Channel>
                <LoggingComputer>$Target/Host/Property[Type='Windows!Microsoft.Windows.Computer']/NetworkName$</LoggingComputer>
                <EventNumber>$Data/Property[@Name='Metric']$</EventNumber>
                <EventCategory>0</EventCategory>
                <EventLevel>$Data/Property[@Name='OMSeverity']$</EventLevel>
                <UserName>None</UserName>
                <Description>$Data/Property[@Name='Message']$</Description>
                <Params>
                  <Param>$Data/Property[@Name='InstanceName']$</Param>
                  <Param>$Data/Property[@Name='OccurredUTC']$</Param>
                  <Param>$Data/Property[@Name='DBName']$</Param>
                  <Param>$Data/Property[@Name='TblName']$</Param>
                  <Param>$Data/Property[@Name='Severity']$</Param>
                  <Param>$Data/Property[@Name='SevString']$</Param>
                  <Param>$Data/Property[@Name='SevChange']$</Param>
                  <Param>$Data/Property[@Name='SevChangeStr']$</Param>
                  <Param>$Data/Property[@Name='Value']$</Param>
                  <Param>$Data/Property[@Name='Heading']$</Param>
                </Params>
              </ConditionDetection>
            </MemberModules>
            <Composition>
              <Node ID="Mapper">
                <Node ID="Poller" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.Event.Data</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="Idera.SQLDM.Timed.PoSH.DMalert.Poller" Accessibility="Internal" Batching="false">
        <Configuration>
          <IncludeSchemaTypes>
            <SchemaType>Windows!Microsoft.Windows.PowerShellSchema</SchemaType>
          </IncludeSchemaTypes>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="string" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="Timer" TypeID="System!System.SimpleScheduler">
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
              </DataSource>
              <ProbeAction ID="Script" TypeID="Windows!Microsoft.Windows.PowerShellPropertyBagProbe">
                <ScriptName>SqlInstanceEvents.ps1</ScriptName>
                <ScriptBody>
                  <![CDATA[
# Display all alerts (first time with 24 hours and max count 300)
# Repeat this process each 2 min -&amp;gt; 120 seconds
# Prevent error messages about DM MP in Event Viewer log
# Display data in Alerts view

#==================================================================================
# Script: 	SqlInstanceEvents.ps1
# Date:		1/2/13	
# Author: 	Martin Dey, Xtreme Consulting
# Purpose:	Checvcs 
#the Alerts counts for all currently monitored SQL instances
#			and outputs their counts in a property 
#bag per instance
#==================================================================================

param($dmDb, $dmPath)

#Constants used for event logging
$debug = $true
$SCRIPT_NAME			= 'SqlInstanceEvents.vbs'
$EVENT_LEVEL_ERROR 		= 1
$EVENT_LEVEL_WARNING 	= 2
$EVENT_LEVEL_INFO 		= 4
$SCRIPT_STARTED			= 831
$PROPERTYBAG_CREATED	= 832
$DUMMY_PROPERTYBAG      = 833
$SCRIPT_ENDED			= 835
$SCRIPT_FAILED          = 839

#==================================================================================
# Sub:       Log-TxtFile
# Purpose:   Logs an informational event to TXT log file, only 
#            if Debug key is true in Windows Registry &amp;gt;&amp;gt; SQLdm
#==================================================================================
function
Log-TxtFile {
param($logPath, $message)

$currentDate = Get-Date;
$logFile = $currentDate.ToString("yyyy-MM-dd")

$logFile = "\Logs\SQLdm_MP_" + $logFile + ".log"
if (Test-Path  ($logPath + $logFile)) {
Add-Content ($logPath + $logFile) ("`n" + $currentDate + " - " + $SCRIPT_NAME + " - " + $message)
}
else {
Set-Content ($logPath + $logFile) ("`n" + $currentDate + " - " + $SCRIPT_NAME + " - " + $message)
}

}

#==================================================================================
#Sub:		Log-DebugEvent
# Purpose:	Logs an informational event to the Operations Manager event log

#only if Debug argument is true
#==================================================================================
function
Log-DebugEvent
{
param($eventNo,$message,$logPath)
$debugTxt=$true
if ($debugTxt -eq $true){
Log-TxtFile $logPath $message
}

$message = "`n" + $message
if ($debug -eq $true)
{
$api.LogScriptEvent($SCRIPT_NAME,$eventNo,$EVENT_LEVEL_INFO,$message)

}
}

#==================================================================================
# Sub:Get-SqlQuery
# Purpose:    Runs a SQL Query using the SqlClient data library
# Returns:    A powershell variation on a data table - an object array with a count,
#             followed by a series of DataRow objects.
#==================================================================================
function
Get-SqlQuery($connstr, $querydm) {
$conn = New-Object System.Data.SqlClient.SQLConnection
$conn.ConnectionString= $connstr
$conn.Open()
$cmd = New-Object System.Data.SqlClient.SqlCommand($querydm, $conn)

$cmd.CommandTimeout = 120
$dset = New-Object System.Data.DataSet
$da = New-Object System.Data.SqlClient.SqlDataAdapter($cmd)

$da.fill($dset)
$conn.Close()
return $dset
}

#==================================================================================
#Sub:		Get-NonNull
# Purpose:	If the passed value is DBNull then return the string "(null)"
# Returns:The input ior a string "(null)"
#==================================================================================
function
Get-NonNull( $in ) {
if ($in.GetType().Name -eq 'DBNull') {
$out = "(null)"
} else {

$out = $in
}
return $out
}

#==================================================================================
#Sub:        Get-DmServerInstance
# Purpose:    Read 'SQLdmManagementService.exe.Config' file to get DMserver instance
# Returns:    The serverInstance as a string
#==================================================================================
function
Get-DmServerInstance( $dmPath ) {

[xml]$dmxml = (Get-Content ($dmPath + "SQLdmManagementService.exe.Config"))

$serverInstance = $dmxml.SelectSingleNode("/configuration/Idera.SQLdm/Services/ManagementService/@repositoryServer").Value

return $serverInstance
}

#DEBUG MODE
$debugTxt = (Get-ItemProperty "HKLM:\SOFTWARE\Idera\SQLdm").FlagLog

#GET MOM SCRIPTING OBJECT
# Start by setting up API object and creating a discovery data object.
$api= New-Object -comObject 'MOM.ScriptAPI'
Log-DebugEvent $SCRIPT_STARTED 'Creating MOMScriptAPI object: This object is the top-level object for the scripting API.' $dmPath

$messageParam = @"
Input parameters

SQLdm - Database name    :  {0}
SQLdm - Installation path:  {1}
"@
Log-DebugEvent $SCRIPT_STARTED ($messageParam -f $dmDb, $dmPath) $dmPath

# DEFINE TRAP TO CAPTURE ERRORS
# Trap statement will catch enay Exceptions and send details to the event log before exiting
# We always send direct to the eventlog - overriding the $debug flag - so we always log errors
trap {
$tmsg = "SQL DM Instance EventScript experienced an exception:`n`n$_"
Log-DebugEvent $SCRIPT_FAILED $tmsg $dmPath
$api.LogScriptEvent($SCRIPT_NAME,$SCRIPT_FAILED, $EVENT_LEVEL_ERROR, $tmsg)
exit
}

# STATIC STRING DEFINITIONS
# Set up the SQL queriesand strings we will need later
$dmServerInstance = (Get-DmServerInstance $dmPath)
$connstr = "Server={0};Database={1};Integrated Security=True" -f $dmServerInstance, $dmDb

$sqltmp  = @"
SELECT  [AlertID]
 ,[UTCOccurrenceDateTime]
 
,[ServerName]
 ,isnull([DatabaseName], 'N/A') as [DatabaseName]
 ,isnull([TableName], 'N/A') as [TableName]
 
,[Metric]
 ,[Severity]
 ,[StateEvent]
 ,[Value]
 ,isnull([Heading], 'N/A') as [Heading]
 ,isnull([Message], 
'N/A') as [Message]
 FROM [dbo].[Alerts]
      JOIN [dbo].[MonitoredSQLServers]
      ON [dbo].[Alerts].[ServerName] 
= [dbo].[MonitoredSQLServers].[InstanceName]
	  JOIN (SELECT DISTINCT SCOMAlertEvent.MetricID, SCOMAlertEvent.IsInSCOMAsAlert FROM SCOMAlertEvent) SAE ON SAE.MetricID = [Alerts].Metric
 WHERE ([UTCOccurrenceDateTime] BETWEEN '{0}' AND '{1}') 
AND [dbo].[MonitoredSQLServers].[Active] = 1
       AND [ServerName] IS NOT NULL AND ([StateEvent] NOT 
IN ( 0x22, 0x44, 0x52 ))
AND SAE.IsInSCOMAsAlert = 0
 ORDER BY [UTCOccurrenceDateTime] DESC
"@

# GET MOM REGISTRY AREA
# This callpulls a guaranteed unique Reg key for this monitor so we can save the last time we gathered events
Log-DebugEvent $EVENT_LEVEL_INFO 'Calling to MOMScriptAPI.GetScriptStateKeyPath method.' $dmPath
$regpath = $api.GetScriptStateKeyPath("Idera.SQLDM")

#CHeck if there is a "LastEventImport" timestamp stored
if ((get-itemproperty "HKLM:\$regpath" LastEventImportTime -ea 0).LastEventImportTime) {
# We have found the last time we imported Alerts as events, so save that value for later and rest "FirstTime" flag
$lastTime = [datetime](get-itemproperty "HKLM:\$regpath" LastEventImportTime).LastEventImportTime

$hasFirstTime = $false
} else {
# This appears to be our first pass, so we will pick up alerts from the past hour
$lastTime = (Get-Date).AddHours(-24)


$hasFirstTime = $true
}

# Set the "now" timestamp up to which we will query, and save this to the registry
#Be sure to save it as UTC time so we will be unaffected by DST etc
$currentTime = Get-Date 
Set-ItemProperty "HKLM:\$regpath" LastEventImportTime $currentTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fffZ")

#GET ALERT LIST
# Use SQL to retrieve all SQL DM Alerts raised since we last polled
$sqlqry = $sqltmp -f $lastTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fff"), $currentTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fff")

$alerts = (Get-SqlQuery $connstr $sqlqry)

$queryMessage = @"
SQL DM Instance Event Script
started
Connection String     :  {0}
Last import time      :  {1}
Current time          :
{2}
First collection time :  {3}
"@
$msg = $queryMessage -f $connstr, $lastTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fff"), $currentTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fff"), $hasFirstTime

Log-DebugEvent $SCRIPT_STARTED $msg $dmPath

$messalerts = @"
SQL Server alerts started
SQL Alerts:  {0}
"@

$msg= $messalerts -f ($alerts.Tables[0].Rows.count)
Log-DebugEvent $SCRIPT_STARTED $msg $dmPath

if ($alerts.Tables[0].Rows.count-lt 1) {
# No alerts found so don't create a Property Bag
# Generate a Log message for this "NoAlert" case
Log-DebugEvent $DUMMY_PROPERTYBAG "No Alerts found during the previous poll - No Property Bag returned" $dmPath
exit
} else {
# DEFINE DICTIONARIES FOR LOOKUPS
# We use these later to transform state and state changes into handy strings
# $sevtab maps DM Severity to a string
$sevtab= @{ 0x00="None";  0x01="OK"; 0x02="Informational"; 0x04="Warning"; 0x08="Critical"}
# $sevmap maps DM Severity to the OpsMan EventLevel
$sevmap = @{ 0x00=0;       0x01=0;    0x02=4; 0x04=2;         0x08=1}
# $Chgtab maps the state changes to a friendly string
$chgtab = @{

0x12 = "OK to Warning";
0x13 = "OK to Informational";
0x14 = "OK to Critical";

0x21 = "Warning to OK";
0x22 = "Warning to Warning";
0x23 = "Warning to Informational";

0x24 = "Warning to Critical";
0x41 = "Critical to OK";
0x42 = "Critical to Warning";

0x43 = "Critical to Informational";
0x44 = "Critical to Critical";
0x51 = "Informational
to OK";
0x52 = "Informational to Informational";
0x53 = "Informational to Warning";

0x54 = "Informational to Critical"}

# LOOP THROUGH EACH ALERT - PASSING ALL DETAILS IN A PROPERTYBAG

# Create a propertybag per Alert row and pack the details into it
# and the instance name (for filtering) in each bag

foreach ($alert in $alerts.Tables[0].Rows) {
# Logging row data to know if there is or not NULL
$msg = 'Submitted Alert Data Property Bag' + "`n" + '    For instance:  ' + $alert.ServerName + "`n" + '    Timestamp    :  ' + $alert.UTCOccurrenceDateTime.ToString("yyyy-MM-dd HH:mm:ss.fff") + "`n" + '    Severity     :  ' + $alert.Severity + ' (' + $sevtab[[int]$alert.Severity]+ ')' + "`n" + '    Sev Change   :  ' + $alert.StateEvent + ' (' + $chgtab[[int]$alert.StateEvent]+ ')' + "`n" + '    Table Name   :  ' + $alert.TableName + "`n" + 'Database Name:  ' + $alert.DatabaseName + "`n" + '    Metric       :  ' + $alert.Metric+ "`n" + '    Value        :  ' + $alert.Value + "`n" + '    AlertTitle  :  ' + $alert.Heading + "`n" + '    Alert Message:  ' + $alert.Message


Log-DebugEvent $EVENT_LEVEL_INFO $msg $dmPath

#Create a property bag for this Alert
Log-DebugEvent $EVENT_LEVEL_INFO 'Creating MOMPropertyBag object' $dmPath
$bag = $api.CreatePropertyBag()


# Now pump the alert data into a new Property bag
# Include the InstanceName so we can filter the bag later

$bag.AddValue('InstanceName',      (Get-NonNull $alert.ServerName))
$bag.AddValue('AlertID',(Get-NonNull $alert.AlertID))
$bag.AddValue('OccurredUTC',       (Get-NonNull $alert.UTCOccurrenceDateTime.ToString("yyyy-MM-dd HH:mm:ss.fffZ")))
$bag.AddValue('DBName',            (Get-NonNull $alert.DatabaseName))
$bag.AddValue('TblName',         (Get-NonNull $alert.TableName))
$bag.AddValue('Severity',          (Get-NonNull $alert.Severity))

$bag.AddValue('OMSeverity',        (Get-NonNull $sevmap[[int]$alert.Severity]))
$bag.AddValue('SevString',(Get-NonNull $sevtab[[int]$alert.Severity]))
$bag.AddValue('SevChange',         (Get-NonNull $alert.StateEvent))

$bag.AddValue('SevChangeStr',      (Get-NonNull $chgtab[[int]$alert.StateEvent]))
$bag.AddValue('Value',(Get-NonNull $alert.Value))
$bag.AddValue('Heading',           (Get-NonNull $alert.Heading))

$bag.AddValue('Message',           (Get-NonNull $alert.Message))
$bag.AddValue('Metric',(Get-NonNull $alert.Metric))


# Generate a Log message for this alert instance
$msg = @"
Submitted
Alert Data Property Bag
For instance:   {0}
Timestamp:      {1}
Severity:       {2} ({3})
Sev Change:
{4} ({5})
Alert Title:    {6}
Alert Message:
{7}
"@

Log-DebugEvent $PROPERTYBAG_CREATED ($msg -f$alert.ServerName, $alert.UTCOccurrenceDateTime.ToString("yyyy-MM-dd HH:mm:ss.fffZ"),$alert.Severity, $sevtab[[int]$alert.Severity], $alert.StateEvent, $chgtab[[int]$alert.StateEvent],$alert.Heading, $alert.Message) $dmPath

#Return each property bag if an event as we create and populateit.
$bag
}
} # End of "If no alerts found"
Log-DebugEvent $SCRIPT_ENDED 'SQL Instance Event Script ended.' $dmPath
				  ]]>
                </ScriptBody>
                <Parameters>
                  <Parameter>
                    <Name>dmDb</Name>
                    <Value>$Target/Host/Property[Type="Idera.SQLDM.DMservice"]/DmDatabase$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>dmPath</Name>
                    <Value>$Target/Host/Property[Type="Idera.SQLDM.DMservice"]/DmPath$</Value>
                  </Parameter>
                </Parameters>
                <TimeoutSeconds>120</TimeoutSeconds>
              </ProbeAction>
            </MemberModules>
            <Composition>
              <Node ID="Script">
                <Node ID="Timer" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
	  <!-- SQLDM 10.1 Barkha khatri getting data from DM Repo using powershell script -->
      <DataSourceModuleType ID="Idera.SQLDM.Timed.PoSH.DMalert.AlertPoller" Accessibility="Internal" Batching="false">
        <Configuration>
          <IncludeSchemaTypes>
            <SchemaType>Windows!Microsoft.Windows.PowerShellSchema</SchemaType>
          </IncludeSchemaTypes>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="string" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="Timer" TypeID="System!System.SimpleScheduler">
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
              </DataSource>
              <ProbeAction ID="Script" TypeID="Windows!Microsoft.Windows.PowerShellPropertyBagProbe">
                <ScriptName>SqlInstanceAlerts.ps1</ScriptName>
                <ScriptBody>
                  <![CDATA[
# Display all alerts (first time with 24 hours and max count 300)
# Repeat this process each 2 min -&amp;amp;gt; 120 seconds
# Prevent error messages about DM MP in Event Viewer log
# Display data in Alerts view

#==================================================================================
# Script: 	SqlInstanceAlerts.ps1
# Date:		1/2/13	
# Author: 	Martin Dey, Xtreme Consulting
# Purpose:	Checvcs the Alerts counts for all currently monitored SQL instances
#			and outputs their counts in a property bag per instance
#==================================================================================

param($dmDb, $dmPath)

#Constants used for event logging
$debug = $true
$SCRIPT_NAME			= 'SqlInstanceAlerts.vbs'
$EVENT_LEVEL_ERROR 		= 1
$EVENT_LEVEL_WARNING 	= 2
$EVENT_LEVEL_INFO 		= 4
$SCRIPT_STARTED			= 831
$PROPERTYBAG_CREATED	= 832
$DUMMY_PROPERTYBAG      = 833
$SCRIPT_ENDED			= 835
$SCRIPT_FAILED          = 839

#==================================================================================
# Sub:       Log-TxtFile
# Purpose:   Logs an informational event to TXT log file, only 
#            if Debug key is true in Windows Registry &amp;amp;gt;&amp;amp;gt; SQLdm
#==================================================================================
function
Log-TxtFile {
param($logPath, $message)

$currentDate = Get-Date;
$logFile = $currentDate.ToString("yyyy-MM-dd")

$logFile = "\Logs\SQLdm_MP_" + $logFile + ".log"
if (Test-Path  ($logPath + $logFile)) {
Add-Content ($logPath + $logFile) ("`n" + $currentDate + " - " + $SCRIPT_NAME + " - " + $message)
}
else {
Set-Content ($logPath + $logFile) ("`n" + $currentDate + " - " + $SCRIPT_NAME + " - " + $message)
}

}

#==================================================================================
#Sub:		Log-DebugEvent
# Purpose:	Logs an informational event to the Operations Manager event log

#only if Debug argument is true
#==================================================================================
function
Log-DebugEvent
{
param($eventNo,$message,$logPath)
$debugTxt=$true
if ($debugTxt -eq $true){
Log-TxtFile $logPath $message
}

$message = "`n" + $message
if ($debug -eq $true)
{
$api.LogScriptEvent($SCRIPT_NAME,$eventNo,$EVENT_LEVEL_INFO,$message)

}
}

#==================================================================================
# Sub:Get-SqlQuery
# Purpose:    Runs a SQL Query using the SqlClient data library
# Returns:    A powershell variation on a data table - an object array with a count,
#             followed by a series of DataRow objects.
#==================================================================================
function
Get-SqlQuery($connstr, $querydm) {
$conn = New-Object System.Data.SqlClient.SQLConnection
$conn.ConnectionString= $connstr
$conn.Open()
$cmd = New-Object System.Data.SqlClient.SqlCommand($querydm, $conn)

$cmd.CommandTimeout = 120
$dset = New-Object System.Data.DataSet
$da = New-Object System.Data.SqlClient.SqlDataAdapter($cmd)
$da.fill($dset)
$conn.Close()
return $dset
}

#==================================================================================
#Sub:		Get-NonNull
# Purpose:	If the passed value is DBNull then return the string "(null)"
# Returns:The input ior a string "(null)"
#==================================================================================
function
Get-NonNull( $in ) {
if ($in.GetType().Name -eq 'DBNull') {
$out = "(null)"
} else {

$out = $in
}
return $out
}

#==================================================================================
#Sub:        Get-DmServerInstance
# Purpose:    Read 'SQLdmManagementService.exe.Config' file to get DMserver instance
# Returns:    The serverInstance as a string
#==================================================================================
function
Get-DmServerInstance( $dmPath ) {

[xml]$dmxml = (Get-Content ($dmPath + "SQLdmManagementService.exe.Config"))

$serverInstance = $dmxml.SelectSingleNode("/configuration/Idera.SQLdm/Services/ManagementService/@repositoryServer").Value

return $serverInstance
}

#DEBUG MODE
$debugTxt = (Get-ItemProperty "HKLM:\SOFTWARE\Idera\SQLdm").FlagLog

#GET MOM SCRIPTING OBJECT
# Start by setting up API object and creating a discovery data object.
$api= New-Object -comObject 'MOM.ScriptAPI'

Log-DebugEvent $SCRIPT_STARTED 'Creating MOMScriptAPI object:This object is the top-level object for the scripting API.' $dmPath

$messageParam = @"
Input parameters

SQLdm - Database name    :  {0}
SQLdm - Installation path:  {1}
"@

Log-DebugEvent $SCRIPT_STARTED ($messageParam -f $dmDb, $dmPath) $dmPath

# DEFINE TRAP TO CAPTURE ERRORS
# Trap statement will catchenay Exceptions and send details to the event log before exiting
# We always send direct to the event log - overriding the $debug flag - so we always log errors
trap {
$tmsg = "SQL DM Instance Alert Script experienced an exception:`n`n$_"
Log-DebugEvent $SCRIPT_FAILED $tmsg $dmPath
$api.LogScriptEvent($SCRIPT_NAME,$SCRIPT_FAILED, $EVENT_LEVEL_ERROR, $tmsg)
exit
}

# STATIC STRING DEFINITIONS
# Set up the SQL queries and strings we will need later
$dmServerInstance = (Get-DmServerInstance $dmPath)
$connstr = "Server={0};Database={1};Integrated Security=True" -f $dmServerInstance, $dmDb


$sqltmp  = @"
SELECT  [AlertID]
 ,[UTCOccurrenceDateTime]
 
,[ServerName]
 ,isnull([DatabaseName], 'N/A') as [DatabaseName]
 ,isnull([TableName], 'N/A') as [TableName]
 
,[Metric]
 ,[Severity]
 ,[StateEvent]
 ,[Value]
 ,isnull([Heading], 'N/A') as [Heading]
 ,isnull([Message], 
'N/A') as [Message]
 FROM [dbo].[Alerts]
      JOIN [dbo].[MonitoredSQLServers]
      ON [dbo].[Alerts].[ServerName] 
= [dbo].[MonitoredSQLServers].[InstanceName]
	  JOIN (SELECT DISTINCT SCOMAlertEvent.MetricID, SCOMAlertEvent.IsInSCOMAsAlert FROM SCOMAlertEvent) SAE ON SAE.MetricID = [Alerts].Metric
 WHERE ([UTCOccurrenceDateTime] BETWEEN '{0}' AND '{1}') 
AND [dbo].[MonitoredSQLServers].[Active] = 1
       AND [ServerName] IS NOT NULL AND ([StateEvent] NOT 
IN ( 0x22, 0x44, 0x52 ))
AND SAE.IsInSCOMAsAlert = 1
 ORDER BY [UTCOccurrenceDateTime] DESC
"@

# GET MOM REGISTRY AREA
# This callpulls a guaranteed unique Reg key for this monitor so we can save the last time we gathered events
Log-DebugEvent $EVENT_LEVEL_INFO 'Calling to MOMScriptAPI.GetScriptStateKeyPath method.' $dmPath
$regpath = $api.GetScriptStateKeyPath("Idera.SQLDM")



#CHeck if there is a "LastAlertImport" timestamp stored
if ((get-itemproperty "HKLM:\$regpath" LastAlertImportTime -ea 0).LastAlertImportTime) {
# We have found the last time we imported Alerts as events, so save that value for later and rest "FirstTime" flag
$lastTime = [datetime](get-itemproperty "HKLM:\$regpath" LastAlertImportTime).LastAlertImportTime
$hasFirstTime = $false
} else {
# This appears to be our first pass, so we will pick up alerts from the past hour
$lastTime = (Get-Date).AddHours(-24)


$hasFirstTime = $true
}

# Set the "now" timestamp up to which we will query, and save this to the registry
#Be sure to save it as UTC time so we will be unaffected by DST etc
$currentTime = Get-Date 
Set-ItemProperty "HKLM:\$regpath" LastAlertImportTime $currentTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fffZ")

#GET ALERT LIST
# Use SQL to retrieve all SQL DM Alerts raised since we last polled
$sqlqry = $sqltmp -f $lastTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fff"), $currentTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fff")

$alerts = (Get-SqlQuery $connstr $sqlqry)

$queryMessage = @"
SQL DM Instance Event Script
started
Connection String     :  {0}
Last import time      :  {1}
Current time          :
{2}
First collection time :  {3}
"@
$msg = $queryMessage -f $connstr, $lastTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fff"), $currentTime.ToUniversalTime().ToString("yyyy-MM-dd HH:mm:ss.fff"), $hasFirstTime

Log-DebugEvent $SCRIPT_STARTED $msg $dmPath

$messalerts = @"
SQL Server alerts started
SQL Alerts:  {0}
"@

$msg= $messalerts -f ($alerts.Tables[0].Rows.count)
Log-DebugEvent $SCRIPT_STARTED $msg $dmPath
if ($alerts.Tables[0].Rows.count -lt 1) {

# No alerts found so don't create a Property Bag
# Generate a Log message for this "No Alert" case
Log-DebugEvent $DUMMY_PROPERTYBAG "No Alerts found during the previous poll - No Property Bag returned" $dmPath
exit
} else {
# DEFINE DICTIONARIES FOR LOOKUPS
# We use these later to transform state and state changes into handy strings
# $sevtab maps DM Severity to a string
$sevtab= @{ 0x00="None";  0x01="OK"; 0x02="Informational"; 0x04="Warning"; 0x08="Critical"}
# $sevmap maps DM Severity to the OpsMan EventLevel
$sevmap = @{ 0x00=0;       0x01=0;    0x02=0;
0x04=1;         0x08=2}
# $Chgtab maps the state changes to a friendly string
$chgtab = @{

0x12 = "OK to Warning";
0x13 = "OK to Informational";
0x14 = "OK to Critical";

0x21 = "Warning to OK";
0x22 = "Warning to Warning";
0x23 = "Warning to Informational";

0x24 = "Warning to Critical";
0x41 = "Critical to OK";
0x42 = "Critical to Warning";

0x43 = "Critical to Informational";
0x44 = "Critical to Critical";
0x51 = "Informational
to OK";
0x52 = "Informational to Informational";
0x53 = "Informational to Warning";

0x54 = "Informational to Critical"}

# LOOP THROUGH EACH ALERT - PASSING ALL DETAILS IN A PROPERTYBAG

# Create a propertybag per Alert row and pack the details into it
# and the instance name (for filtering) in each bag
foreach ($alert in $alerts.Tables[0].Rows) 
{
# Logging row data to know if there isor not NULL
$msg = 'Submitted Alert Data Property Bag' + "`n" + '    For instance:  ' + $alert.ServerName + "`n" + '    Timestamp    :  ' + $alert.UTCOccurrenceDateTime.ToString("yyyy-MM-dd HH:mm:ss.fff") + "`n" + '    Severity     :  ' + $alert.Severity + ' (' + $sevtab[[int]$alert.Severity]+ ')' + "`n" + '    Sev Change   :  ' + $alert.StateEvent + ' (' + $chgtab[[int]$alert.StateEvent]+ ')' + "`n" + '    Table Name   :  ' + $alert.TableName + "`n" + 'Database Name:  ' + $alert.DatabaseName + "`n" + '    Metric       :  ' + $alert.Metric+ "`n" + '    Value        :  ' + $alert.Value + "`n" + '    AlertTitle  :  ' + $alert.Heading + "`n" + '    Alert Message:  ' + $alert.Message


Log-DebugEvent $EVENT_LEVEL_INFO $msg $dmPath

#Create a property bag for this Alert
Log-DebugEvent $EVENT_LEVEL_INFO 'Creating MOMPropertyBag object' $dmPath
$bag = $api.CreatePropertyBag()


# Now pump the alert data into a new Property bag
# Include the InstanceName so we can filter the bag later

$bag.AddValue('InstanceName',      (Get-NonNull $alert.ServerName))
$bag.AddValue('AlertID',(Get-NonNull $alert.AlertID))
$bag.AddValue('OccurredUTC',       (Get-NonNull $alert.UTCOccurrenceDateTime.ToString("yyyy-MM-dd HH:mm:ss.fffZ")))
$bag.AddValue('DBName',            (Get-NonNull $alert.DatabaseName))
$bag.AddValue('TblName',         (Get-NonNull $alert.TableName))
$bag.AddValue('Severity',          (Get-NonNull $alert.Severity))

$bag.AddValue('OMSeverity',        (Get-NonNull $sevmap[[int]$alert.Severity]))
$bag.AddValue('SevString',(Get-NonNull $sevtab[[int]$alert.Severity]))
$bag.AddValue('SevChange',         (Get-NonNull $alert.StateEvent))

$bag.AddValue('SevChangeStr',      (Get-NonNull $chgtab[[int]$alert.StateEvent]))
$bag.AddValue('Value',(Get-NonNull $alert.Value))
$bag.AddValue('Heading',           (Get-NonNull $alert.Heading))

$bag.AddValue('Message',           (Get-NonNull $alert.Message))
$bag.AddValue('Metric',(Get-NonNull $alert.Metric))
$bag.AddValue('GenerateAlert', "True")

# Generate a Log message for this alert instance
$msg = @"
Submitted
Alert Data Property Bag
For instance:   {0}
Timestamp:      {1}
Severity:       {2} ({3})
Sev Change:
{4} ({5})
Alert Title:    {6}
Alert Message:
{7}
"@

Log-DebugEvent $PROPERTYBAG_CREATED ($msg -f $alert.ServerName, $alert.UTCOccurrenceDateTime.ToString("yyyy-MM-dd HH:mm:ss.fffZ"),$alert.Severity, $sevtab[[int]$alert.Severity], $alert.StateEvent, $chgtab[[int]$alert.StateEvent],$alert.Heading, $alert.Message) $dmPath

#Return each property bag if an event as we create and populateit.
$bag
}

} # End of "If no alerts found"
Log-DebugEvent $SCRIPT_ENDED 'SQL Instance Alert Script ended.' $dmPath
                  ]]>
                </ScriptBody>
                <Parameters>
                  <Parameter>
                    <Name>dmDb</Name>
                    <Value>$Target/Host/Property[Type="Idera.SQLDM.DMservice"]/DmDatabase$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>dmPath</Name>
                    <Value>$Target/Host/Property[Type="Idera.SQLDM.DMservice"]/DmPath$</Value>
                  </Parameter>
                </Parameters>
                <TimeoutSeconds>120</TimeoutSeconds>
              </ProbeAction>
            </MemberModules>
            <Composition>
              <Node ID="Script">
                <Node ID="Timer" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
	  <!-- SQLDM 10.1 Barkha khatri getting DB data as input and output it to rule -->
      <DataSourceModuleType ID="Idera.SQLDM.DataSource.SqlInst.AlertsData" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="InstanceName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="string" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="SchedPoll" TypeID="Idera.SQLDM.Timed.PoSH.DMalert.AlertPoller">
                <Debug>$Config/Debug$</Debug>
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
              </DataSource>
              <ConditionDetection ID="Filter" TypeID="System!System.ExpressionFilter">
                <Expression>
                  <SimpleExpression>
                    <ValueExpression>
                      <XPathQuery Type="String">Property[@Name='InstanceName']</XPathQuery>
                    </ValueExpression>
                    <Operator>Equal</Operator>
                    <ValueExpression>
                      <Value Type="String">$Config/InstanceName$</Value>
                    </ValueExpression>
                  </SimpleExpression>
                </Expression>
              </ConditionDetection>
            </MemberModules>
            <Composition>
              <Node ID="Filter">
                <Node ID="SchedPoll" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="Idera.SQLDM.DataSource.SqlInst.AlertsData.MapToAlert" Accessibility="Internal" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="InstanceName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="string" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="InstAlerts" TypeID="Idera.SQLDM.DataSource.SqlInst.AlertsData">
                <Debug>$Config/Debug$</Debug>
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
                <InstanceName>$Config/InstanceName$</InstanceName>
              </DataSource>
              <ConditionDetection ID="Mapper" TypeID="System!System.Event.GenericDataMapper">
                <EventOriginId>$MPElement$</EventOriginId>
                <PublisherId>$MPElement$</PublisherId>
                <PublisherName>$Data/Property[@Name='Heading']$</PublisherName>
                <Channel>SQL DM</Channel>
                <LoggingComputer>$Target/Host/Host/Property[Type='Windows!Microsoft.Windows.Computer']/NetworkName$</LoggingComputer>
                <EventNumber>$Data/Property[@Name='Metric']$</EventNumber>
                <EventCategory>0</EventCategory>
                <EventLevel>$Data/Property[@Name='OMSeverity']$</EventLevel>
                <UserName>None</UserName>
                <Description><![CDATA[%11]]></Description>
                <Params>
                  <Param>$Data/Property[@Name='InstanceName']$</Param>
                  <Param>$Data/Property[@Name='OccurredUTC']$</Param>
                  <Param>$Data/Property[@Name='DBName']$</Param>
                  <Param>$Data/Property[@Name='TblName']$</Param>
                  <Param>$Data/Property[@Name='Severity']$</Param>
                  <Param>$Data/Property[@Name='SevString']$</Param>
                  <Param>$Data/Property[@Name='SevChange']$</Param>
                  <Param>$Data/Property[@Name='SevChangeStr']$</Param>
                  <Param>$Data/Property[@Name='Value']$</Param>
                  <Param>$Data/Property[@Name='Heading']$</Param>
                  <Param>$Data/Property[@Name='Message']$</Param>
                </Params>
                <!--<Priority>$Config/Priority$</Priority>
                <Severity>$Config/Severity$</Severity>
                <ManagedEntityId>$Target/Id$</ManagedEntityId>
                <AlertName>$Config/AlertName$</AlertName>
                <AlertDescription>$Config/AlertDescription$</AlertDescription>
                <AlertOwner>$Config/AlertOwner$</AlertOwner>
                <AlertMessageId>$Config/AlertMessageId$</AlertMessageId>
                <AlertParameters>$Config/AlertParameters$</AlertParameters>
                <Suppression>$Config/Suppression$</Suppression>
                <WorkflowId>$MPElement$</WorkflowId>
                <Custom1>$Config/Custom1$</Custom1>
                <Custom2>$Config/Custom2$</Custom2>
                <Custom3>$Config/Custom3$</Custom3>
                <Custom4>$Config/Custom4$</Custom4>
                <Custom5>$Config/Custom5$</Custom5>
                <Custom6>$Config/Custom6$</Custom6>
                <Custom7>$Config/Custom7$</Custom7>
                <Custom8>$Config/Custom8$</Custom8>
                <Custom9>$Config/Custom9$</Custom9>
                <Custom10>$Config/Custom10$</Custom10>
                <ManagementGroupName>$Target/ManagementGroup/Name$</ManagementGroupName>-->
              </ConditionDetection>
            </MemberModules>
            <Composition>
              <Node ID="Mapper">
                <Node ID="InstAlerts" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.Event.Data</OutputType>
      </DataSourceModuleType>
      <DataSourceModuleType ID="Idera.SQLDM.Timed.PoSh.PropertyBagProvider" Accessibility="Internal" Batching="false">
        <Configuration>
          <IncludeSchemaTypes>
            <SchemaType>Windows!Microsoft.Windows.PowerShellSchema</SchemaType>
          </IncludeSchemaTypes>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="string" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="Timer" TypeID="System!System.SimpleScheduler">
                <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
              </DataSource>
              <ProbeAction ID="Script" TypeID="Windows!Microsoft.Windows.PowerShellPropertyBagProbe">
                <ScriptName>SqlInstanceHealth.ps1</ScriptName>
                <ScriptBody>
                  <![CDATA[
#==================================================================================
# Script: 	SqlInstanceHealth.ps1
# Date:		1/2/13	
# Author: 	Martin Dey, Xtreme Consulting
# Purpose:	Checvcs the Alerts counts for all currently monitored SQL instances
#			and outputs their counts in a property bag per instance
#==================================================================================

# Get the named parameters
param($dmDb, $dmPath)

#Constants used for event logging
$debug = $true
$SCRIPT_NAME			= 'SqlInstanceHealth.vbs'
$EVENT_LEVEL_ERROR 		= 1
$VENT_LEVEL_WARNING 	= 2
$EVENT_LEVEL_INFO 		= 4
$SCRIPT_STARTED			= 821
$PROPERTYBAG_CREATED	= 822
$SCRIPT_ENDED			= 825
$SCRIPT_FAILED          = 829

#==================================================================================
# Sub:       Log-TxtFile
# Purpose:   Logs an informational event to TXT log file, only 
#            if Debug key is true in Windows Registry &amp;gt;&amp;gt; SQLdm
#==================================================================================
function 
Log-TxtFile {
    param($logPath,$message)

    $currentDate = Get-Date;
    $logFile = $currentDate.ToString("yyyy-MM-dd")
    
$logFile = "\Logs\SQLdm_MP_" + $logFile + ".log"
    if (Test-Path  ($logPath + $logFile)) {
        
Add-Content ($logPath + $logFile) ("`n" + $currentDate + " - " + $SCRIPT_NAME + " - " + $message)
    
}
    else {
        Set-Content ($logPath + $logFile) ("`n" + $currentDate + " - " + $SCRIPT_NAME + " - " + $message)
    }
}

#==================================================================================
# Sub:		Log-DebugEvent
# Purpose:	Logs an informational event to the Operations Manager event log 

#			only if Debug argument is true
#==================================================================================
function 
Log-DebugEvent
{
	param($eventNo,$message,$logPath)
	
    if ($debugTxt -eq $true){
		Log-TxtFile $logPath $message
	}
	
	$message = "`n" + $message
	if ($debug -eq $true)
	{
    	$api.LogScriptEvent($SCRIPT_NAME,$eventNo,$EVENT_LEVEL_INFO,$message)
	
}
}

#==================================================================================
# Sub:       Get-SqlQuery
# Purpose:   Runs a SQL Query using the SqlClient data library 
# Returns:   A powershell variation on a data table - an object array with a count,
#            followed by a series of DataRow objects.
#==================================================================================
function 
Get-SqlQuery( $connstr, $querydm ) {
    # Action of connecting to the Database and executing the query and returning results if there were any.
    $conn = New-Object System.Data.SqlClient.SQLConnection
    
$conn.ConnectionString = $connstr
    $conn.Open()
    $cmd = New-Object System.Data.SqlClient.SqlCommand($querydm, $conn)
    $cmd.CommandTimeout = 120
    $dset = New-Object System.Data.DataSet
    $da = New-Object System.Data.SqlClient.SqlDataAdapter($cmd)
    $da.fill($dset)
    $conn.Close()
    return $dset
}

#==================================================================================
# Sub:        Get-SPdata
# Purpose:    Runs a SQL stored procedure which returns a datatable 
# Returns:    A powershell object with a SQLparam, followed by a eow count,
#             followed by a series of DataRow objects. Get current alerts
#             to refresh for each monitored SQL Server instance.
#==================================================================================
function 
Get-SPdata( $connstr, $cmdstr, $hashparams) {
    $conn = New-Object System.Data.SqlClient.SqlConnection
    
$conn.ConnectionString = $connstr
    $conn.Open()
    $cmd  = New-Object System.Data.SqlClient.SqlCommand($cmdstr, $conn)
    $cmd.CommandTimeout = 120
    $cmd.CommandType = [System.Data.CommandType]::StoredProcedure
    
# Add the supplied parameters
    foreach ($in in $hashparams.Keys) {
        $cmd.Parameters.Add($in, $hashparams[$in]) 
    }
    $da = New-Object System.Data.SqlClient.SqlDataAdapter($cmd)
    $dset = New-Object System.Data.DataSet
    [void]$da.Fill($dset)
    $conn.Close()
    return $dset.Tables[0]
}

#==================================================================================
# Sub:      Get-DmServerInstance
# Purpose:  Read 'SQLdmManagementService.exe.Config' file to get DM server instance
# Returns:  The serverInstance as a string
#==================================================================================
function 
Get-DmServerInstance( $dmPath ) {
    [xml]$dmxml = (Get-Content ($dmPath + "SQLdmManagementService.exe.Config"))
    
$serverInstance = $dmxml.SelectSingleNode("/configuration/Idera.SQLdm/Services/ManagementService/@repositoryServer").Value
    
return $serverInstance
}

#DEBUG MODE
$debugTxt = (Get-ItemProperty "HKLM:\SOFTWARE\Idera\SQLdm").FlagLog

# GET MOM SCRIPTING OBJECT
# Start by setting up API object and creating a discovery data object.
$api = New-Object -comObject 'MOM.ScriptAPI'
Log-DebugEvent $EVENT_LEVEL_INFO 'Creating MOMScriptAPI object: This object is the top-level object for the scripting API.' $dmPath

$messageParam = @"
Input parameters
    
SQLdm - Database name    :  {0}
    SQLdm - Installation path:  {1}
"@
Log-DebugEvent $SCRIPT_STARTED ($messageParam -f $dmDb, $dmPath) $dmPath

# DEFINE TRAP TO CAPTURE ERRORS
# Trap statement will catch any Exceptions and send details to the event log before exiting
# We always send direct to the event log - overriding the $debug flag - so we always log errors
trap {
    $tmsg = "SQL DM Instance Health Script experienced an exception:`n`n$_"
	Log-DebugEvent $SCRIPT_FAILED $tmsg $dmPath
    $api.LogScriptEvent($SCRIPT_NAME,$SCRIPT_FAILED,$EVENT_LEVEL_ERROR,$tmsg)
    
exit
}

# STATIC STRING DEFINITIONS
# Set up the SQL queries and strings we will need later
$dmServerInstance = (Get-DmServerInstance $dmPath)

$connstr = "Server={0};Database={1};Integrated Security=True" -f $dmServerInstance, $dmDb

# Log a message that script is starting only if Debug argument is True
$message =  @"
SqlInstanceHealth 
script started
     Connection String: {0}
"@
Log-DebugEvent $EVENT_LEVEL_INFO ($message -f $connstr) $dmPath

$cmdstr  = "p_GetActiveAlerts"
$qrystr  = @"
 select TOP 300 InstanceName
 from [dbo].[MonitoredSQLServers]
 
WHERE [Active]=1 AND [Deleted] = 0
 ORDER BY InstanceName
"@

# GET SERVER LIST
# Build a list of the names of all actively monitored servers
$servers = (Get-SqlQuery $connstr $qrystr)
if ($servers.Tables[0].Rows.count -lt 1) { 
	# No servers found so don't match with recently alerts
	Log-DebugEvent $SCRIPT_ENDED "No monitored SQL Servers instances found" $dmPath
    exit
}

# GET ALERT LIST
# Use SQL SP to get a list of active alerts affecting SQL Instance health

$inparam = @{"@SQLServerIDs"=$null}
$alerts = (Get-SPdata $connstr $cmdstr $inparam)
$alerts = $alerts[1..($alerts.count-1)] # Remove param and row count (first 1 items in returned array)

$message =	'SQL DM Instance Health Script started' + "`n" + 'Connection Str:  ' + $connstr + "`n" + 'SQL Instances:   ' + $servers.Tables[0].Rows.count + "`n" + 'Active Alerts:   ' + $alerts.count

Log-DebugEvent $EVENT_LEVEL_INFO $message $dmPath

# LOOP THROUGH EACH SERVER - PASSING ALERTS COUNTS AND DETAILS IN A PROPERTYBAG
# Run a query per servers to get the state property data 
# And then create a propertybag per instance, and pack the alerts counts
# and the instance name (for filtering) in each bag

foreach ($svr in $servers.Tables[0].Rows) {
    # Check for Critical Alerts for the current server
    $crittxt=$null; $warntxt=$null
    $crit = @()
    foreach ($alert in $alerts){
        
if($alert.Status -eq 8 -and [string]$alert.InstanceName -eq [string]$svr.InstanceName){
            $crit += $alert
        }
    }
    
    if ($crit.count -gt 0) {
        $crittxt= ($crit | Select-Object -ExpandProperty Title) -join " /`n "
    }

    # Check for Warnings
    $warn = @()
    foreach ($alert in $alerts){
        if($alert.Status -eq 4 -and [string]$alert.InstanceName -eq [string]$svr.InstanceName){
            
$warn += $alert
        }
    }
    
    if ($warn.count -gt 0) {
        $warntxt =($warn | Select-Object -ExpandProperty Title) -join " /`n "
    }
	# Generate a Log message for this server instance
	$msg = @"
Submitted Property Bag
For instance:   {0}
Alerts (C/W/I): {1}, {2}, {3}
Alert Details:
[CRITICAL]:
{4}
[WARNING]:
{5}
"@
	
Log-DebugEvent $PROPERTYBAG_CREATED ($msg -f $svr.InstanceName, [int]$crit.Count, [int]$warn.Count, 0, $crittxt, $warntxt) $dmPath
	#Create a property bag for this server
	Log-DebugEvent $PROPERTYBAG_CREATED 'Creating MOMPropertyBag object' $dmPath
	$bag = $api.CreatePropertyBag()
	
	# Now pump the alert data into a new Property bag
	# Include the INstanceName so we can filter the bag later
	$bag.AddValue('InstanceName',      $svr.InstanceName)
	$bag.AddValue('CriticalAlerts',    [int]$crit.Count)
	$bag.AddValue('WarningAlerts',     [int]$warn.Count)
	$bag.AddValue('InfoAlerts',        0) # Always zero for health reporting
	$bag.AddValue('CriticalDetails',   $crittxt)
	$bag.AddValue('WarningDetails',    $warntxt)
	
	#Return each property bag as we create and populate it.
	$bag
}
Log-DebugEvent $SCRIPT_ENDED 'SQL Instance Health Script ended.' $dmPath
]]>
									</ScriptBody>
                <SnapIns />
                <Parameters>
                  <Parameter>
                    <Name>dmDb</Name>
                    <Value>$Target/Host/Property[Type="Idera.SQLDM.DMservice"]/DmDatabase$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>dmPath</Name>
                    <Value>$Target/Host/Property[Type="Idera.SQLDM.DMservice"]/DmPath$</Value>
                  </Parameter>
                </Parameters>
                <TimeoutSeconds>120</TimeoutSeconds>
              </ProbeAction>
            </MemberModules>
            <Composition>
              <Node ID="Script">
                <Node ID="Timer" />
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
    </ModuleTypes>
    <MonitorTypes>
      <UnitMonitorType ID="Idera.SQLDM.MonitorType.InstanceAlertCounts" Accessibility="Public">
        <MonitorTypeStates>
          <MonitorTypeState ID="CriticalState" NoDetection="false" />
          <MonitorTypeState ID="WarningState" NoDetection="false" />
          <MonitorTypeState ID="NormalState" NoDetection="false" />
        </MonitorTypeStates>
        <Configuration>
          <xsd:element minOccurs="1" name="Debug" type="xsd:boolean" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="IntervalSeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="InstanceName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Debug" Selector="$Config/Debug$" ParameterType="bool" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
          <OverrideableParameter ID="IntervalSeconds" Selector="$Config/IntervalSeconds$" ParameterType="int" />
        </OverrideableParameters>
        <MonitorImplementation>
          <MemberModules>
            <DataSource ID="DataSource" TypeID="Idera.SQLDM.DataSource.SqlInst.AlertCounts">
              <Debug>$Config/Debug$</Debug>
              <IntervalSeconds>$Config/IntervalSeconds$</IntervalSeconds>
              <SyncTime>$Config/SyncTime$</SyncTime>
              <InstanceName>$Config/InstanceName$</InstanceName>
            </DataSource>
            <ConditionDetection ID="CritFilter" TypeID="System!System.ExpressionFilter">
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <XPathQuery Type="Integer">Property[@Name='CriticalAlerts']</XPathQuery>
                  </ValueExpression>
                  <Operator>Greater</Operator>
                  <ValueExpression>
                    <Value Type="Integer">0</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </ConditionDetection>
            <ConditionDetection ID="WarnFilter" TypeID="System!System.ExpressionFilter">
              <Expression>
                <And>
                  <Expression>
                    <SimpleExpression>
                      <ValueExpression>
                        <XPathQuery Type="Integer">Property[@Name='WarningAlerts']</XPathQuery>
                      </ValueExpression>
                      <Operator>Greater</Operator>
                      <ValueExpression>
                        <Value Type="Integer">0</Value>
                      </ValueExpression>
                    </SimpleExpression>
                  </Expression>
                  <Expression>
                    <SimpleExpression>
                      <ValueExpression>
                        <XPathQuery Type="Integer">Property[@Name='CriticalAlerts']</XPathQuery>
                      </ValueExpression>
                      <Operator>Equal</Operator>
                      <ValueExpression>
                        <Value Type="Integer">0</Value>
                      </ValueExpression>
                    </SimpleExpression>
                  </Expression>
                </And>
              </Expression>
            </ConditionDetection>
            <ConditionDetection ID="NormFilter" TypeID="System!System.ExpressionFilter">
              <Expression>
                <And>
                  <Expression>
                    <SimpleExpression>
                      <ValueExpression>
                        <XPathQuery Type="Integer">Property[@Name='CriticalAlerts']</XPathQuery>
                      </ValueExpression>
                      <Operator>Equal</Operator>
                      <ValueExpression>
                        <Value Type="Integer">0</Value>
                      </ValueExpression>
                    </SimpleExpression>
                  </Expression>
                  <Expression>
                    <SimpleExpression>
                      <ValueExpression>
                        <XPathQuery Type="Integer">Property[@Name='WarningAlerts']</XPathQuery>
                      </ValueExpression>
                      <Operator>Equal</Operator>
                      <ValueExpression>
                        <Value Type="Integer">0</Value>
                      </ValueExpression>
                    </SimpleExpression>
                  </Expression>
                </And>
              </Expression>
            </ConditionDetection>
          </MemberModules>
          <RegularDetections>
            <RegularDetection MonitorTypeStateID="CriticalState">
              <Node ID="CritFilter">
                <Node ID="DataSource" />
              </Node>
            </RegularDetection>
            <RegularDetection MonitorTypeStateID="WarningState">
              <Node ID="WarnFilter">
                <Node ID="DataSource" />
              </Node>
            </RegularDetection>
            <RegularDetection MonitorTypeStateID="NormalState">
              <Node ID="NormFilter">
                <Node ID="DataSource" />
              </Node>
            </RegularDetection>
          </RegularDetections>
        </MonitorImplementation>
      </UnitMonitorType>
    </MonitorTypes>
  </TypeDefinitions>
  <Monitoring>
    <Discoveries>
      <Discovery ID="Idera.SQLDM.DMservice.Discovery" Enabled="true" Target="Windows!Microsoft.Windows.OperatingSystem" ConfirmDelivery="false" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="Idera.SQLDM.DMservice" />
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="Windows!Microsoft.Windows.FilteredRegistryDiscoveryProvider">
          <ComputerName>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/NetworkName$</ComputerName>
          <RegistryAttributeDefinitions>
            <RegistryAttributeDefinition>
              <AttributeName>DbRegValExists</AttributeName>
              <Path>Software\Idera\SQLdm\Database</Path>
              <PathType>1</PathType>
              <AttributeType>0</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>Version</AttributeName>
              <Path>Software\Idera\SQLdm\Version</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>DmPath</AttributeName>
              <Path>Software\Idera\SQLdm\Path</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
            <RegistryAttributeDefinition>
              <AttributeName>DmDatabase</AttributeName>
              <Path>Software\Idera\SQLdm\Database</Path>
              <PathType>1</PathType>
              <AttributeType>1</AttributeType>
            </RegistryAttributeDefinition>
          </RegistryAttributeDefinitions>
          <Frequency>43200</Frequency>
          <ClassId>$MPElement[Name="Idera.SQLDM.DMservice"]$</ClassId>
          <InstanceSettings>
            <Settings>
              <Setting>
                <Name>$MPElement[Name="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Name>
                <Value>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/DNSName$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Idera.SQLDM.DMservice"]/Version$</Name>
                <Value>$Data/Values/Version$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Idera.SQLDM.DMservice"]/DmPath$</Name>
                <Value>$Data/Values/DmPath$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="Idera.SQLDM.DMservice"]/DmDatabase$</Name>
                <Value>$Data/Values/DmDatabase$</Value>
              </Setting>
              <Setting>
                <Name>$MPElement[Name="System!System.Entity"]/DisplayName$</Name>
                <Value>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
              </Setting>
            </Settings>
          </InstanceSettings>
          <Expression>
            <SimpleExpression>
              <ValueExpression>
                <XPathQuery Type="String">Values/DbRegValExists</XPathQuery>
              </ValueExpression>
              <Operator>Equal</Operator>
              <ValueExpression>
                <Value Type="String">true</Value>
              </ValueExpression>
            </SimpleExpression>
          </Expression>
        </DataSource>
      </Discovery>
      <Discovery ID="Idera.SQLDM.SqlInstance.Discovery" Enabled="true" Target="Idera.SQLDM.DMservice" ConfirmDelivery="true" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryClass TypeID="Idera.SQLDM.SqlInstance" />
        </DiscoveryTypes>
        <DataSource ID="Microsoft.Windows.TimedPowerShell.DiscoveryProvider" TypeID="Windows!Microsoft.Windows.TimedPowerShell.DiscoveryProvider">
          <IntervalSeconds>180</IntervalSeconds>
          <SyncTime>00:01</SyncTime>
          <ScriptName>SqlDmInstanceDiscovery.ps1</ScriptName>
          <ScriptBody>
            <![CDATA[
#==================================================================================
# Script: 	SqlDmInstanceDiscovery.ps1
# Date:		1/31/13	
# Author: 	Martin Dey, Xtreme Consulting
# Purpose:	SQL Instances being managed by a local SQL Diagnoastic Manager service
#==================================================================================
param($sourceId, 
$managedEntityId, $dmDb, $computerName, $dmPath)

#Constants used for event logging
$debug = $true
$SCRIPT_NAME			= 'SqlDmInstanceDiscovery.ps1'
$EVENT_LEVEL_ERROR 		= 1
$EVENT_LEVEL_WARNING 	= 2
$EVENT_LEVEL_INFO 		= 4
$SCRIPT_STARTED			= 811
$CLASS_CREATED			= 812
$SCRIPT_ENDED			= 815
$SCRIPT_FAILED          = 819
$DUMMY_PROPERTYBAG      = 833

#==================================================================================
# Sub:       Log-TxtFile
# Purpose:   Logs an informational event to TXT log file, only 
#            if Debug key is true in Windows Registry &amp;gt;&amp;gt; SQLdm
#==================================================================================
function 
Log-TxtFile {
    param($logPath,$message)

    # review the key on server instances too.
    # 
	if (Test-Path -Path 'HKLM:\SOFTWARE\Idera\SQLdm') { # MPverbose
        $currentDate = Get-Date;
        $logFile = $currentDate.ToString("yyyy-MM-dd")
        $logFile = "\Logs\SQLdm_MP_" + $logFile + ".log"
        
if (Test-Path  ($logPath + $logFile)) {
            Add-Content ($logPath + $logFile) ("`n" + $currentDate + " - " + $SCRIPT_NAME + " - " + $message)
        }
        else {
            Set-Content ($logPath + $logFile) ("`n" + $currentDate + " - " + $SCRIPT_NAME + " - " + $message)
        }
    # } else {
        
# Create the key with false value
    # }
}
}
#==================================================================================
# Sub:		LogDebugEvent
# Purpose:	Logs an informational event to the Operations Manager event log 
#			only if Debug argument is true
#==================================================================================

function 
Log-DebugEvent
{
	param($eventNo,$message,$logPath)
    if ($debugTxt -eq $true){
		Log-TxtFile $logPath $message
	}
	
	if ($debug = $true)
	{
		$message = "`n" + $message
    	$api.LogScriptEvent($SCRIPT_NAME,$eventNo,$EVENT_LEVEL_INFO,$message)
	
}
}

#==================================================================================
# Sub:        Get-SqlQuery
# Purpose:    Runs a SQL Query using the SqlClient data library 
# Returns:    A powershell variation on a data table - an object array with a count,
#             followed by a series of DataRow objects.
#==================================================================================
function 
Get-SqlQuery( $connstr, $querydm ) {
    # Action of connecting to the Database and executing the query and returning results if there were any.
    $conn = New-Object System.Data.SqlClient.SQLConnection
    
$conn.ConnectionString = $connstr
    $conn.Open()
    $cmd = New-Object System.Data.SqlClient.SqlCommand($querydm, $conn)
    $cmd.CommandTimeout = 120
    $dset = New-Object System.Data.DataSet
    $da = New-Object System.Data.SqlClient.SqlDataAdapter($cmd)
    $da.fill($dset)
    $conn.Close()
    return $dset     

}
 
#==================================================================================
# Sub:      Get-DmServerInstance
# Purpose:  Read 'SQLdmManagementService.exe.Config' file to get DM server instance
# Returns:  The serverInstance as a string
#==================================================================================
function 
Get-DmServerInstance( $dmPath ) {
    [xml]$dmxml = (Get-Content ($dmPath + "SQLdmManagementService.exe.Config"))
    
$serverInstance = $dmxml.SelectSingleNode("/configuration/Idera.SQLdm/Services/ManagementService/@repositoryServer").Value
    
return $serverInstance
}

#DEBUG MODE
$debugTxt = (Get-ItemProperty "HKLM:\SOFTWARE\Idera\SQLdm").FlagLog
# GET MOM SCRIPTING OBJECT
# Start by setting up API object and creating a discovery data object.
$api = New-Object -comObject 'MOM.ScriptAPI'
Log-DebugEvent $EVENT_LEVEL_INFO 'Creating MOMScriptAPI object: This object is the top-level object for the scripting API.' $dmPath

# GET INFORMATIONAL PROPERTIES
$messageParam = @"
Input parameters
    Computer Name            :  {0}
    SQLdm - Database name    :  {1}
    SQLdm 
- Installation path:  {2}
    Source ID                :  {3}
    Managed entity ID        :  {4}
"@
Log-DebugEvent $SCRIPT_STARTED ($messageParam -f $computerName, $dmDb, $dmPath, $sourceId, $managedEntityId) $dmPath

$machineName       = [Environment]::MachineName
$osVersion         = [Environment]::OSVersion
$processorCount    = [Environment]::ProcessorCount
$userDomainName    = [Environment]::UserDomainName
$powerShellVersion = [Environment]::Version
$commandLine       = [Environment]::CommandLine
$systemDirectory   = [Environment]::SystemDirectory
$currentDirectory  = [Environment]::CurrentDirectory
$messageOS = @"
Windows 
Server properties
    MachineName      : {0}
    OSVersion        : {1}
    ProcessorCount   : {2}
    
UserDomainName   : {3}
    Version          : {4}
    CommandLine      : {5}
    SystemDirectory  : {6}
    
CurrentDirectory : {7}
"@
$msgOS = $messageOS -f $machineName, $osVersion, $processorCount, $userDomainName, $powerShellVersion, $commandLine, $systemDirectory, $currentDirectory
Log-DebugEvent $EVENT_LEVEL_INFO $msgOS $dmPath

if (Test-Path -Path 'HKLM:\SOFTWARE\Microsoft\Microsoft Operations Manager\3.0\Setup') 
{
    $scomProperties = (get-itemproperty 'HKLM:\SOFTWARE\Microsoft\Microsoft Operations Manager\3.0\Setup')
    
$properties = ""
    foreach ($property in $scomProperties) {
        $properties = $properties + ' ' + $property
    }
    $messageProperties = 'SCOM settings' + "`n" + '    InstalledInstances: ' + $properties
    Log-DebugEvent $EVENT_LEVEL_INFO $messageProperties $dmPath
} else {
	Log-DebugEvent $EVENT_LEVEL_WARNING 'No data to display for SCOM settings' $dmPath
}

if (Test-Path -Path 'HKLM:\SOFTWARE\Microsoft\Microsoft SQL Server') {
    $sqlInstances = (get-itemproperty 'HKLM:\SOFTWARE\Microsoft\Microsoft SQL Server').InstalledInstances
    
$instances = ""
    foreach ($instance in $sqlInstances) {
        $instances = $instances + ' . ' + $instance
    }
    
    $messageInstances = 'SQL Server instances' + "`n" + `
                        '    
InstalledInstances: ' + $instances
    Log-DebugEvent $EVENT_LEVEL_INFO $messageInstances $dmPath
} else 
{
    Log-DebugEvent $EVENT_LEVEL_WARNING 'No data to display for SQL Server instances' $dmPath
}

# DEFINE TRAP TO CAPTURE ERRORS
# Trap statement will catch any Exceptions and send details to the event log before exiting
# We always send direct to the event log - overriding the $debug flag - so we always log errors
trap {
    $tmsg = "SQL DM Instance Discovery Script experienced an exception:`n`n$_"
	Log-DebugEvent $SCRIPT_FAILED $tmsg $dmPath
    $api.LogScriptEvent($SCRIPT_NAME,$SCRIPT_FAILED,$EVENT_LEVEL_ERROR,$tmsg)
    
exit
}

#Discovery data object requires the MPElement and Target/ID variables.  The first argument in the method is always 0.
Log-DebugEvent $EVENT_LEVEL_INFO 'Creating MOMDiscoveryData object' $dmPath
$discoveryData = $api.CreateDiscoveryData(0, $sourceId, $managedEntityId)

$dmServerInstance = (Get-DmServerInstance $dmPath)
$connstr = "Server={0};Database={1};Integrated Security=True" -f $dmServerInstance, $dmDb
# Log a message that script is starting

$message =  'Script started' + "`n" + '    Connection String: ' + $connstr

Log-DebugEvent $EVENT_LEVEL_INFO $message $dmPath

#Log a message that script is starting only if Debug argument is True
$message =	'Script started' + "`n" + 'Source ID: ' + $sourceId + "`n" + 'Managed Entity ID: ' + $managedEntityId + "`n" + 'SQLDM DB: ' + $dmDb + "`n" + 'Computer Name: ' + $computerName + "`n" + 'Connection String: ' + $connstr

Log-DebugEvent $SCRIPT_STARTED $message $dmPath

# Read server table from SQLdm database
$qrystr = @"
 SELECT TOP 300 [InstanceName]
 
,isnull([RealServerName], 'N/A') as [RealServerName]
 ,isnull([ServerVersion], 'N/A') as [ServerVersion]
 
,isnull([ServerEdition], 'N/A') as [ServerEdition]
 ,isnull([MaintenanceModeEnabled], 'N/A') as [MaintenanceModeEnabled]
 
FROM [dbo].[MonitoredSQLServers]
 WHERE [Active] = 1
 ORDER BY [InstanceName]
"@

$instances = (Get-SqlQuery $connstr $qrystr)
$messinst = 'SQL Server instances started' + "`n" +'    SQL Instances:   ' + $instances.Tables[0].Rows.count

Log-DebugEvent $EVENT_LEVEL_INFO $messinst $dmPath

if ($instances.Tables[0].Rows.count -lt 1) {
    # No instances found so don't create a Property Instanceound"
	 Log-DebugEvent $DUMMY_PROPERTYBAG 'No monitored SQL Server instances found' $dmPath
	 exit
} else {
# LOOP ROUND EACH MONITORED SQL INSTANCE ROW

	foreach ($row in $instances.Tables[0].Rows)
	{
		# Logging row values to know if these is or not NULL
        # In NULL case, the exception message for MOMClassInstance object is: 
        # ID: ComMethodTargetInvocation, Message: Exception has been thrown by the target of an invocation.
        $message = 'Created SqlInstance class instance' + "`n" + '    Computer Name   : ' + $computerName + "`n" + '    Instance Name   : ' + $row.InstanceName + "`n" +'    Real Server Name: ' + $row.RealServerName + "`n" + '    Server Version  : ' + $row.ServerVersion + "`n" + '    Server Edition  : ' + $row.ServerEdition + "`n" + '    Maintenance Mode: ' + $row.MaintenanceModeEnabled
				   
		Log-DebugEvent $CLASS_CREATED $message $dmPath

	

		#Create a SqlInstance class instance for each monitored SQL server row we found in the DB.
		Log-DebugEvent $EVENT_LEVEL_INFO 'CreateClassInstance: Creates a new monitoring class instance.' $dmPath
		$instance = $discoveryData.CreateClassInstance("$MPElement[Name='Idera.SQLDM.SqlInstance']$")
	
		#Since the Idera.SQLDM.SqlInstance class is hosted, we need to provide it's key property and the key properties of any parents.
		#The key property of SqlInstance is InstanceName.
		#The hosting class for SqlInstance is DmService which has no key property.
		#The hosting class for DmService is Windows Computer which has a key property of PrincipalName.
		
$instance.AddProperty("$MPElement[Name='Windows!Microsoft.Windows.Computer']/PrincipalName$", $computerName)
		
$instance.AddProperty("$MPElement[Name='Idera.SQLDM.SqlInstance']/InstanceName$", $row.InstanceName)
		
$instance.AddProperty("$MPElement[Name='Idera.SQLDM.SqlInstance']/RealServerName$", $row.RealServerName)
		
$instance.AddProperty("$MPElement[Name='Idera.SQLDM.SqlInstance']/ServerVersion$", $row.ServerVersion)
		
$instance.AddProperty("$MPElement[Name='Idera.SQLDM.SqlInstance']/ServerEdition$", $row.ServerEdition)
		
$instance.AddProperty("$MPElement[Name='Idera.SQLDM.SqlInstance']/MaintenanceModeEnabled$", $row.MaintenanceModeEnabled)
		

		Log-DebugEvent $EVENT_LEVEL_INFO 'AddInstance: Adds an item to the collection of discovery data.' $dmPath
		$discoveryData.AddInstance($instance)
	}
}
#Return the discovery data.
$discoveryData

$nams = $instances.Tables[0].Rows | % {$_.InstanceName}
$namstr = $nams -join ', '

# WRAP UP NOW
$message =	'Script ended' + "`n" + 'Rows found: ' + $instances.Tables[0].Rows.count + "`n" + 'Instance names: ' + $namstr
Log-DebugEvent $SCRIPT_ENDED $message $dmPath
]]>
						</ScriptBody>
          <Parameters>
            <Parameter>
              <Name>sourceID</Name>
              <Value>$MPElement$</Value>
            </Parameter>
            <Parameter>
              <Name>managedEntityID</Name>
              <Value>$Target/Id$</Value>
            </Parameter>
            <Parameter>
              <Name>dmDb</Name>
              <Value>$Target/Property[Type="Idera.SQLDM.DMservice"]/DmDatabase$</Value>
            </Parameter>
            <Parameter>
              <Name>computerName</Name>
              <Value>$Target/Host/Property[Type="Windows!Microsoft.Windows.Computer"]/PrincipalName$</Value>
            </Parameter>
            <Parameter>
              <Name>dmPath</Name>
              <Value>$Target/Property[Type="Idera.SQLDM.DMservice"]/DmPath$</Value>
            </Parameter>
          </Parameters>
          <TimeoutSeconds>120</TimeoutSeconds>
        </DataSource>
      </Discovery>
    </Discoveries>
    <Rules>
      <Rule ID="Idera.SQLDM.SqlInst.DMAlert.Collection.Rule" Enabled="true" Target="Idera.SQLDM.SqlInstance" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>EventCollection</Category>
        <DataSources>
          <DataSource ID="DMEvents" TypeID="Idera.SQLDM.DataSource.SqlInst.AlertData.MapToEvent">
            <Debug>true</Debug>
            <IntervalSeconds>60</IntervalSeconds>
            <SyncTime>00:00</SyncTime>
            <InstanceName>$Target/Property[Type="Idera.SQLDM.SqlInstance"]/InstanceName$</InstanceName>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="WriteToDB" TypeID="SC!Microsoft.SystemCenter.CollectEvent" />
          <WriteAction ID="WriteToDW" TypeID="SCDW!Microsoft.SystemCenter.DataWarehouse.PublishEventData" />
        </WriteActions>
      </Rule>
      <!-- SQLDM 10.1 Barkha khatri Rule to generate alert and write it to operations manager DB -->
	  <Rule ID="Idera.SQLDM.SqlInst.DMAlert.Collection.AlertRule" Enabled="true" Target="Idera.SQLDM.SqlInstance" ConfirmDelivery="true" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>EventCollection</Category>
        <DataSources>
          <DataSource ID="DMAlerts" TypeID="Idera.SQLDM.DataSource.SqlInst.AlertsData">
            <Debug>true</Debug>
            <IntervalSeconds>60</IntervalSeconds>
            <SyncTime>00:00</SyncTime>
			<InstanceName>$Target/Property[Type="Idera.SQLDM.SqlInstance"]/InstanceName$</InstanceName>
          </DataSource>
        </DataSources>
        <WriteActions>
          <WriteAction ID="GenerateAlert" TypeID="Health!System.Health.GenerateAlert">
            <Priority>0</Priority>
            <Severity>$Data/Property[@Name='OMSeverity']$</Severity>
            <AlertName>$Config/AlertName$</AlertName>
            <AlertDescription>$Data/Property[@Name='Message']$</AlertDescription>
            <AlertOwner>$Config/AlertOwner$</AlertOwner>
            <AlertMessageId>$MPElement[Name="Idera.SQLDM.DataSource.SqlInst.AlertData.MapToAlert_AlertMessageResourceID"]$</AlertMessageId>
            <!-- SQLDM 10.1 Barkha khatri parameters which will be used in alert description -->
			<AlertParameters>
			  <AlertParameter1>$Data/Property[@Name='Message']$</AlertParameter1>
			  <AlertParameter2>$Data/Property[@Name='Heading']$</AlertParameter2>
            </AlertParameters>
            <Suppression>
            </Suppression>
          </WriteAction>
        </WriteActions>
      </Rule>
    </Rules>
    <Monitors>
      <UnitMonitor ID="Idera.SQLDM.DMservice.CollSvcMonitor" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.DMservice" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.CheckNTServiceStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="Idera.SQLDM.DMservice.CollSvcMonitor_AlertMessageResourceID">
          <AlertOnState>Warning</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Running" MonitorTypeStateID="Running" HealthState="Success" />
          <OperationalState ID="NotRunning" MonitorTypeStateID="NotRunning" HealthState="Warning" />
        </OperationalStates>
        <Configuration>
          <ComputerName />
          <ServiceName>SQLdmCollectionService$Default</ServiceName>
          <CheckStartupType>Automatic</CheckStartupType>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="Idera.SQLDM.DMservice.MgmtSvcMonitor" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.DMservice" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.CheckNTServiceStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="Idera.SQLDM.DMservice.MgmtSvcMonitor_AlertMessageResourceID">
          <AlertOnState>Warning</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Running" MonitorTypeStateID="Running" HealthState="Success" />
          <OperationalState ID="NotRunning" MonitorTypeStateID="NotRunning" HealthState="Warning" />
        </OperationalStates>
        <Configuration>
          <ComputerName />
          <ServiceName>SQLdmManagementService$Default</ServiceName>
          <CheckStartupType>Automatic</CheckStartupType>
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="Idera.SQLDM.DMservice.PredSvcMonitor" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.DMservice" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Windows!Microsoft.Windows.CheckNTServiceStateMonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="Idera.SQLDM.DMservice.PredSvcMonitor_AlertMessageResourceID">
          <AlertOnState>Warning</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Running" MonitorTypeStateID="Running" HealthState="Success" />
          <OperationalState ID="NotRunning" MonitorTypeStateID="NotRunning" HealthState="Warning" />
        </OperationalStates>
        <Configuration>
          <ComputerName />
          <ServiceName>SQLdmPredictiveAnalyticsService$Default</ServiceName>
          <CheckStartupType />
        </Configuration>
      </UnitMonitor>
      <UnitMonitor ID="Idera.SQLDM.Monitor.InstanceAlertCounts" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.SqlInstance" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Idera.SQLDM.MonitorType.InstanceAlertCounts" ConfirmDelivery="true">
        <Category>Custom</Category>
        <AlertSettings AlertMessage="Idera.SQLDM.Monitor.InstanceAlertCounts_AlertMessageResourceID">
          <AlertOnState>Warning</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="UIGeneratedOpStateIde02721981c7244999d2daeae90698cfe" MonitorTypeStateID="CriticalState" HealthState="Error" />
          <OperationalState ID="UIGeneratedOpStateId1e5924d096484f5e963cc9c234fadc68" MonitorTypeStateID="WarningState" HealthState="Warning" />
          <OperationalState ID="UIGeneratedOpStateIde880de805d234e169b1887758bc6feac" MonitorTypeStateID="NormalState" HealthState="Success" />
        </OperationalStates>
        <Configuration>
          <Debug>true</Debug>
          <IntervalSeconds>120</IntervalSeconds>
          <SyncTime>00:00</SyncTime>
          <InstanceName>$Target/Property[Type="Idera.SQLDM.SqlInstance"]/InstanceName$</InstanceName>
        </Configuration>
      </UnitMonitor>
    </Monitors>
  </Monitoring>
  <PresentationTypes>
    <Images>
      <Image ID="Idera.SQLDM.16x16Image" Accessibility="Public" Category="u16x16Icon">
        <ImageData>89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF61000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC200000EC20115284A800000001A74455874536F667477617265005061696E742E4E45542076332E352E313030F472A10000035049444154384F6D937F4CD47518C74FCA10B2CC0A03932DB54999A7E144B84A622C605686B9C6325B45640D3491EC60DE8170421E1BF14512DA500C35B9EA803BA93B442451A1BE1006C40F237176DC17F911129D277743DA5EDD1DE30FCCCFF6DE67CFF6ECF5BCF7ECFDC864773C7B5182E2E6B9AF05477B8334219AB0FF64E2A6582F5D371C13FAD2B729EEEC9F554F988A04475F2B93A3566E0FF7333564E1DF410B930316A606AE61EB6A41AA2811EE0A719C29D4DBAEB672EBCA259C5DCD2E89D37FE7CF1ED9DB9B70FC65C579FD1A9643FBF4B3204E5D86E014CD389AAA99B860C07EA11AFB7923B6FA4AFE39AD63C4EC9258C38DD16EAC35E5F4571EA55B9530EDC47EF05D85DD5080CD7484515311B653C58C571430FE5D1E633A2DC32772E82FCBA6A3AF8C9EFA42AE16A8B8929746574E3297B33E52C826F74708B7BE78835A713BE6B644EC65290CD6E9182E5531989F8874E0031A2BB773AAFD433AD3B6F15B721CAD49AFD3D3DC4287FEB8201BC98F91B24DF3D19CF34523FA73AC7A27DFF60C62F8E5773A3409B4A54592F7AB1CA36A0D2D9B56D0101E40E99787293BDB8A79539824CBAAF446FBFD838C64AF432744B1452F5292AB449B5FCC9B272EA22C594B46F9BD34873FCC8FA10BD89596C3DBA56739B92E901F56CC45565A18C0ED0311F4A647F1A4B68AF0E29DECAFF4E1CFF895C42B77E3975F832A3E12D105887D6F177E19151C0A7E02E3322F4C6EC054DEABD278760C4FABCB8848CBA73755CE274DF77052EB4766D55C623EDB8C57A699E01DB9F8AAAB280C7DCA35F93E0C4BE7501BB248928DEF8B145E521710A4FA8AC1BD2FF0F7A7C118731F67779B8C94C63934C62D4619FB32F394DFA07D51CE9955F33C00B703B3FC7E41F6796AB22270CF117AD55138D2C318DB138C25514E66B93787350F71E9952598373CCAF1F58B30ACF1F5004C41DE18977BD19910391D6DEBDE48C1A95130A10EF5003ADF09C2B8D5B5A48D4B103706D216F59867890D21F3A95BEDE37150B7F681D991B6AB43F43380A1A4D558E283E8DDBA94EECD01B447FB236E584843D8024E3FE343ED2A9FD9519EC9F558EA7AE146CAB3B801D6F783F8E3AD6574C54E03DC0ECE3FB7908BCF3F72F7639A810C65BDA618D8112C481F874A6E0797B72CA63B6EA5D41AED2FF42545FFEF9CFF03C1232795547C1E600000000049454E44AE426082</ImageData>
      </Image>
      <Image ID="Idera.SQLDM.48x48Image" Accessibility="Public" Category="DiagramIcon">
        <ImageData>89504E470D0A1A0A0000000D49484452000000300000003008060000005702F987000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC200000EC20115284A800000001A74455874536F667477617265005061696E742E4E45542076332E352E313030F472A10000093F494441546843C5583D6823571056E9D2A58A145117418A085258704D0C575870C5095C9CC0C56154187185112A8C70638C0B215C18E1C20817015D61581701A538D83401B938D015867571A01429B648A1E20A9593F966DFAC66572B4BBE9F4430BCB7BB4F6FBF6FDE37F3E66D2EF7157FB3B76D0A3BFB141E6DD3A455495870B04DC1113FBB3EA5AFF8CA2F9F2A3CA9D2F4A246D3DB1ECD1EC644FF84449FA6D9C6CF306672D51532C19BEAFF43069E9E9E54687637A45938A119035613F020B186E1BFC1ED80C67BDB145E35FF1B3231F04F11488058076CD618FB5F2152AF7C3B12002E3261E0E275F13CF7EDB5DE77A4D625A7F3812488205EBE5CDC6606BAAC897663E006E8D27B3A1E6DAA1FDC07D13D6B20ED6207737EB5D588C15B1020900160E15E7ACC63D73CE7F4D34C62094484C49706F9ECAAB108F429A0D26311F4F61E5FC7AB21729C27038C9BBEF33E9F84789E5F30998EC4B41FB70A04A09619C6D867E96B7D66E309441C78FC574870967A524CD0D9F672508F014E3DC3CB1504FA5916C7874B087016C6219875BC64A857A5F548C469720550C9486E8C025D05D6028AFB0868062FAB8C3830E08504BF072D36BFB5021B9B54962414701A78C2ABFCB2F85AFB688D2928DC9BDCCF252A52C5F50DDF8731E0B8451F040E6B8FAF02A49300E8BC9C066F01ADD3071001CC2D6A210519842C156369C042C258D06992FF62899466D74D52EFAF036AD91800C433B48FD9F87D3F015EAE19E0E4A22DED32436AC59885A0D69D360B987FDF8D56063550460BA0421ED5A8EBA3B699FECAD7DCAAE1C5E17993C637EC499E7314F6C4D007603C9B9C356243C1876B29FC60208680CEDA1F201F499D0E8882F51E9A34FCBB4968ED3379CE00D52C500089AFD1770630E8EB9C981736E2D58F412A58D742F778269E673961B30389C40AC0FB42C019E4042FD917A18F1789D48C49D64026E17BD38B7D310B5840F319413C7B52933912F3DE3238063939AA4A2BC660D336EAB43953CDC482709A5C8569AB9420303C2F52FB8F02F51EB669F05735B6DE1D7BE13A02895D1A4187C9C498844804071A3E23C42DF7014E8C09600E9D137D9F9FE35C1003E68A14E9520D413B7C5DA1D1C790C6E14C6CF4778A80F57EEF224FFBEF72D4BC8FACFDB049DD87880CAC7FCB55291F6000169362B2D83E04918E1968786C803B02FDEB688E782EBEB660A5CFBB2E36ADD14E81863F6C90B7C304DE0734FC388DCD7B37A2C15621921134AC044E2F3713E09B1F98C4ED467C0F649A779B34B8AC90F7E798A5102EDA5D40E30EAF4EEA48E9F331B3FD67897A1F236BBF2B917F5016B0B0E0659E46CF36C500DCFF2902DFFB7D4CFD0F21F5EFD9B8C535C07BDFE5449639390E720CB4AF92E01B770CFE6A839F95C9EB14E6C498549B83E8F46E92B0EEFB90D4F012FF84B307CEC17506B7C780AF0B747A9F178313BAAD3C8D9FCF4103B035803CBDF193EFE16B050F02B2330747256A5C315878DBC9061202A119839F1D47866B8C69DC9C52E3F7606E6F7939CFDAD4E076E17E8B53DFAB02F50F8C733007BF0F9E5602FE56E4792500908DAB61723EBEF67E2992F77D2E32106007E44E8F3648BC0DF03C39C0230E04BC2100A2D5CB7DAADE8CA97A1B4476CDE01964582F8A376A17DEC2F3D3C306EDBF9D3B48E67FBD91F07E1A7CED6C307F07DE7339A4FE3303DE11007121A0DEC7E4908B54A32902005ABEF4A9FC761C19F72BE7C8D1252120243800AB277D2A33313B6EFBB2113BA8711E794EF5AE2DC0C0F395A35EF2FF671EF59E95E69E77E0B10A889578056ABFF1C49D793AB50486AD2A154F3C2A5C8D22BBF009A064E53A1B14BE29D1E4B523C1015939EC52E1DC9F8FE77E99B353ED364783DD48FB09FD33788F4DFEC773E31D9B176C87036AFF5C8CB2914A4709B0846202B5EB2478BB0263CE2685569F27F4233B1B52E1B89D8817EF301FAF0288C02AF5A68C152030EE170FDAE4BF2C2CCA870995F6B8BE39F3E7F66640CD2D4EA10E7C820483470C60F5725E8B5FD82927363225802F6CF97A373131AEBB27262B71EC40E30A1C2D027750CF53F198CBDFE3A1FC1FE4D1C7FF118C36808BBBFC4DC88D13120CBEB15516F099046C10238DDA8D4CFB48ADA53A7F0634136F1CF42558B17323C56AECC452E23850029AD9CA177C1C6C790927609EFEF322F9F0FC4BCEE5163C8F6D3CDB8EC15B126919C9E717BB9159225596401ABCF726020F1BB50A84B8B1A917520281FEE16622B395390D03B49508F45D78CD0EB2B261F0FBBF54249D2AF005FD9B20968D0CBFF40A340F16BDD23DE04A95812801046EEF2C3F07EAA4343A6079216D9A3D0572EABE7024ACB72D78BE5F7BBE087EA98498485C91DA62AE87639B5D729EB851E7E2CD80B724129B2036296426DD14D1729692ACB3CB1B1A97069BF55E523220C1EFA8EE7061C7994837B3F40AA457423290FEB49C466588008A9795274636D1DD38BD025885B494D4F36821317F2F2F410D12D03CB4BFB9C789415782DBED9D5AA28CD05AE831EF2F7CA540BA14EFE8B2F2C40862642225A09EB72B0012DD935411C8E0B112D824153CAA4B1040BEC7AE9ADFE5B4C9CE2AEDEC53FF47CEF328DE9CF6D3319015C80B47CADAEE3CE58104D29D059F2601E0D616EA298E03C80666C10B819FB898FB394F952D2EAD7FE46B2620C6F7ADF79765202921D23FFF923302E4C39E9774C92B922E273257C0A54E64203947B87A0A9908DED71580843C2723905003E82CEF3F968970E6C8FC5257D9DD17F01E970E69F0CB5600A532320F3C8D800509AC06765C781E06F052EFE3DAD5FCB606B2C1BB4A3E99DEB76C7AF56A663197CE42908F8207581C3E50E7543A39EABE62AF1A8F2B09AD81D2C59C641E64A02559C866A095DF48A1FB44356A4A6A2B212DE0E07910500309A9DB1D81616A15147C260973A8C9DAC8E0B09504E498C93BED2A09618C92C0EEAB016B03179E8FA5E3A4B47415D4FBAE4D1390C2ED29BF2C12E91588B3900B64AD833478A565EDAB2D032F071A27210B5CFB90D853B02776E8AC4D4CBD6F09E040A367822C02BA1A592462FD330949A3AE55029F053EDEA52127772ECE0A6421E14E6468015E5BEB7DF457AE808B81D8F359F9FE73D800E452F01904125272127AEA0A3C59F3AB88213B2D2B257405162464F4BFD60AB8005E3BDBAC029DF51C6097C5C082844C105BF9649D89A17BF94CF25FFCE4CB33746FEBA16599688D2C04E04BCB836F4D08D2D2C04D9F8BE36CE402382D237CB5FBD6F89E34BFAC0C3EEABA837DF0820B3A181310725C207E6D4FFF0B8A4F7882E4F133690000000049454E44AE426082</ImageData>
      </Image>
      <Image ID="Idera.SQLDM.80x80Image" Accessibility="Public" Category="DiagramIcon">
        <ImageData>89504E470D0A1A0A0000000D49484452000000500000005008060000008E11F2AD0000000467414D410000B18F0BFC6105000000097048597300000EC100000EC101B8916BED0000001A74455874536F667477617265005061696E742E4E45542076332E352E313030F472A100003EDA49444154785ECD9C055856D9BBF611741C150BC719BB5B51B0DB51C1EE7650ECC0005EBA5342244551145011A595EE1414A55B04A444BA5B01EFEF592FE0A033F39FF9CE9973BECFEBBAAFB5DFFD867BFFF653EB594B7978FE87FF94EAECE321F1910697EB1D185D657C74428DF5A5898D4EBA0B5B5CF5359A9C74B26BED943B2B2DAFA0FCC609941888E183DE31145D13FF46853AC790A721865C8D13C8D5BB8A424BF5CE920786D9A5F6C61A85D67A0BB374242766CA1F9F9029757074E6D57D83497CA4FFE1BBFB977FBEF5A92A0F574F54FA343FE0F036DE3ACD577FF7325F85E919FE3283A3C2E58647C4ABCC8E49D5DEBFCAA977BDAEDEE47FDFBD39E8416953805D67838F35EA3D2C51FBCC02D5EE374996BFCBCD1255AE3751E16C8132274B94BBDE43A5C7C3CE2A6FFBD232B7FBEE05D686EAEFAE4973DE2A9D927A2B7B54FCADCC11E14CA593FC69CAA7F9DEA9FCC657642AC15B7257A64FE93D591EA6FF6FFF7403EC4B000508E0540238A7C1FACADC7A67C315D50FD564ABEECB06D43C5448AB73BD96511F6093D5F4CAA7B43535AAED535602DA7353D0FE3E059FB94AFDAA4F74CC552E2927056DD9A4AC64B466C4A329E1455B558847E94747EBAC022BBD8C3C63A5B4F7D76503724C946533CD3557A42A9F9E4B00E710C0A9045080E0F5FDFF1660ADCE369E3ABD5D7C4D3692022D4F5436363F52506BBC2B61D1602767D9E477CFA631D225A221C2A9B2E1A55B7B53BC5F47537A7467F3FBD4CEB68F79E8A8FC882FD5E5C0DFAA0CA82AC3978A12749614E273FE3B34A7C577D6C78475D684FB745405BAB697F93EAD2CF27C1CF1CECEDC2643EB9265B6E6298B22F3AB6AC556321BF38C2E0A244BECE44B3CB7EDFFBD1132605CE9EEE0A9BD7194A7566F375FEDB51D23EBCD4F6C687EAC62D4ECA69FD8E4AA57D6E46D51DE1AE359D996F9BAA1352FB5BDB5381B6D6505F854518C4F55A5F85C538ECEDA4A8089012440FF5195A5001341FC525E4C208BD0519C8FF6A25CB4E567A1F15D727B45DC8B860F3ECE95F9F78DCAF36FAB9715DC554FCC3593354A573AB621E9C28E914997F6F0652A1EE2C9BC2CC29329B181ABFFF53FDD007909E0000228507B57726C9DD545118A79664DCE7A492DA1F68D2D71DE5F5A3322F1392F199F09DCA7B27C7CAE2C460781EBA82EFBAA4E3AFEC22CAB07CE7F61FC5259828EF20F682BC9433303999E80BA98509407B97D2970B16E7C67A99194A1256196AE7D5924E3BAEC580228400007103CDEFF7580B0FA8DA7C3F2489F0683DD83EAF4770BD59A1C13ABB55392AE7F6E6AD9E86795DCF4C2B1B92535A2B3B5200D6DE579F85CF581AC8D6E8EF4B9F203DA2BFEA80E3AD74156D95941EECC5C94C64E7ACD8EB916F7376200D97718C48E325269113E7DC845FDDB2494BD0CEA2CF674682E7A7A27F9BD83956596A586F45B95A3626F25B708655CDE3C28E9FCD63EFFAB6E4D007949FC9F6E8B0B36DD3ACBA9BF2F1D50EF6A94DEF0C2B5B039E345634B7E52676BD15BB496E4A2B5A2006D35C568ABFD8856365616725DF85BE577B935A9BDAC90001471C7CFDDC79D04E40B13B9EC9772025C4623BD66E7DB4B8BF199D4514AAF095A8F3A4A0BF189E26B4BD13B34E565A0292BB9B32EF9756349845F61FE939BE9B9C6D201D9EAE29C74CE7EC1C4F3DBF90920EFFFB81B33CBE3C2BB2B3EF0CBBD53429D0F2ECBB7396B0737FBDDAD6C8A7EDEDE9CF1B2B3A528F34B6B591E5A4BBB456ECB20B61238AECAE975CF7B3D23B95D2B57EFD1569C834F45E4EE1F72E838179F0AB3F1B9E01D3EB3B1F83D3E1394CF4539DC73AD9444EAF372504B6ACEA7F7E97597B2F089D4964F0F910032B7FECC626E69D19786ECB4CEAAD7C1ED655E0F2AF3AD348333544EC9274B1E104ABABA7F60E2D57DBCA47F9F63EBBDCB3C4C5FEE1CEF032B317E3078F6D2D21D6E3AA19F836DAB5B1342DA5BB213D15A4817FC211BAD1FC9F208462BC1E0BEFE5EEC3CFB0C53CF7B74A3EC665BF332D19A9B46630601A2E31C0A03EF58F9928A367AAF8DCEB5B1F7E95C53560AAADEA6A192D490954AE792E9B35D62C7AD54F2B0DF682BC9C7278AB39FEBAA692C475B69011A3362DB4BBD1F57BFB7D40CCDD496904E963D2A44F0F8497D18C47F15643740DEB6FB970675D84A08763E9294EF702778618F2ADAE2833A5A33E3BA6EB630AB6B2CE87AF2DC91DDECF76270D8FBECF3EFD37F7F3F8720B09BEEB979769C9584D6B7F470D8D80386BDCE4C40338D0D9949A82735759FE39ECF4CE4BED7C2EA45F67711B0969A4AB434D4A3ADB10E9FEBAB285C14A121ED7547A9EF938A5C4B8DD074D533F229B2470593A40E0CFA572D91B92DB3BCB67B9706B5DA480A7F725092F9FCDC30F873885D755B7C60476BC69BAE9B6390180C0681A9E798BDC715DD740F0806A6071C83C2CEFF5365D0C34A7BDDA5CC78B430503DF0D2DFA0393506756971A8C948422359680B3DC4968A4234D755A29900B610C04F0D35F85C5B4E0F91DCFF754847F113CBEA9C1BF2C1E92AA76592A50F09275DD93B28F1A4689FC4E3FF4279D39530C4F83BEE5F10FCF4485EA6D5DD20BC39C2BEB22939A8BDE96D0C9AB3E2E806E2D0FC2E014DD9F4F4B3E2E9986609396405D9BDC0D1CDB6B29B4F8FED1AD96B66B919F49A9DEBADAFEFF7FA0EF77D7A58A9AFD09AF402ADC9515D107BBEC78EE95C6342042A935EA13C2D11F5EF52D1C242447531591F5960630D5A99C802DBA8786FC97B8BC6F84854F939B57FB0BB51F9CE403A3C5DF1844CCAA53D8289E21BF909E07F3DB1407F030F8917E67B07E2CE31A14E3B09F9CFCE5AC1CD41D695B5495E9D95F9D1A82C7C8DDAEC97144FA25047634DEE2B72A928D46745A326EF35EA73092E4DD3B8B0D262BA6E3C31E2EFC53E4796C405C440B1EF248477891D2745D2C8D4EB7C42185AE382D1F42610757161A8497D8D46E615A5148BEBA80268248B6BAC404B7D195AA8946A29C842137DA6212618F5E11E34B77ED05974DFB0F29DEED5E0D42BFBE5934E6D124A145F3330F1A8302FE99F27969E194687BE481FE86FE4FF62BC43A8D3FA9474C713C5D0CFDEE6D5CDD1CEED35E98128CF8F2045A2E66D281A52825193198AEAAC30D4A706A32E3D04553991A87BF7122DE96431CC6AD8CDC606A1F5B5FFDF8B20B4C4879122D0121B8C96187F34BFF4ED524C209A6343D1FC2604CDAF7A9D67EF45FB703FD344DF694E7B459028FEB10AA09E012C4573E34734D4E6A3A13883E25F0C6AA203511DE689BA300FD405BBA1DCCDB6FDFD4DADEA349533A1C99777492789AF144AFC6D217FA2D8126E9DF88F6AC59E1946C3B5ED833E19ED12EC343F28DF617735F4B3A749455B9843474B8C27B9893FEA5302B96A4C0C40739C3F9D0BE01E37D17153BC3F1A920269B21F849638824696D11A1B48E0FCD0FACAB74B31BD44AF5B5EF97C151742B42F1AA3FD68F441D30B2F349095D4D38DD6877BA23ED207F511DEDCD775A1CFB9AA67A2D70D91DE688C0DA32442F1F1C33BB4545102A9672E5C8C86BA7C5455A4A2329BBC87E097043DC3477F575406BAA126C80D153E4F91EF60D59161AA5A91A2F05B68F2B98DF249A77F154C3CBB7910AB13FF1940DDED34BFDD3E801A03424DA6BF71DA6C25833FBBE957B7853CEA687DE9C9BDF196D74C7EDDEA02D175EE77282DAFBCD1FCE2199A23DDD112EDD5F51902D51C4DE7A3BCD1F2D2A7FB1C590D9D63909A2299E801451024068BA030700D610429E4196A83DC511BCC44C7A46A7A5D11E08A7282504510D87B35E1DEA88A7B816A8A7F0D54C83754BF475D1D8D35EF515FF6169514664A62FD504C9FFDE0EB029A33E3A3AF33CA7D9FA2DCFB310ADC1F20CBD6A423434FAA3A4DEE6870CAE53D1C2AB48508DE807F04B0FEFA011E9240FD8D43620DB7CF07343BEB55B686D8B7B7463FA71BEEBAE9DE6A794930A23D0988375AB9C75E744C8AF6405398331A431C092281EC06C7E030280C58337DB6F985071AC399053DE342AAA31BAB0B7225111012F738D005B501CEDFA83AC085C0B9A0D8C711C5DE4F51E1E784EA605754BCF0467162148ADF537D589E8DCADAB728ABA17AB13C15B514932B293C14D36F16D0778A3C9FE003A9C0E3313E3CB34389FB7D14B8DE47F6632BBCBB75AD3D53FB4A650AE74840A2C46EB1C40B3B0548FF3916B2C4F1C570135FCBAD13639BEE5E946E7AA490DEE27DABBD35EA59373C0248AED60392416316C6403547B87141718FC35D09CC73EEB9C63017923B41236B224BAA679042DC09189D0B714143D05302E444B05C511B48F27744ADEF631A9F761FDBA3D6FBC137AAA6D7E5DEF628F672C0078F8728F5B045259DABA087F531D61B055991C82F8E477155328A6B135058F51AC585D1284D0EC2C71067147AD821CF8D6039DF4321299F54E0688522074BE4DB5B22F721E9AE11DE1AC8B7A7289C484FBC7A403AEEFCCEB1E17B97F085EEFC9384D26A27CBC3F4C550940F062223DBCD0F89B4DA495936BBE815B604DA75B692353170CCD21818AEC5B163062FD4118D410E64694F7F3F0E7EC205D9C4E08538A13ED01175014C0C4A8F9EA0CEF721EABC6C50EBF310B57E4FBAC46079DDEF1AD979CFFBA87E7E0755CFAC50CDF4DC0A15CFEEE0A39B350AA9335DEC761765EE5628F3BC8B8FE1F6C84FF3406E511072CBC3F1BE2A921481F7A5A1C87BEB8B8217CEC8F7B041BED32DE411ACBC4716C87F688E3C7B0B3A3647BEAD29F26C4C9077DF04EFEF5C47D60DE5CE54D5F38571570F584689FD2A12B67BD1C8F07D4BF9F26EAAF2307DFDD30DB0EFE73B67053A4DF76DE8303F6846B12FB9C9DDA4B139F8F19796288216C55C9280102C2E1CB2322EB8C0C76824606C6C08B0EF3AA6F30DFE0F50EF6B8B7A1FDB2E480C0AC1F8461E77514B406A0950ADC73D7A8FF4FC2E6A9EDD460D9D63AA76BF8D0A6AE997BA522B9F46EEB1CB4D7C7034C7872766345AE003BD57E86985BCE887C8CE7643D6472F6495FB74A9CC1BEFF29F23E7B503DE7B5A1338826547806C8DF1FEFE0DBCBF47B221B1636BA3AFCABD63807766EA5FD2B42E35C65ED9971C2DF6ABD9AB13221BD2544F0B10BCBEDF02B495E9D36A2B23D06A23B5F193F505A3CFD6E7935A1D549B9BBCEF747281917531300DFE0F51EF7D1F0D7E0F08161DFBD8702171CF3358EC3D76EC67873AB288DAE7B77F1741A9FD836EA196AD7DB8D23A888B396ADC682D848EAB9C4CBBE4688A4A4713943D35C1475229897BFCC418C5F646F8F8C810C58F8D50E062866C7F2BBC8D7B88CC7C676496B823B3F41977CC287441469A3DB2026E21E7D17502A4875CAB6BC8B9A5831C4BEDBF54F64D2D6499AA205DF76A6702E74873ECC55D49290AC78DB28DA8B36DA12240EAF3D5029BEF5EE6254D6DB1BEA2D6622395D862AFD4D8F2CCB8B32980407543ABF3B2469D07590AB3184FB20CAF3BA8F0BE4DB1875ED371DDF35B244BFA8C15E936EA9EDD441D2D0ED572478BAE638255C346377AED66CE55AD2B817A7A03954F8C50ED648C6A472354D8EBA3FC911E57650FAFA19454D23D963EB8868F76245B5D94D8EAE0C3235DE4BA5D477AF82DA4A4D921B5E829D24A9D9156E244C78E48C97C84D4C8DBC874D447F66D35E45AA820D74C19D9268A7867AC406E2AFF07BD3592C75B2339AE32F4A590A27EBE3345F54C63A6CEA5C4ECEB1CB59C1BB25349BFCF521A4DC5F848731ACDC52D1AEF4894353E56FFD2F8DC1C0D3EF750CFC0314B7A46D6D2AD6A5A3DFBE87B13B921143F822D50EEC56018A3C1F506EADD4C4926746CC41DD96BEE7957638265866A67532EA47A2703343AEBA3DE510FD58FAFA1D2FE1A6A1DAEA1E6B1362A1EA8A3C2AE4B65B66A28B55145E97D15922A4AEEA9A1F8AE3A8AADD8A88AF78F5491E6A98DD857C6789D6585B80F36882FB1E58EB1EFAC91106D8E34173D64DF51419EA91CF26EC820F7BA34720CA5906D208977B4449AA57B85AB9EE34CED4BC8D4BE8C4C3D496412CC0C3335A49BAA7C49D7972ECBD0BA6891A1797E0E898F6B81AC706ED2DBCED7A4BF7D6E93E16ECB26F363E54D76B26874D2430303E1DE0584A9CEDD1C551E1473FC4C91196184D8580324BC36446EB0212A9FEBA2D185C9004D04A6D949870BA8815ED31A301A9C0890D375543D3140B5BD36EA1EABA3FEB12AEAECD550F5501D95761AA879A0866A5B2554D828A0C25691A484326B0594DE9127C971C78FB7E55174530145E60A28B09247BAA33C6242541091A483F05C43447E30C68B8FA4F737104DD717FB4C13E9B7E49143D0F208D87BBDCBC8D5BD841C261D09646B5D4496FA79BC256569B0F11C3255CE208394A94360C995B39F5AE39D930D326EE996A7EACB58A6EA5E9D9BA273858FDBF222807C0DBA5BF9DBAE6D5AF1597FB3CD67E33D959FAD4EA2ED81345A1C54D0ECA88926276D3438EB92FB51CCF1B981D4177A884CD24070962A42325411F35A0DEFFD5451EBAC8E26FA7C8BA3065A9EAA9334D0F454130D4F08D6132DD43EBD86EAA77AA8222BAB7AA8822A3B7954D9CAA3E2BE3CCA095405012A275065D6DDBA4BD06EC9A2D44286AB1252B1190785C6D2283091A6524306B15EB2088E9387FF3B250414A822B0480D41348624AB20CA5711F1D61CA4EB49204BF302DE11A02C0294A57696ABB74CAA044AF934D2954E224DF104D2156954388154A553E4BE1C8A9B94A0228250F03A0AEFBC5D2B331EDDB249B5D45D91A47C8AF50EF908E0D6C1753A5B859B7537CBB6EB89467CB9BEB9E18BE96E745A1EC567EBB3687D204596A280326765BCF75247728416C153855FB63C7CF2E5E09D2B87C0243924042A504654A4CF2AA185D4DA2D8AA768B45741FD53F600CCC9DDAD5146F1B2D28120DE9745E55D4902771515B7A450769383D29B04CC52061F2D3928369746B189143E1A4BA2C4F82A3EDE9044D1F52BC83794408EC965A4DA4A232248163EE9B2F0CE97856F911C7C69F449974660C85544DB4A20C9E02C32D54E2053491CE90486C1499317271D479ADC31AE52E5C49022F31B92394790CC467A3F49E312D2A894C90DF6455156160AF30A919D10DF90E1E5129162A22A9B488BF70470304FADA6E8E85A2D51F1466D91804FD736567ED1DFD80E43517C31DA827602D960750C1F1E9E43B2EB4544045F867F8224BCDE49C1AB40129E8592F0784F63AA2442822591EC2C8D92471C343C9041B39D0C5A2814343F9047C363354A20142B69A650F432048534972DA76453F550155556575165791195E617516E7A05A5A6048B547CE30AC19240A1C1457C30388F62837328D23F8F02BD73C8D53F85548BB3887E7A197E9157E1F196AE23FF2A3C0BD8F11578465E40A0C369C4188A2355F937642A1C46BA1C83731449D224A9C348923CD0ADFDA0763E122FEF45FCA53D88BBB21FB18AA7116BA685642F7764656421B7B406396575C8CCCE6B4FF571AF4C32900D48943E244E0047F3D4A9AE9E40926A545F93F649FBD7F62F7A1B403312741A6C40D3F50D28B01041B49D28DC3C36E161D4763C4CDB8F27B9BFC139FF385C0AC4E1927702CE9927E0FAF22482BD4F23F3C97994DB48A0DEFA129AEE49A2C14E814A11437CA462BA20F10D72B2DE213B3D150551FEF8E04E05F13D5594595C46B9F159945D3F8DD2EB675172FD3C3E1A9CC607DA1FF34197F6C9E888A1505B0C055A62C82365E98BE195F53178F988C3398EFEFE6C125D87D3BB13708C15C773F76308353B8A38954348E51C401A673F52A409D8D503046A1F686A86C48B3B493B9078610712CE6FC39BD39BF0F284085E9CDF85179A9278F9F411E26293905A5885F4F266A496352131A708F19E6EEDF1BAD269F19207A4122EEF99C0D3A8BA626293EA724E8BFACA8CCFDA6B3BBEE8AD4787FE7AD41BAE418EF11284DC9E8B074FA6E146E01418BC990593F485B89DBD1AF77337C0EE3D41CDDD8E07EF76C32E692F9CC20F20D2ED3764DB9E4085D519D4DEA10D430F3591EF6587ACD72F909E934FA5450552F34B909E9E89CCF040643BDE41A1950AB9E70594E81F47899E18E9183EEA1E45B1D6417CD03C80228D03C8573D803CD23B7A1D7F633FFC1CF6C13E722FECD2F6E061CE1E3CCADE43D74063C01E78DCDD8B171A7B9120BD172957F620F9F21E2491122576811A03483CB31989A745107F623DE2C4D620E6F04A44EE5F869023EB1028790C41B78C111E1685E8AC8F8829AAC7EBE226BC2AA845544A0E229F3CEA78A17036E3C5A92D9C287191893C2DA6071792EBAAB7EBAECBEABCF66B6787FEAF5C7899C60BE1757B2A6E3A8C8486EF6028BD1C04E5A421504FFB093A19E36098390D266FE7E266D612DC7ABB16B7D337E0DE6B5138FB6C47B4FD7EBCBF4BD643413EC7F12652228211979E8D37F9E578FDA106AFE9A9BEC92D416C720612430291F5E416F22DE4C95D4F91B5317087F0417D3F0AD5F6A140752FF255F6224F792F72684CD4D905FFDBDBE0E0B919D6B19B7027531477B34869A2B817298AC70E9BE0A7B7053152DBC8C2B681D67C91746E0BA8258584D3A248105F8F04B155883BBC046FF6CD47F4B65908DB380DFE5BE6C3EBC40E78196AC3C7CB1FFE893908C8AE42E0FB5A04E6D42020B508BE4151F036D2EFF43ABE3DCB6FD7527502B890A7F1FE158D4F6607DD3B0D379592E575D61AAE429A89109E594DC68D270250F4FB119C977CE024F6816C0A2FE493FA42297620545E0F837AEC4868278D835EFA741866CC8151E27CDC0C5B0C6797F588B21543DC236DBCF27643446C0A42E86986BCAF40485E659772CB11F2F603C2E3D210E3EF8B249A97669872904BDBD80A1838E5DDC857DA8D3CC55D5CE52AED429ACA0E841B6EC663FB5F712B74352C5356D1C35B058BF455307FB30A779FAD86ABC95A84C9AC43DCD975483CB91649E2AB907C6C29120E2F42DC7E21C4EE1144CCF65988DE34192F368C43D8DA31F0FD752ADC0E6E84A3AA021C9FBAC3E555065CD34AE09A590197F472382714C2D9FF255C2C2CE172E670E733D105A521BB16BBA7481FD2E0A9BF2F99DD7CF35869ABD1D6B61AB2BC54532138DD9900FDA74321E7F703A45FF28293C0034E120F64E2FB4021BA2F34030742C76B0854FD064331721014130643256D38D4524642F3D53898792FC1E3A7A7E1F6EC2EDC23A2E19A980B978C8F70C92CE5CAF52D5319DC324AE09E52008F5729F0F7F6C18BFBC64834BC4CE5C521E428EC44AEDC36BC97DD825CD9CDC894A318A5B601AEE6AB60F97C318C5E0BC1347D01CC3217E046C20218F90BE1BED542F8C82D42F4C985883B22848443F391B87F1612774D42ECE6B188D9300A2FD7FD82C8953F2164F130042D1180EFDA0970DDB7168F146470EF810BEE8524C126AE0036C91F6193540C9B5739B0F58EC643332B3C397918CEAB67C26BC9B8B6E87DCB4AD3650E67F3D4DC3EDD596B76B8B3C4480471A6C2786A3D117A8E4321EBDF0F522FFB40BA1B1E27B60FE4C2F9A0ED3110B68F7E81F3BDF1B07EF00B749E0D866C443FC824F4837CF28F5020ABD4085E0B230F5558F87BE256742A6EC7E5E1363D4526ABF802DCA1F16E6231AC934A609DF811F762F3F1202C912CF739FC6F5DC72B9D0B4891DF87B7529BF0EECA5A645D5A8504A915F0D45E042BDB7930089E0EBD448AC96993A1973409BAA11371C37632EC95A721E4F834C4EC9A82375B27E2CD96F17823320A31EB86237AE510442EE547C4127E842E1C8400E1C1F05C3A0A8E3B96E13EE70A2CEEDAC3D8EF0D8CA37360F2A600A66FF2611699899BEEA1B03632C7C39347E0B87A165C670E86B7E07044D14A47F2851D9D3CC5C6BB907D8332ADD922D8DF9F085DD7A19009EC07C96E780CA0D46B72DFD07ED071E7C7837BA310653213E986F311693C13F76D4641C5730038D104316E30645ECD827CB03854A8B9A011F4125A916FA1159503EDC86CE88665C0282801C641F1B81E9E09FDA83CE8BD2C84FECB02184664C3C4E70DACED5DE06CA287609A09C45EDD8294F3CB287E0922E4EA2CDCBF3E193AAE63A01E4D969EFC13349204A012351C5A8EC3714B73249E9F184D37361A6F36FE8C57EB46E0E51A0144AD1C86C865FC085F341061C203104A0A5AC80FAF65A3F078CB62585E3C0B03F3FBD07A1605CD900C6846E64033E21DB4839261E014809BD74D617BE2209EAE9AC185E73EA92FBC670D42C4FAA91447978127517709FC6FCCC65D02A3FD9C1F0A644D9C375D96C785472E2C13F003749C87E0F1BDB188359E8D62DD85A8D25A8A3C5D61F89B4DC50DFB115008180AE9C8A9B81ABC1F577C8D21E9130429FF644807668213900959EF24A8BB84C3F4A1132CED1C2844F843C5230EF2FE19900D7A07D9C02CC8FBA642C5250AFAF71C714F4F1B5E54B7BD38BF1221E7A6C3417E34F4AD8651581908B9D81FA198D41F0AAF495E3F40CF74001CCE0E45E88E9FF05A6424DEFC4AF0560FC70B066FC5500238980BB0079EE7D25F60BF69218CCF9D818AE11DC83A8442DA87AE95AE533A2003329EF1507AE88BEBBA46B01127786BC9F2660F86DB643EB84FE803AFE93F207C19FD3D9B2783C74D6B3CAC2C7E829A4B7F72455EC8529C93A178271D4F8AE685825F7F183E1986A777C611BC3928BBB6184D5ACBD1A2B102359A4B91AC2708078BE9D07C3207121EDB71FAB90E4E3DF7C429BA88535EE934A6E3AC5B3C388F0271DDF21E9EE8A9E0B9360776D70DA07BE729AE3A84E1AC7B3C4E7BA692D271E659322E3A4442D1D201A69A6A7824BD0FB6B28230341C0145C71F2015C962721F70E83A39A17DA06CCB070B851FE17D60285E898C20780471AD00011CC6B5BE17CBBB5C97016496E7B9F4673C1059088313E290D1B1C439BB109C724FECBED6349C718DC5E57B5E505337C44DB18378B26616DCE60E81FB1482378907EE1379E039B52F8285F811BDFA27F098E80C86B6F58F900BE085742C250A82C7217832517C50F6FD11A60E23E07E7B12528CE6A15C8FE0E92C47ABE60AB4AAAF4003294F6319FC745743E7E63E1C7BA08CFD8E4ED8E7FA0AFBDC53B0CF2D15FB9D6221F630008A1677F0504B0A2F6477235952142F3887F0505D11CAA636386DE38FC34F63B0DF2599FB9D034E8938FA200217CC1DA0A8AD0245BDAD90BC3F0957C9FAA4630960220F8518BA4E775EE819FC00FB33FC08D92180D7EB4770E1C5AC198E5704307A5517C0F0C5FC085AC462DECFB0DB301FBA62BFE1A28A298E5AF9D2F5C6D3DF9946D79C8A834FDEE0B89537A4548D70FDC801D8AD9A05E739046F2A83D7870B8FC98360FACF1B40896808787474FB43D5B61F64C3E889B284C12C90E0A97B0F84D5A39F29A84F43E60D2154EA2D453383A74DF008600BC1AB535B8D2C5511B8691C819C910A765A3FC4C6C761D84817B5D13111220E31D86CE78383776E42C3E80ABCA80C49935C86FC0BC27877610522A9C8B5519486BCBE258EDCF2C0B60751107D42DF7DCABE1B876DF742B0CFFC210E508D78F89128CE044E8424B92F27AE0FA482FA40E91E1FAC6406C2673F599BE8084A16BFC363005F3280E4C2C14B87C273D92FB02178EA870FE1A4AC1E769ABA43F4C14BEEDFC524FAE015769979E09C8221B40F1F86F5AA39709C3D046EBD2CCF7D0201243D9FCC4B71F007F80B0EEC0668D7970B508A629FEC8BBED0F6E687CDA3D108BD391379468B51AFBF0AADBA241D8247005B0860BDFA2A14AA6E4488CA61186A28E2C88DFB587537008BE94216DBC762E9C368ACB2F1C6C6FBE63874FF34D42DD6E199D602A470E6A2F0E25C149D9B8FACB3CB1079611BEE72247055D318BB4C9CB1E64E2896DAC560C943FA0DBB57584EBFB9F2B62DD6DBC893556FC269CAB897C20642D6A92FF4747F84D32982B4ED27BC59DFE5BAAFD60CE35A1FD785096018B9B1F7AA5F60BB5110EA07F7E3A89436D6EB3FC532AB502CB47B0D21BB37587827126B0C5C70505A0FCA070EE1CEAA79783A67185CA7F4EDB2BC6ED7ED01F88CCE794DEF07DF593F82475BA73F94EFF783B43F2F2443FA42CB63301C1E8C47CCCD79F860B40C4D066BD0AEB70E9FC84D19C01602D8A8B90AC5AAEB1149B3031355291CD6B98565A61E987D270233EFBDC44CEB48CCBBEB8D15F76E62DBE3B338EEB618F28FC7E2B6F12884294D41CEE5D9283C3717056704F1F6CC62849F13C19D2B277151E91A44F5EC216CEE4FBF15D9F55B775F60D66D3F08DEB6C3CAFB8AD8E6B015624F2743DE7C38ACAE08C06FFF48BCDEFC0BE2365050A7CCFBD57D0960F8AAE1F05D35120F36CC80EAFE5D3878490DCBB51E618E993FA659BDC044AB684C300DC52C0D27885CD0C6E55D7B61BE92E0CDA3B035ED07B84FEE86D703703C5920E9F9440238AD07A0567F28DEA2CCEBD40F9A94691FD98E47ACC57C9AD8AF449BC13A74D2BCB8A317C026ED9528535F8718E55D305392C0118D1B103270C644F3208CBD158EB1374331D1CC13732CACB0FED1051CF159860BE1232145C948D36E109EEA8E429CF434E49E9F850F6767A3E8CC5CBC3D2584B0D3EB6025F11B2EC8AA62AD8635665EF7C0788B50FACD288CB58CC478823ACDCC0E42668AD864BC1DD24A8278787C12C2768E41ACE81F0146511C0C5CFB0B1E6C9C09C55D9BB1F3AC3C0455EC30CEC01B234D4231C2341CC30D023146E909969ED6C289EDFB61B86C0EECE70AE0D98CFEF098D617CFA7F0E2590F4416FF18C071140327F1C28F5C38683EB9B0A13A2511237E5CBB3B0C8F69061267361FE55C78BFE20B7565B89D996E80CD04AF42732DE295B7E18EC2191C52D6C31CEDC7F8C5C817C3CD4230DC24083F1B7860CAB5BB58460DCFBD4E6B70FEC54848C6515D19DD07F21EFD606E3914BE4A63917E691AB9F12C149F998DFCD37390718AEACAD32B70EBC21E8849494358CD02630C5D2160128261662F309C6E78E40D6F8CD3B3C102153588491C86C591E5F0DD311D2F45C6E0F5AF6489CC8559F2A0122678EDCF78223A03CABB3763D3090EA6C8DCC5506D2FFCA81F841FF483F1A3365DB39C03044F6AE3E8D6FDD05B360FF6CCF2A677C1632EEA49E33700590C24889E54CE04090EC08B6594441EA88EC7E36B13E169321D89C6422837FC165E17C05FD1A6BB06B59A6B90AEBA05D67227704456033355ED3054D70B03AE07E147A3600CBE4637A86A8B152A4A38727D1BCE3B4EC69517FDA99EEC9ED15099A4EED89F0A622A333893907B6E260AB9006723F7E42CA49E980D8FD3C250BB248A2D4AE73045E73A86E93B6180612006188581FF4630BDF6C428950758744517278E9F84F9EE75F0DE3403511BC65012F9895B3C875279E1B07E1A94768860F371494C92BC85416ACFC07B2D087DAE05834FD31743641E638EB8360E6C3D04EDE5F3F14870249ECD1AC885E74159F70F007BC5412F2A63C284F911B3760478223417238E8AE95CC3E5A8315C8D4FBD2C8FC163EAA0165783CE7A6A836F81A3BC184E7094315DEE2E06693C079F5E1078F582D14FDB0FA3949F60ADB43EAEC81E83A1EE2268DA8EA4D84AF19592934C3265F83852202FAED90E84AB06B9F2E5A9C8393B13F9A708E0899948159F0AFFF313612C3F05E2FACB28AEFE8671D775C17FCD1E3FE8F9A0BF213D2882F92359D2704507CCBD6484A3BF9D87D1CE0D78B689BA2A0431F8D7517842CD01D52DBF42F4E8654CB86C8181CAAEE0D509000F83A7E58721B20E9875F21AF66F3D02CD65427828F80B3C660F82F7CC1FBF8263D6C7407EB5C01E80E4CADE5448472CFF09715B268227FFC64E6A626E41A3E106B41BACFFEAB63DF0981BB75E13A166E676B8291DC3451945CC97BD85C12A7451DAFEDC27DA97E00D5776C20A6913A85EBE8467525B11A4361F3616A3A8401F00592A7E65A876630D0936BF967FDE0FC61643E0A13406A912D3F0FECC2C649F9C81845393E02EF333F44C86E0D2939FB0DF792E96DFDB8309D755C1AF65877E3A5EE8AB1748961488BE5A6445CACE9871D91C7B8E5D81CE6E11D86FA1DEE5E6B950D9B1115B8E4860D225730C5072E15E278F6E10171EBF8213669F31C0811D62D05CB1080FE68FC2F3D9FCF09935804405F98C1FB810FF00EF2BC03EF4B98188DA3809C9471781A7D6EA746793F9A1CE7682D813F37AE0B1B15D6F234AB4B7C15FE528E4E4E4B058EE26C172A61BF0439FEE8B1A46F016CB9842EAAA143CAFEEC13BE9D5C8569A8F400A0D16D6C3A0E8438D891872E3EE198E54382F949EF6C7DDEBC311C199808CF3D39176661AC225C6C1466718549FD0E743FBE242E4101CF09C8115777660A2B62286A8DCC50FEAE48A644DECC1B171A08A1BA65EB5C4F613D2B878E830E91036894B61D2156679BFC3E3A5EB1DACE08899E78CB06FCF4968AF5E82874263E031A70B1E2B497C66F6E702FC26F631703DE216D20470DE60BCA29D7FE9125B3AA99D7535BBD5F2586927B5B37A83EB8157ADBB05516A07A121278575722618A9E2C87DFA0C1EBB81212A2E1094B909090AFC4ED4014E97598B72D9C528915F8064951970B93E1ADA8F07412A840FD2540073C895A5DE903506F041CF66101C357F46D4D58988BE34092E8A2361747B20E4E93D69EAFE48C5F3E142C4601CB69F8E0D3A5B318F2383511C2B0C5075EF72C9EE6B60F16D9C8C0DE65C32C65C09438C95B98781DDA0B96E4B16C8AFE884E9E76F60EFDE53D05CB71CF68BC6C09340F8CCEE82D70390C1EBC9BE7F705F96441840C1216D2FF72E2ACD943D98FD4D4395A075F640ECD4DF881ADDCD78ADB61F37142E638BBC11C6A838E0072D1F7AFA148C7502E9229F63B6FC5D9C9052C043CE61A4CAAF47A9FC52D4C82F44A59C10F2E5E621527D2AEE588C84AADB009AE1744DC3982B4BBFEA0345CACAC69683E1AA368ADC79346EDE18021567EAEA50C6E67E86664692E17D216D274065CB5C9C3EBB1D1BCF70309192C200250A21940CBA1E6420FA6B7A631059233F3DD0FE9A5EDC84C1A317C27D6F10859B6917A950DF7F1A1ABFAEC0A3C5E3E02538187E737E87F73D40E6C2DF94313D2E3CA94FA7E7AC01A56122D3DD53AFEED1F8434BBF2B696C44BDAE289235F6C052F102F6CAEB63A2CA63F4EF8147173D40D31393156D7190A3813B9C638893174599E20AD42A2C42ADBC306AE48451262B840C8539F0D19904F37BC3A9BB4D09E535CDB3C90AB93131929A016EFD60716708AC2C8741CB81A669C10499CDC5E933D2D446E378F6C53593C1B847EE7DF7C802281FDE81ADE4AE5328390C2297E4D3A0074AD7C3756982C6E2631F4A6A5DF002B850A7509CDC71F83C5437AEC2A365E3E0B36030772EEB37BBCBF2BEB7C0BFCCC20491ACB2D3636ADF2C9F79FCEA915BE7524BFFBB45A50E5A956BBA268A0CCD9DB0533E85A3F25A98AAF40003E9A9722D8FC4408E577E841D323A30E69C428CFC169428AE42ADE262D4292CE40264AA921546B12CB9B2D26C38932BEB3CA684428064BA013150B22F78A11AD00FEAD4FD96A7862D87DCBB07B04C182F54ECFAC34A996A47B15108DE3B054E7B85A17D602B761FBB84A9174DC12FF7940B91B93383C6A31FFAD5F298AB4F26D05B0F5F84CA26EA3AAF9C08DF4534375E403D41C11F1130F7C76F20F6C4BFBF02C85C9ACA9C0EEF59FD337CE70CE0F8CE1D38F19B65CD565AD66CA68C9BA7BB1D8E6AE238A5A08AD98AD618A8E1C17559068FB9F02865076C9433849ECC3944C86F4789CA5A34A82C4383D2EF0099055613C0728E30F2398288549D026B7301A8B9524BEA052514B2409994AEEE0F5B2A90A1F8C8AC925BEEB06C4D4947E1795F185391EF2A41F5DDC13188DB351E913B26C369FB3C68EE11C1EEA31728AE19819FCA123E75EF2E886489EC5A07A8B863FCE59B103D7C098AA26B61B772127C970C43B0F04002F8231760E0BC1FE13FA70B224B203DB51F8B837F56C63097F69D37B03D64D94F69E1AB474985AF1E3DE1EBC27ABD966840BD8E686581F6B6761F8DA390525680A0A215F8D5BA02367313963C7EA224B24AD6184A9CCB0856D88D8F2AEBD0A8B612CDAACBD0A8BC04F58ABFBB70950C0194222B945A8074D9D9F0D51E0F63EB21E078F78524C540EE3A4B6AB708A62C3BA6519AEAC5AB415474DFEF8F478AC3114E9DE68403E390B8731C62B68C43E0E60978BC791634B7AFC3AE836730ED8C210673ECD157D503BC648DFD95DD31FAF22DAC3974199222BFE2FEF209F022CB0BFC0E1E03C8C400F6581F83D8039201FB9A81C97D9F4FE56B0F5838B4324A6462C0EB5DB3C4DFEC9E3D9ABBB5A3467BAB70B9E656D95CB56D11FECA871A9414A4B142D11CC3D47E2F0358D9C2CA9745B21690E670E02147EBB4CA1BB8F05AD496A34965E99F5A6085B4304AA5845020351F710A33606FF80B341E525F8F32AD64773C944D23784C04909B3CC842E51DFBC2449F1FDE123F23F6F03824ED1E87F86DE3F08A1687C244C7C08B8A665B9A6DA86E5A833D7B4F60E6096D0CBD4CDE22F510BF5CB0C0D2439238BD71038C974D82D3C2A1F012A2844196E7DF6D793DF07A5B2083D8A33FAB059F4FE56DF09DCF1FF162E304D9F88382C2094784686B076D2E2A54DFCE1F29BB73859BD43E1B5DC973951B693631922AFDBE345FECAAB7FCB985332BA02F482BC059EE28B29545B9FD40D617FC33802C063217AE24172E9314C64749216473E651FB6B32EE988C80324DE924BB7B900C1C03C8AC8F953832BED428B51C80C732028838311609FB26207E3B7588C8FA5E6C1A8B605A5DF35E3B12CED4A6B25E3505CAEB5760E7F6C398775006538FAA62E99E8BF86DBD08B4974CC1FD0543F074C140B850DC739F3F00DE73072080ACEECF62604F1DF867C5F4B32914FFA6F7ADF49EDDDF2670F1B015313B67F2D33FC0619B8BB6F15C3F7784EFDAD9A373D5CE895B1E9390299FC5B98DFEAACFB9B18457B7AB5C9946533736857B2AF71BDE2A6F468DDA1A82B792DB9966EA71E19E24C26220736166810C60E955617CB84AAECCA1ACAC391ED7EFF043D68B92464C77D260D64731502A82323315D2D65AC31078863A2D472622610FADB06D9B80E8CDE3102A321A7EEB46C273B500DC5608E0F1B29F61B16C2214572FC0B1F51BB07BC3769C5ABD0A1A8BA7C272C170D8D1A4DF9EC03D9E3F084E8283E0F937007B2CAF7709C39287E74C6AA00A0F290F5E36C23264C54F7343578EE4FBFA2F980C3997F948733465A42CC46535CB66CADFFFF2830A01D4F0A5CADF139314ED70504683DB444857D98C5AF53568D62078B42EC2E0310B6400BF4F22DF00BC2284924BF35170691E6264A6C24E6F0434EDFB83655A16F3B80B581417E53C689FBB39CD95A5A9BB726C02920F4D4222018CDD3A1EAF368D41F8C65F68219C00AEFD091EAB47C065B9001E2D1D813BB44469B07C0A3496CF84FEA289B05A2040D3B44104EE4738104047EA1EBBCD1B44B3882E0BFCDE857BEAC03F73DD67140BFD84877D89DE3AB32CFEF0128B44B11573485D1B2CD91FE7EB6ABCA4A976061A6A329A06890BE5AC1A07CB3EE91CA0E88231F20FB04D460F37E5CE208EDA58151A6BD1AC45F0D8BA482F802C06B204D2BB8CE9EDC2259716E0C3F979787F6E361268FEEB49AB6C66664320F7AC2FAE523D7895D6382403FA40DDA63FEEA992F59D1D838423B4167380E69CBB272071EB58C46F1A8D979B462188D67AFD09640081F4214B7CBE7C38DC08A4234DF0EDC9221F2D1E0107E1A170161E04378A7DCF28F6799025327881DD319095303D6271B0772DC8207E4D2093A9FF37BD6F67F0CAD18D89E2EB1273148EA8E5AB9F984AFA7D8B6FF02DDD3E24014713DD8D1C151DA35512D792265E346F9E2869D5B989A3876B721711A5B20BA51AEB68458EE06975AD8BFC530B64EE5B74710172CFCC4306350EE2CF4C45C885F1B0551D01555AD0BAE2C10B093F9ABA3992F519D2F4EEE2CF083B4C8BE27B27217EF7242450FC4BDC3206495BA983B38DD67EB78C4538B97204010CA3F65508759E83A975CF14B862187C960DA3DD0343E1B398661B8B06C19F2006B0D285AC3198C4E21F83D6A3EF0B6A16037B0052ECEBA4B8D71CB2F297A4C463AB8D0A34CF6C2C31E608907EDF641E6A758D87D4D7424B5540EC9CF40691E31CB395A75592B75E526BD49495F812429B7A8A3429E36AAFE2B6F47BC3FB4F319025102E3C0961EA402F40DAE9B9883B3503AFA86D157A6C0A9E5E18033DAD2190BCDB0F171ED292AA593F98C90E85DBD1D108DE3901912CEE6D9D80D7B4C3209EA02511BCA4ED1417E9388600C6AC1F493DC01178C55DC6A4DD07DDEB2011043274F950842C1D422B67B462471043160E4408953121049341EC29A2BF87C72CB117C02F94791B7DE6F44F0E5E3ACC2C7ACBD40D6F25770B949AD27FE063DAEB7F40EA06C8B3F7E839BE1D87CE8E3C2C7656E4D299B39606574E16FA2BECEF2CD214A57E20250D1DB2BE3F01D893857BBB304B222C81145F1626B7A5291D595FFCE999883E3E1561876837D43E6A341C994C3B034642417D202ED3EAA0BACC20DC393E02AEBB28CB6E1E037FCAB8A154B6446D1ECF859840E012B7504DB87934E24547219E7620B0B590D8EEB5E057BD973369352E7CE9608411C0D02583BBC48E696742487721DDDB75FFE0C25379A9EEE3EDF49CDEB790005A062EE417095D3E7C64C4DA9FF918BC6F00F6C4C26D07CFF01C3A728ACFE6E2BEB1CFAFEE968E90D991FE5E75737B133553DBBA1795B82B737FE2C2AC88EE1DFFBE02BC2444AE3B1FE92767234E7C1AA28E4C41C83E02B87B06BCF64EC593A36361725E003A1787C1FCB79178B46B345C08D033D1D1F0A298174000C3B74CC02B521C65E1447A2F79CB28249112692D84418CA51539B61BE19B35E19543A9E54E3B12682F4C18DB0FC3E091253280A1425DAEFCFD54AE773BCB631A1F7CE60E680F5E3C2C3D6CC54FD2A4B104902F74F9B0FFFCEFE532E54579480259F2A262F94A2201351AEB2BDB74D6B6B7E9742F6B762F6D7221F64A22BD67213DCD04E6C2259717A0E0DC3C649D988564B169787D680A5EEC9F8A70821742735BFF0313E17A640C1C0E8F81F3AE8978465D5E0FB23C2FCAB83E042F882C2F82360ABD24C59225B25898B26D1452281E32805C0B24803D96D8B32AF78A9634A30922DBD611B698C0910B73E1758B59E19F01EC9AC2F1C26B66BFF69025C32A63364F0C48D83D432C71EF4C01D2DFFFC3EB8F4A1B7848034A94370855AAACE334A8AD0AA66D1CD504ACA3675DF89F2611EE5C986621C554BEE49D99832CF19948139B81C4A3D3107B682A620E4CC64B52E4C18908DB4FDA3D1961DB272394E25E08810BA7D2257A0715D03B2620661BDB6D45053515D3495BBBACB0C7029915F658E257805F17D687900592FB32804CCC0A69640D85BF02E8359DAF2340F0C7EAC81502C1F13BA670D28FCE17CA10131A40FA7B80A5CA1B7848BCE5CAEB06D5282D17AC535A2CDFA0B224B4497D69458BD6F20E6E0CFCCE85FFAC90EE3D1329BD2A840F1254039E9D8B3C5A40CAA6F58F0CB1E9483D3215C9A4A4C353682FDF649AEF4E46DCDEC97843FBF9DEEC9C44CD83093485A3E4B18B4A180219B79D00D2742E91E263229533891407991244C89537FCCC75E36F001244B6C1286C196D3CA28CCC924930ED8F09A6F226886AC3EF6320D78567F6EBF09BDDAF2254786028EDAD917F23325A30EDF0DC4199C7857949FF18204F8DC2E23E0481BF5661A1102507E90695C50C6235416CFF330BFCBE0EEC9989B06602CBC42554487F2488C5E7695702ADC4BD3F3913D96491EF8ECFC05B72ED8CA353904E49258D40A61E2411CCB4FD1390BE8F9640F78C46EA6E725D0299BC83CA194A24DF00A49A90B971EF9D095FB7763080CB292BD3F68E60DA1F13B880F606CE1B087F9A91F8F5AAFFBA9348BBFF9CFED58182FD43C3160E948E5A3144E8D5EAE1FCAFD78FECC3E0FD23803D88091E0F899734B0564158A84E712159E2E2E026B5A5952D1ACB3BBFAF03FF2C89F4CC831940AE281E965C9C878FE7E67021169035E6D172E6FB133390431B23B37E9B82CCA393B9CA20989987262073FF5864EE1DF51562F24E82B8BD3B91745B21B3C0382A695EF7DA1BD3B3B52382EA422E40AA0D83170D41004DE7FC19409A993088BEBF37553BA9A4A924B70EA604234FB152287209FF407A10BCA4BFB7BCBFFA4437447ECAB0820451A641797178932A4154234BEC9E07B332E6AF92488F05720192159612C05202F89176257C20888504B1E0142D6D9E984E10A7FE0E9166219987C613C0315F0126930526ED188714B2429648927A01FCDE85D9CEAC48B2BEF0AF00BB2D90761304900217F07321B2B63EA99D544900C3C9AD65A8D016A44CCD4FFAAFFFB727DF592273E741246102294373DE6072D9EA66D5E51D2D6A7F3D176649A47733E12BC0F37308E2EC6E88B350404B9A790490896B89CC0A99F51D20EBDB379A0B30A3DB8D9905A6FC130B24806C73519705520CA44412425B7B832879047643E45AE2BC811D01F307559382FDE70E94218B14269083284BF72180FF75CBEBFDCD5EEE3C886B890A0BE5EB15178736282DAD68526110BB9A09DFBB71EFB9F03716D80D90412CA6A91D03974BE0F209E47BF1E964857F0270EF68A4B138487B61926946C2CDC23D16F82731F05B17FE1D20CBBE81944018C4C0F9833A82840655506C0C0D5E3C443E68E16041BFB90306513CE425FD3BF0B8FFA2B32B1E3271130B2508A16AD945D2D5728B43EB14975637AA2C6F6F54FEB699F067EDACEF2DB037406679DC58C80548B1F0F044641E1C4716F89D0B53579AEBC25407F676E13FECCE627B037BBB309BD62DA28D96D41B0CA2DDA5A14B86B6872F1D5A1DB1744868F8B2A1D2142785A848E60F5932B40F83F7AF02FC3EB1507218582EB550A882B358BE5A617970ADF2CACA3AA5A5ED94B13B09F0979E42FAFB7EE07F7261667939C7A7E3DDB16978CB5C9801A4367E6F17665938A9C785FF062077732501EC9D446847E9976061FECEF0E5C3DBA3D78FAA7CB5FE9760DA4B231FBD729850E48A61030920EFDFCE34FE0DBB2477E425F197C92C13AC505CC3A9545A1350ADB82C9DD6830B6B64851A6BE4843A7B16955826FE9A487A9208B97009735FEEF6364A242C8990FB32377E27369500F62490DE319032F16E2A6768177E722F78AC0EE416D15FE7C3DF6EB06489248CE22025934EB2B4C6F025430AE9DF8AA4C7EF9C1A90B8671A2776D358419A43F3B36CFB6FB0F947BF41F0784AA516F729555C37A84C79BD50B9D25AB12A8565D2551C21CB2AC9F9C9343657CB2DECAC9259F8C724222188D23F2411DA09FB3589B04CDC6D81BD5C3863CF28A4EDEC9AC2256DFEBD88EE29A4BF7761AE05B224B28A9605568FE88C5AF35373F49A11C9541C5BC66C1C2D9DBC7F9658FA6FF3855891CCEABCFF56A9F28FA87DF7A19E190B8D03CA95D60954CA2E195B7E699E48F9E5F9661572CB922A95D734D2F8A5AB9D4FE54B4F1943D3BAD20B73B910BB4A194A22DDC9A32799706320B78C617560570CE402DCD10DB0D72CE42F01B2F61675AD5F8A8EFFF27AFBF4C6D86D5392E244C798BDF975A408CD2EC6A61C982D90714C68C03F9E61FC5720FDA7EF740364D33E1E02C85376612E1F41195926B36243B9CE2EA372BD7D89654AEBCB4AAF089753ECAB24800DA476D65C28B928881202C85C98D581AC98CEED2EA6B92ECC2CF06B1CEC766302984E6DAED4EDA3BABA31BDA7723D59984DE5D609B4C7AC1DDE10B356A0924095271F122ACBBC209A98796E8351EAFE391B1245478F4C101DC547007908207776F17F35C3F8B741F6FC1E65549E5289F97CA58647054A2D2F6E2C3539A956AABAD9A2F4CA424B0268532AB524A2446A49E5874B42ED45E7E776149F9BDD495B7C3B0B68776A1EED0F7C4F1073C467208B0BB07B46420B4A9907BB8AE90C2A63B800991552119D4C0D85246A77910576D24CA4336EE3CF1D719B46B5C76D1D5B19BB6954046D3AB749D832DE32F3D42A8B7C1531B5229D731BDFCBEE1348DE36818FBEF33F85E1BFF7BBDDFF577DDF526B8E40A9D9D9A9A56A5BE610C0B9A5928B5794CAAD922DE6AC0828B8B8202DEFD4AC0C4A1E591F2E2C282D9458D4967F6121F2CFCEC77B02994D99980B90C13B4C2ECC6623545077011C43B5E03864EC9B88746A89A5EE99D696BC7D6269E2A6D159099B466724ED9A989672784640F2C169B2F15BC6AC48DC3A616ED699B5738A344F4D656DF83F7492FF7BB7FBEF7FBBE73FFB27807D08202F01E423807CA50A6BF94B957E152E9659259E776181D4FB9333384517E6AB172B6C70FFA0B6A3F483E2E6CE22C955C83FB7806B85DC32862590FDA3A88CF985C4C6D1787B6002CD526620FB9430722EAEE9CC91D858FA567C997BF28EC9EA495BC67052F64D914A179F2B9E717A8170DAB139FC89646D04908F00F2B2358CBFEC24FFFB28FEBD5FEC8E957CA54AEB0717CBAE1A4D0027E49E9C39B15851646189F1498D129333D925BA473A8B697757C185450470665719C3E0ED1ED1A53D23F176FF686453C726F73459EAD575F4EF89F77516699DC82E543BA691756AD5C2A42D632712C009E927E68DCE3C2B3438F39C301FE9DFBB91BFF8A5FF03C477C5381B35B39B0000000049454E44AE426082</ImageData>
      </Image>
      <Image ID="Idera.SQLInst.16x16Image" Accessibility="Public" Category="u16x16Icon">
        <ImageData>89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000000467414D410000B18F0BFC6105000000097048597300000EC100000EC101B8916BED0000001A74455874536F667477617265005061696E742E4E45542076332E352E313030F472A10000025F49444154384F75D3EF4B13711C07706152E25F923DADA77B1C4550F4837EB89C147C851E54A410895081E498892E5D12463E988EB9A60D536C63A5AB16C27E383767B932A7386F5373DBDDEEB8FDBA775FB731656707F7E0B8EFF7C5E7FDFEDED5D4545D5256AC67B77C4A66698C849D5DE4E7EC73B2EE3791C4865759C889F5D5EB2BCF1076EB99C09BDE44E403CF31B310530BC8702164922E088C097BE1416C0586F865A7BE5748EDCAA1157B9B4AFC3B0F60AF744B0C907103FC4780B502093390B420B569C79CE931914DB2F85E4DF2FC12508801F94D40FC4637CF943627E9E6C418752D48079FC0FCE28A1CF05A9A483E360729F11D05CE05081E489C13D28E19F9350D32DE4624A71B10EC398ED1AE4B7260DE748BE468F6EC1F1DB2D19790D8093A8C1E99A01A69C7493A7D1DE2230A2C76D7E2EDB38B72E0EB888A64A336A47DCD15201FD7430C3683773414816D430978DD71410ECC0EDF24C2CA2BB0EE1B45A0C08EA3101F284F5002E265A0FFD17939601BBA4E387F07B83220ED03C508CD344219A011FCDD0AF4B41E014CE9AF11D6FBF010403BA0114A1D1C8AA0AD85E6DE39F904137D5709EBA9028E28D14F81CEBB67E580497B99A42A80AE780AA512D5E03F1D74B0A055E069CB1939E0B61B3C294F2BD21ED5C13116231CEA8096E8D3D4E2B3753422FB1223E11F3B5F465AB0EDBA43817E48A971E4987E888126B0B613D831D661A9EF188CEDA7F12B14E26580C00ACAC8EFB565C7A40953A35A4C1B3B3139DC06EBE06D8CEB1AF16EE03E662C06AC86573DFB6BFFFB578ABCD8C02539128BC608B3C9B44737A20FE2D13861132CA1EF4E556FFC0772EA2C9D3E171ADE0000000049454E44AE426082</ImageData>
      </Image>
      <Image ID="Idera.SQLInst.48x48Image" Accessibility="Public" Category="DiagramIcon">
        <ImageData>89504E470D0A1A0A0000000D49484452000000300000003008060000005702F987000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC200000EC20115284A800000001A74455874536F667477617265005061696E742E4E45542076332E352E313030F472A100000F36494441546843ED997B50946796C623DE52A9DA4DD5566A53999DA9546D6DEDAEFBC7D66C7DB555333B939D8933D938493433C96C743226EAAE9BA849265E27E005258A379418E20DA318011511C40BA220A022020114918BCAADB9363474377DBF773FFB9CEFFBB89854A64A3ABB337F8C556F754B37CDF9BDE73CE73CEFDB8F3DF6E77F8F3D160AB89F0DB84C8ADBDAAE384D0DCA706F8D62E9BAA9580C65CA90E19A62E9E4F3EE6AC536D0A0B82C6D8ACF6952C27EF7B37FD4BD8B047CF37DB6AE545B4F55AAA5A3B479F0FE59F4DC4E83A122190FAE6E4653512C9A2EADC1DD829568BC1C87C6A24DB85F968C8EEAC3E869C8C3604B49F390A122D563E94A0D077DF3FF5F60828EBEE76C3D1519E6960BE8AE4E41C78D8D3094C7A3ABEA63F4D77F8AC17B69B0B49D80B5230FE68E73301BCEC3DC7E962B0F432DD930351F465F5D123A2AD6E35ED187682C588EBB1757E15EE92E74D69F81A9AD3CC363EE7CEE5B87F1DBBB590E25B9DDD59F0E755624A0BF2E19C3866C78CD65083A1B11F21B1009F62012EA072246206CE2E30017FF1FEE0342ED40A01EF05C47C45980B0ED1C82961CF8FA33616F4F45EFED243417C7E1F6F935B87379C7506F5351AE73A85BF95640E031CF1FBC978DD6929530DDDD0DBFA502617F87162086B8CC5C562E8BFE9C3F8BE80061C2041A017F0583BFC27509705D049CF980E3DCE88AD809643E0767D74934156F44D9F1A568A9CA82C76E8EAEB4860D254FF57E9952D65EFC3EBCFD0540B08BC149D012F0B0BEE4B92C0191E00735B83077DDFF25E0BD06B88BB82E337009FE02D759C096CB95A3AF33002160BFCC0C55B20CCFA3F48B8568BA7902F601C3C433D153B34F69BEB814AE4EFE315F9B561A6AB0367D09C4B8E021C173D783F7F8FE72065F3A16BC9BC1BBF4E0ED0C58821F3EC595C575822B9B3F2398EB26C2BE1674D5E7207FFF02D45C4C9E3840DBB54D4AFD993759EB0C26D0AD95C6E8CE8F043F523A123CEB3DC892F19531F812065FA8EDFC68D930403B37C33E2E78EB71EE81BE6C8470F177031D7018AB707AD7AB2839193B7180D6AB1B94BA9CDFC06BB9C97260DD877A990506AAD6BE042E8FB208162660B06E2C78EFF8E0591E523612B8FDF4D8CE5BB9FBD6935CB2FB02C62CB9AB08510D7B7312B276CE4149E6EF270ED0561AAFD49D16006620D8CA65E0E22E8B38C352E784511F0916B8A5D5BBECBC476A9E9A51779E65E390E0F3B4E06D02208B814BD9C8737625D8E57D14B9250F11C3760C5E7D1D27B6CD46514614002D04B87D7A1E052C8135E9000C5E3211927291C009E5ADD56ADD255D4602972E23F57E9E8F2250BDE6ED12F048DD4BEDCBFFB9F3B2CCD441DF67C0BD0F61BBF233DC4EF91E32B7CEC6E5F428001E9410E0D45C787B29467335ABE53A83BAC3C0450FD440C4AE3DF710C0C9D71C6C957602D8B8DBC3D26118AC55969489940B9785CF2D0CD6CCBA376500FD87808E4484EF2EE198781EC6CCA7D19C3C0DE59BA62363CBCBB87C340A80A6E20D4A4DD65C7854802A848C85AC980B88588A1968355BDE2D44D4CC500321B6D110F51064590538C0FC0493CEE56AE6BACDF7DF60E014B4290791DE2308B76D43A8FE1D36AB17309CFFB7B09CFE2B0C663E0EC3C11834244DC20D02A42710202D0A80E6E278A57A14A092A5CF29DA7F8EDDF42242A673F077EE42C0B81721EE6AD849D17AAE21CC691B7696223CCCF79A7359699F533A3B11B8FF117C756FC357F11F7097FC332BEC6976D2E94C480CCC995318FC64F41F8B81E1C0143426C5A80069092F21FFC89A898BB8E94ABC5279622EDC6A0604A090EE8000FD67B8B93BE16B4FA0A63FE3E61F53DB63849D26C24E13B1663053FB10EAD98E40EB4AF81BDF86B7E615B86FFC1BDCC533E02CF80E9CE79E64539A4A2D4F61354D5601FA8E4D41DB811815A06CE3E33812FF0B9CFF7CD5C4011A8AE2958AE36FC0DD43008B005C22401E75FB193C4DCB09B00941C980391D118A35C26E1371E4204C801001C23D5BE16F5DA103CC26C00F09F08F04F81B3A8927D990A6C192351943C799014218D327A3E3C0E45180431BA204A8BF1CAFDCCCF84F02942062FE92009719D471781A56C07977293C040818B50C841DB95C795C1A40D8B40FC19E441D600133F02A3C2A809601C7B9BF64094D650971F7F50C0C10C0302E0307D7FD026753A3C8C01D0294A54B0604A09222BEC46E1A0F67ED9B70372C815732D0A76540002202C0121280A00AB08D0052420B0930E72B00CC40CE343628C980564203C7087050CF40FCE33810370B670EAE987809D5176C54CABED0006061067A72E1F8721E9C35EC4C0D4B1F2A21D9F9889343481E874732B04DD580B7F1EB19B04B0909004BC8CCE087BE02709D00FB62672177FFF28903DCBEB84EB97AF4D7704906866EC27F7F17ECE5AF10E00D7858425A0628D6110D885D100066202219E8D500FC8D8BBE9601FB795DC4E301D2A7A86D54447C8D007BD7BC88DCBDD100E413E0C8EB707597B0AB14C3756B096C02503D172E0E1E0108F4A5A80021292166204CBB10B6B2A406F6B284B6104013B19F1A1011BBAEFC035DF577603FFB24671D45CC362ABBAFB6D1F49136CA39B0613AF6AC7E01D9D100D49C5FA7147FAE010479D87055BD09DBCD5738C3D85A09A07621B58D3260DA853033A08A584A48ED42A2010158085F0DBB50F9B8364A00AD8D8A886354002333A0B5D149282340F2CA177032258A0C0840D1A1D7E1EC2C82FF410A9C95F3602780B3661E01340D0454113360B1C992015D0311137FCE361A244040E640ED1C2D036A1BFD2ECF2FD285A48D7290E922EE57DBA836C8AE09C0F29FE3E49E2800AACFC62A85075F83A32D0F9EC68F093057D340F53C9690DE46F50CC820930C8C6840E68036C8B40C08809783CC55FC4FFA201380293CCF50C43A40AF9A8149B412312825C0CE0F5FC08968002AF262958203BFC270F35178EFAE87ABF20D1D402B2155C4AA959012D2DBE8370C32B584540D48061ED6C0580662F4413689199886ED1FFC1CE9C95164E0666EAC7261EFAF60B9BB8701AF25C05C5DC41C6EE21ED541A6CD81910C841C2322D6E7400B33D0B05015B15705E020D3452C834C3460D63520256448D5CC5CE9FA69D8F6FECFA203A8C88D23C02F61ADDB064F7D1C4B48CF80CC0169A31DE3AC8478FE7156426DA3BA175235C00C6893981920806DA40B890646CC9C001CD43450BA7E3A12973203495164A0FC749C726ECF2F61B9B54DCD802A626AC04100D1803607342BA19A383173AA88333907F68F0358A066E0612B21836C2ACCD48074207512AB5662329A44C404D8B27426013E98F820BB9615ABE426BFAA018CCB80008C6A40B7121166403573BA9590362A56421B64328945036CA35242AA17621B3DAD95D04356423773A5EBA621E1DD9948DBF1BBE8007276CF81F9D656968C6440EB420E76213173DA20D3E64044B5D39A9550CDDC28807421CD4A8CB5D13137AA02E81930D20B8DB8D1D275D3B1E97F66E2F0F628004A4FC42AD94902F0950C1040E6C07833A76660B484C67B21BD8DEA5DC8ADB75135032C21D50B491BE5EA631B6DD7DDA8006C5CFC3C0E6F8BA2844A8EC729A776BCAA66C0CB0CB8750DA8664E1D6463071A71A1A01B5535205E48CD800CB295DA20D30F34EA1CB824834C337362A7CDFA79401B649A1B2D1180FF26C0D6F7265E4257323E52E46A63A8763B5CAA06B4366AD735E01E574272F3A00DB2D3AA1B9541265D48B3123473B5B3E12D972EA40D3201183D91E96E54B31293B42E440DACFBAF9FE250340045BCD2C84C24404DA2DE46F5392056423F0F681AE08146AC847AA09139200062E6C69FC846AC04CD5CC133BC0A1233371D66317327BE6EE64AD6126061B4005FAC523279B53154C30CE82256DD68EDD879403D9159B43371582EB0F412D2443C9201CD0B7969E65C5F39135B7926363D64E6342B514C80B8053FC581CD132CA1502034A3BDB13CF1E8A69708201A881BB312A300A20199C499EA89EC0F6A8025E466098D99B9F11AD033202732DDCC95AC9D8ED8B77E82DE9696CEB02F3CE391BF2B087943890386167CBE611606A58444C4B4D38E9B73E8467FC32EB44CB3126A0951B47A171A7F260E8DCE01CDCC795480715642E6807AA81FBB95902E54BF330657988135BFFD313AEE3521E80D763E3280DFED47F783261C5A3F0B0395090458C73BD70514F2AF09F0960AA0CD01FD4CAC0EB291038D7626965B0971A301DD8D8E5A095DC423676299C22676A0DEB4C968DB3B09753B625018FB3856CFFF773CA8BF039FD3874706F0383CE86C6BC1A9BD2B517A781EAC552BE0AE7D87569AC1DF5A4C7BFD3BB58D068CDA896C74127FD32063097938899DCC808300E285ACD953550B6162E9F41E998C761EE89B92635095301507173F85E475FCA6A6A9192E9BEBD101BC6E6FA7A9D784CAEB8548DFF6360A525E4667E17C1EEA17C15DF72E3CCDAB0990A8DB69AD8444C4DA1C484790220E7431032DB4127717C053FD32EF3E7F0047D10C5E441320E7490C9D9CAA057F98C14BFFDF339527B169D8BFF8196C796F36AE5F2A80B1CB08BFCBFFE8003EAFEF1DBBC50E43AB01570B0B7074D72A5E73CC44E1FE597890FF26ACB51FC0D3C27B1F39D45B048016423A116F9F8343692CAD4FF9950233C4DB66F79DB7587A2FC151F2AF18BEF8F718CE7B0643597FC133F034741E9A8C66065E9AF0048E2C7B0A1B7EFB7D24AF7F1F45172EA0F57E0B6C661B02DE40C623975030187CCEEFF1E73A2C0E15E256D52DE4E79DC1A1DD6B911C3717291FBD88AC247E8392BE18B59756E37E65223AEF24C3D8B807FD4DBBD17F875FBDD6AC82B17C117A4A5E4357FEF36839F92FB873E4EF50F9E93328DAF2D738F5D1D3D8F7DEF790B0E8FBD8B8E425EC49588DBC9C6C545755A3A3B503B281D4E2278F1CFCC82F047DC127BC2EAFE2B4393B4D4613DA1EB4A1861F7EA5E022B2338F222D650B0E6C5D8194F845D81D370FBB7EFF3A9256CDC68EE52F62EBFB3391B8EC47485CF2236C7EF707D8F2EE0FB179C98FF1F192E7B179D92C6C5FF9063ED9B00CFB9336E2D4B13414E65F446D658DFA3706FA06DC2EABAB36E0097CC20EF4C484014641BCC1193EB72FD1EBF0C23A6455EBB2FD413B1AEE34A8BB75FDEA5514E5E7A3203717795919C8494F43D6B1549C4C3BC0958AACA3A9C84E3FCCD732713E379BC1E6E3C6D5EBEAEFD6D7D5A3F5412B8CDD460C0F0EC3EBF4827F6B79D441FFA10F08B8036B999966E95436AB0DD6412B068C03E8EFE9476F672FBA3BBAD1D5DE05439B015D6D5DEAF32E4397FA9AB1C78841E3202C8316D8AD7638ED4E09BA9941A732E3DFFEB7F4DF04C249FD6CC81F52A8138501280C4471581D8ADD6C57189CE2717B3E91E576BA973B6C8ED79839F535798F7BD8AD4869529C4AC81752E4B3FE4F77FC4FF9C3FF17C29943E6C9DD3D940000000049454E44AE426082</ImageData>
      </Image>
      <Image ID="Idera.SQLInst.80x80Image" Accessibility="Public" Category="DiagramIcon">
        <ImageData>89504E470D0A1A0A0000000D49484452000000500000005008060000008E11F2AD0000000467414D410000B18F0BFC6105000000097048597300000EC100000EC101B8916BED0000001A74455874536F667477617265005061696E742E4E45542076332E352E313030F472A10000231049444154785EED7C097094E7952DBB314ED5D89EC936AFDEBC712626713276BC24F6C413DB89CB711C3B8E17BCE1150C181B3018303B6231FB8ED9C32E76B38A550249200402A10D09A11509B4B7D452AB37F5A2EE569F77EEF7FF7F774BC8EF2535A1935499AAAFFED6D6A24F9F7BEF39F7DE5F5DBA7CF3EF1B04BE41E01B04FE3204023E17FCEE26781D35703597A3A5B1104E531E6CB5D9B054A7C35299064B452A2C375261BE71467B5CC1CF55F26BD599B0F27BED0D8568B194C16DAB41ABAB096DAD2EFC65FF8B7F90EF0EFABCF0394D04A908B69A0C34961E43EDE5ADA84A5F8EF29499283CF939AE1E1D82BCFDEF226BF79BB8B8FD459CDBF20C2E6C7E1AE7D63F8DB3EB9FC0B98D4F216DD3EF90BAF9799C8F7D151777BF838CFD1F21EFE867B872723A8ACE2E4545FA66980A8E13F00B70D417C16B33A1CDEFFDC704D5EFB5C3DD548C66B2A736773BAE9F9F8792E449284C188EC2631FA0F0F807284D1C86EB2963703D75322A2ECC20A0B351756911AA3297E0FAA525A8E4B53CF34B54F271B97C2CD70B0B50CEE72A4B9D81929449284E2480C73F46F6A10F9029E0EFEC8F4B7B0723F7F058E4277C81B2F42D6828390D6B7D017C6EFBDF3F987E472D9A6E24A1267335CA9227A0E4E470149FFC0837CE8E81297B1E1A0BD7C35A71800C4982BB390D3E471602EE02045BAF01FE329E4AA0CDA49FEAF0D52F9FABE2D7AFABEF0BBA2F23E0380B9FE5303CF5BBE1ACDA0AEBB53568C85F8CEAF499284B1AAD40BDB8F31DA4EFFE1017F78F425EE262988AF87B9B2AFEFE8074DB2A5468162711B4F8A1283A351435E931B0946C80CB74123EEB25B4B9F381D61B40A01E081AA791C0F0C8C7204841F9D8AC3D1620833C01795CC76B05C12B027C9701CF79C095C4130FB41C079C728E018E43686BDE0F9F692741DD0273D16ADC489FC5501F86B3DBDEC1D9ADEFE2C2AE9128CF3904B7E5EF00485602D8ABCEA194C0E51F1B88F2A421682E588E96FA44F81D57D0E6E38B0EF2C50B3068E0B599579EA0453BEAB17C8E5F837C0FC10B36F12A00CB554014F04A095E2EE03D47F04EF32410BC933C044E8E025007D17998401E5180B6D98FC26F39048F691F1A8BD6E346DA6C9CD9FA264EADEF8FF37BC6A0AEE81CFC5EF7DF86918C05D4E56F45C1E1F771F5D87B6822703ECB29869784638DC61E058C0021AC92AB8064D58F7C6C7CCEF81E619CCE46B90AEB5AAF10B8549E14C02DAC3BC12BC16AE1D500CE4EC0EC87B423E0D9E3141BB58FC94CDB0904EDA710688E87A37C2FF2CFCC44C2BA7E38BEBA1F8A53B7C26D6F8A3E88E6BC6DC83FF83A8BC14770577F85A0E72A41237092AF8459A12380C9C79157034401341260015C9829209610B44B64DB059E640DBC1686ACFB5404E38475C236B24E40B31FE03948D078B5F10898361D44A700CEE77130F7DAD260CEDF8DE44DEFE2D0F2DFE30A41F4459389D61BC92838F41EAE250C82B796EFB0E4377F6D047802800152C7ABC13A014F0F5B0955C9752AE749AE937025E304B876E02576029E80C66395F315CF5E9E3D3CFB7876EB57F91AFF9F56015CDE90CB68F396A0F1DA619C58FD2A0E2C7B05D57949D1636155FA3264EE7C0E8EE28D0C2949EC521D99AB424C13D06C3CAE0E401A4C8C044FCF8F12E6811B7C9ECB7C81677824DF45328FE049C150E12BB94F9827AC13F61920EED7C1131005BC9DFA1130F9350967A7E450FE0E7F05A54D15C3F94BEC9AF1042EC6CD891E80A5CC2199B14FC359CDF0F0517E78F562A172DED7314F42D30859034032B54D0ED91B9037223DCC3C15AE029A718D28162ACF31540DE0EC0298B04F67A085E035133C0B8F5C9B742025AC9D9247331480AC30A82F49C4A6C93F47F29EC9D103B03C653AD2B7FD06F65ABE382FD9E7A36693DCA72AA700286019400AEBF48A1BCA8B526DA5B04865962A5BCCE7B8C8E712E6B16048A50D81A7E73CD7513D7CC93827DF38C53CB24A8E4D0EC16B160075F0847D025E8885FCBCE446272BB88729420064DA6828DA87D829BF40F2AEF1D103F0DA99185CDCFA6BD86BC88AD6721E096182A8F2586451101005408371C65580137D273FC3FCE94B237867758922798FA0B944AAF01AD2790C575530043C3D64ED0C4D01CE609F00D8BC8BEF9780A85F251FDA84A1FC399BBC09F27B58D945BCB764C294310D1B273D82E49D5104B02C651A2E6E1106B2B2290045BA10440144B906014AB45C0470F258581714F0E4D075F859B95B0DE6E9004A95F5F07945E7894C09E93C619E84ADE43D611EC153ECD399D72C394F8A4704A092F7AC469E9414C037C7C522E2CAE1CFF171ED329852DEC59F263084B74713C0D30470B300C8775459301D4065B5C472E94E42D9321D487118EA63822739CF4FE679C93C5530F46AAB98270259008C14C8029E846C2480649584AEAAB646C51510E573C2380199E049F5159DA834A3C818E6C046027D630E828583507DE279AC1BF7104E4513C06BA719C29B19C2370820E500023C6D029E1ECA0A449E803052729C140939A213F9F9D63CE638324E096382E696709523C0F12A2FD621A0C98B96D0959035749E91F70424014E808C0C65F99C2E6B4403DA05403E8FE44C337362F562A07C12DAF207C292F024B257FD086BC63E8484680258727A3ADB4D4FC07E5D6C13F3898B49D9C342D0A60B696199B811C5340228F95180F351A678B2997BC8047112CA4DC8D5609B80262F589C842E53043C258AF5AB0066278354E515C631D7858E11BE112036F1EBE62D400D81BB3E0D281E81B68BAFA0F1E043C85F7E379267FE13D60980B1510CE192A4A9B8B0E929D8CBF822AD04CF42C760A66EB34A7EA16F15E685BCAE437B2CE1DB4AA9D2C20A6B2340C28E9B8E80A4879FE436014E0A8284A32A0C3C16022205429D6DFC3856BBAAC7FC9C028C8F4DD4A8D5AB81CA4504EE0B1A9BCFD07AE925384E3C881B1BEF44F1F2DB9033AB2BCE4CEB83D563EE47C2D66802787A062E6CF815ECE5648C8D0036915526E6B27ACA9A0632A899DD12B6A954C8C2C9E3E7F110483781B4F34356EA5632D253C8EFCB22A8CC850EB2D246265A9916ACCC7506ABD85D51A02849226C931C2780CAE1F7B159804632CE4C56D6F37B6AB70275EBC8B8650CD59940DE00B49E7D9684BE07E6DD77A162534F94ADEA8582855D913DA71712A7DD81559F3D8884CD5104303F690ACEAF2703AFC98B150029804DA7E1AD2600A663F0D6F34535114C0B85B03D930031E749988BE856EE24C8D3C613E04382AB8E4F3BFE167E89ACF5B36AFB5878DC64331D03DC64B69B0C76F2F91C64BC956F92856C6EE41BD640469BC8CE8A1540D118F8325E8127E95134C57D170D5FF546FD8E1E246C6F98B67445DDFA2E285AD11557177741FA175D9112D307AB3EFDCFE802589C340329EB7F05ABE440C5404A1102183409800779E58BAA6707A49145C29C40226E21E1165026AE85DF4C16D9C55DF0677CCC9F6D52C5AB10949E9FBF9E57566D9F894D5661691D825E02D8928FA033971233854AE81082D59B112C5F8460D1383ABFF7E149FB2D75F703701FBE1B8EFD3D58577A323D762368BDD0B0BD1B0D492FD46FEB0AD3B6DB70637D5794AFBE2DC4C05364E04A32303E9A0CBCCA1C784E3150CF813A80AD35649EE9285A4D7C91E6E3686D3C8E40DD0E78CA66C153310FBEBA1524D646042C3B1060180694336018B250F86C7BD046D7E06B2238F5ABD15A338F4DE8D994989FA3AD6818BCF9EFC093F3063C19CFC195F6249C677E8696C4BEAC41FFC6BAF36DD88EDCC5947A0795CD6D5429DD990EBBC0BCBDAB024F40346DEBA21858BBBE97626001192839F03419B8840C3CB2695CF49C4851E2749C59F704AC65ED19D856270C64579820A25EC0DB0FCF3582776D2A5A2B16B061B38A0CDCC01E2A739554518217A4BE0BAA5E9E88E25D68238020806D754BF833B3A98E26C25B3C0C81820F08E0ABF05C7A0EEEB4A7E04E79842AE83E3AB37B08E2776952FE994F77079FA63BB53459B89B20EEEC09F3AEAEB4C23DC9C06EA88DED85EB0CE16BAB7A6A0C9CDD1389317760F9F0077064C398E801987F2A06C9EB9EE41CC2A8C20CC7FAD3F089B5331D6104C691450709DC2278AE8E81A77432BC95F335001B36B1B1B9439726871120806DCA618804D9C5FAB2993DD5D5F0D52E01C8405FD938784A86A1F5EABB04F07578D20D063E0C57E24FE08CFF3F948BDF86F3E85D948CC24002B8A71B9FAA271A777427785D61DE210CEC89CA2DDD1580C52BBBA160511764CFEA86A4A97DB0781819B8E1F32802480626AFFD6F8D8152449A350003B50494E00578FC15EBD072F553780A4612C829681500EB5693819B39B7D8C9627C80EC23F31C5AF7B8CDB10F4132304000FD043050B790126436FCE513283187D1F531D7E5F45321EC6608BB521E22037F4C00C9C0E3DF83FD28F31F43D8BEAF272C6460F36E615E0F34EEE2E1D5B483211CDB0395EBBBA374550F02280CEC815353EFC0C24FEE278063A308E0C969485EFD3819A80368616524807E05E0616AE89D705F9D0867EE4082A801A81858B792006ED401DC47E6894016100F321FEE45900C14002507FA6B19F2953308E078C540DFD5F7340666BCA0006C2180AEA41F85013C72279D5E1F02D80B4D04B091000A031B5981E52800B7F640D5FA1E285D6900D85D01387FE8FD885B1F450073E3A72169551840BF85FD35052043B82E0EBE920570670F248003E024802DD7F41016001B04C01D64A00048B6D2B2B50980CC8902A08470D02C002E41A072267C210007EA21FC02ABEE93B4D00CE1242384BFC31C78271B357D42216C11E6F1D4AB10D680346DED8E6A8670C9CAEE7A087747A200F811015C174500F312A62361D57FA35967609B11C22C22BECA6D746B83E1C87A83D2EF43EAE9917049110985F016554482045042B88D004A1111402584A588F81A248497F0B96623503E510BE1820F09E09BAA887858443CAA880880FFCE109622723701348A08F3A01411E6C1FA1DC2C41EACC8DD19C2CC83ED8A084378CA1D5830E4011C5A17C52272393E06A7569081A57A0887644C1C73DE4CD82FBC8496ACFE70E4B2724A1E2C9DC4109E47560903594444C6B0EA062484A58090817E161161A0C818292221196314917C2922043024631ED4423881328645E4661923C07553155881A7644C37D46CEC85E2152C224AC67443E2E43E983BE8A738B0EEB3E8E5C02B2766206185CE4011D2CDB4720CE160F51ED82FF5878B66DD9EF53ADCB983B422521643068A905EC31C480652EF05256415805A8739E81019B39BECD4644CB06E912E632629067A948C9122F222077594316785812C2222638E7D97568D328655D84E21DD6C086982D74E4853C654ACEF1661E57A229E0C9C3DF8011C58134500738E4DC5F12F7FC9CD038381BA952BFC02D6732FC076FE0F7065F6833D9B955331906128425A31702347113BC8B8034AC2F899075531A19096F67BABE4C04661E012BE21B3E1BD36963F4F00F3258429A42FFE9E42FA09384E3F4421FDD39090B632075A09A055C998AE4AC698950BE94210BBD24ADFA60BE9F6562E890C9C3DF0275106F0C4141C5F46002507EA56CE5B4DDD97F511017C9E2ECD60E060326794C6400AE940AD58399A7D9953485B5EF5FAF436BD02910CD48574D0B498DE7A3682D75980E844DA0AA58868212C0CF490819E9090FE1E59F82F8A810E015067A035D2CA11C48E562E8BCD84F8C9DFC2EC0164E0CAA83290002E2580C5E11CE8E5728F2DED8F0A40BB62607FC540B79E033DCC81BE5A5A39C5C09D3A036FB6728A817A0E0C56CF220369E54A3F0959396F86C1C0CEAD9C9556CEDC99952313352B775BD8CAB1999038A90FA6BD7F1FF6AF8E2280D9477500A588908141732ABC7931CC7DAFB249F2BCCA81B6CC37D07279101C2A074A152603EB742BC7D945500969B1724754150EEA56CEC8819A959B462BC702A4ACDC4078990303972273A06EE598039D71375BB966B170649E1412C985869533DA5939737A424278C607F7617734199871640A8E2C0EE7405FF501B8B286C271FE45F654C9C0345E33DF8223DBA8C20C43E6C0482B1760B354248C61E54255D8A231D0C71C2856AE3554850D1D482B7781CD84B31DAC1C9B0922633A5A3993E440BD1A77B47252854F928131EF11C01551646016197870D12FD12845841538706D039C1983D072E16558D39E575747E69B705D66E237AC5C857861B1725B29A4A9F70860505C88CA83612B07BD0A1B562E402BE7533A30D2CA3D452BF7707B2B471DA8ACDCFEB095B3D0C29977891FEEA95B39D181EDAD5CC2A4DB31FD9D1F61F7F22802987998002E248092031BCFC15BB8002D191FC199F6920250AE4E02E8CC31AC9C305000142B275E783701A41351ED2CDDCAE94E0464A0C818CDCA89171E0F7F2756CE492BE78CB4724769E5E2C48968564E79E1AFB1729A13A1179ED51DF10470CADB7DA30C60DC441C5CF05F1A805C2E6AC99F46060ED100641189043064E542006A5E584DD2C84009E12085B43624A217D64358AC9C01A0E685F510A617162BE726039D91568E003A1580D2CE623766770F02283E58F3C4263EAEA217966E8C007895006610C0130CE1896F3384A3C9C0F4B84938309F00161E60D765275CF931ECB20FD0429800AA10BEA485B066E5D88D0985B0D68DD1266DD2CA22808A85329AD4AD9CEAC630072A2BA7776358448C6ECCD7593969A82A1DF89558B91E11FD40692674470DAD9C0028DD18013093DD981313FB60C25BF761C7B2288670DAA109D837F73198AEC4B2D3B20E9EBC49DCD7F9502B2204D0C122D292D14911912ADCA8F503B52222CCEBDCCAF96AE67728221DFB81B47289D28DD1FA8162E5AC0A40A3231D61E584814AC6D0CAADEF19EA074A11899FD81BE3DEB817DB964611C08B072763CFDC5FA221F74FF096AEA24B984A933F84D5F11505A0B27294316ECA18CDCAE93246AC5C63072BA706E88695DB15B2726D1156CEE84847CA98160A6947A4950BC918E6BFAFF49988EE83D54C4484742756EEF8C4DB31E1CD1F4717C0F3FBC763E7ACC75093318FBDBAE5B0E74D843B7388B2706121AD59391785B483CD044D486BCD04B172DABE5ED8CAF9382C97994858481B56EE7378D44C44B37222A43DB4729E0E56CE6826B4B372BB68E5381B112B6722884A486FA2955B1D9ECA254CE88DCFFBFD30BA00A61F9C82DDB37E8E864B740A25CBC8C018D8D2E93A444887ACDC6B6C264458B9D054EECFB5724B58B923ADDC0002C871656756EE18AD5CDCBF709CACE7C0BFC0CA1D9DD007635FBB0FDB164531841503BF78143517A6B353B294EB7613DA31506B26445A39A3996058393613B8BF1288D86936A6729D371322AC5CA899D0DECA859B099A956BD29967D9C6A91C074A5A0EBCD9CAC58FEF8D91AF9081D104F0C2BEC9D835EDE7A8BF4806162FE38AF454B6B1DAE7405BE6EBACC29A9573879A0986958B9CCAE9CD84503B8BE15DBF86ED2C632AA759B9B6FF9795EB3895DB4B01CD86AA9AC6458E36550EEC126A6789954B98703BC6F4EB4B004744AF1F7866CF04C4C63C8A5ADE77E121800EE64057E6203611B42AAC5939365469E5A499E09486AAB272E186AA2163FC329553D5589BCA197361B1726A2EDC9995537361C3CA690D55673B2BA7B5B394FE53ED2C6DB8AE55614EE5221AAAC775066E5D382A7A009EDD33095B631E46DDC5198A819E2B536ED6817A4B5FB372321736AC9CDED28FB4721D5AFADA5C7861A8A5DFCECAE973E14EAD9CCC853995D3E6C23254271365B4B983564E3AD2AAA5DF3D622EDC03C7C6DF8E512FF5C5C6F99F460FC0943D13113BF561D432077A25075E9944DD3784FA4F6B673979755207CA50499BCA4558393554D2BC70C8CAB12BD36EA8A45BB90085B40C95DA59B9747D2A7726722AF77D35D6B413401BA772D63D049003F576533901500D957AB61B2A1D27809FFEF15E0238328A00EE9EC8CDF6875193A6E5C0962B936FB272B60CCD0B6B568E63CD76568EFB31CA89E8564ECD45742B171A6B7EBD95D3C69A1DA67204506BE9879D48472B57AD5BB9C8B1A6307064B4014CDE35898BD9646008402384752FCCA1928DCD84969CBFDCCA0542DD186D2A171EAC87AD9C36588F9CCAC958B3E3548E5E580DD6C944355827FB22AC9C31583F3AEE760CFF0319382F8A219CBC6302364E7C18D569D3B41036AC9C1EC212CA2DEC073A73A8DD248465B5433130BCDA11B6725A37C6E807FA8D7E60ED7C04F4D58EC0D7AD76483341864AC7BFAFAC9C5DF5037B71B9883E5885B03E9533AC9C1EC291AB1DC7C6F5C6F017FE83000E8F5E0827EF9C8C8D131E415DDA4CAD8874B472AA1FC8B9B061E5D45C98ED29A323ADE6C2FA54AE83950B2F171953B98968ED64B9A8850C74AA99C80F3858FA9E9ACA39D4729166E59AB9DEA62D1785E58C61E522978B8E08035F2003E74611C093DB27603D37DBABCE71F38A001A56CE90313691334AC674B4729A9096B970472BA7F69EDBADB76932C65B462BC7A99C61E53427C2CD84B3EDA772E1B970E4544E36B4342B2732A6823246BA3191EB6DC2C08F7EFF83E80228F754AC2580460E747762E56C3217BEAC59B9B090EE38959346823195D3E7C2D6CD6895B9B0A9A395931CF835564E67A0ACB785A772DDF5054B0D3C11D4755CB0140023172C0F8FEB838FFFD0176BA3C940D9685F35FA2154A4C64458B9C1A16682B272596FC39EDB712EDC9995D336F0DB593902E8AD991B311736AC1CC79A91562E890B96B299C09166D8CAF50E4DE51A68E72CFA68D3B072751DA672C73E27039FBD27BA0C4CDA360E6BC69081E7DB5B39F705AD99D07E3321722E2CFD402E58AAB9B0B160D98181C65C98564EE6C26A2A2773E10269268437135CAA9D75F382A5C14065E5643726C2CAD5C56A0C34A67232173EFCF9EDF8F83932704E147360C29631DC6CFF192A53B51CD899957375DC8D512BBEB472D250553950EB48FB794F48D8CA45AEF81A568E3950AAB0DA8D91F5362307EA3A50DF8DE9CCCA890B89B472957A0E142B274BE697B8E22B0C1CFCEC0FB0766614013CBE792C568E7C1035E78C2A2C3AF083F62DFD9BAC9CACF8CA6ECC56364DD9388D5CB08C9CCA85567C17B5B372A1155F59B0E466828B63CDD06E0C172C55150E4DE5F42ACCF53665E5D48AAF34546FB67247C8C0A1BFBB176B6690E59EB65B2B6502BE00DC2E370EAF1F85E59F3E4806EA568E3AD09315B6724A07666956AEBD0E946602B7AF7857A5B4B2D44E8CFABB06612B071D407F48078EE79D64910B965C1D5173E107C353B963D48187C33AB0893AB05974201BAA6A3B4B98D8C1CA5D512BBEDD71646C6F0CFAED3D581933141E9B8777B2DF4210DBDC6D68B1B6206ECD482C1921004A3361A9B27202A033AD9FE683E9449C14D22D3943D88DE9CCCAF19E0EDDCA6943257D43555FF10DCA7E60682AC7A11201F4ABA9DC6B6A4355648C9B0CD4A672DC0F3CF61DDE0AA77961FBBE082B470762EC079AB6F58061E54AB8A19AB78053B9D9DD71580770F994C1686E6C86A78520B6DE0210E5495B1DADB09AADD8BF6A04160FBF1F95BCF13A12C09674FA5F76A59D14D2CECC77DA03D86147BADD54CE60A0B1234D00FDFA542E6CE5F405CB881C185EB024803258FFFF01B89963CD759CCA7D6900D82304E0B2C983603699D1626BB9352CF4BBFDEAC91B6B1B7170ED68C5C0B253DC5F2E5C4C2B473993338C7990A05D7C138E8BFD18C25CEFCD1D120EE10E5BFAEDAC1C2773212B17DAD2D7A672B2A51F0E616D3B4B3513CE180B963295FB4E3B2B170A615AB97A6EE79B6319C25BBBA06A23B7F4D7B01FB8AC3BB2E7F14E2586F081CFBE8501CFFE10CBA77F0C5395090E8B033E97EFAF9F0B054047B30375357538B97715568E7912497F7A0BE68C29705FE1542EFB538E3607C29EF136AFDC89C91A0CD7954FF4D50EC3CAC96682DC27C23536E907AA25736D2A676CE97766E5A41FD8AE8870C557BA314E3595D3567CA588683311FAE0DD92F798FF18B6F5DB08DE16168F0D5D296164A4D9855B093D9133A72BCEC7DC869503EEC688571FC1CEB50B5175BD0ACD662D8CFFEA7FDBCDEBF2C26AB1A2AAAA0A991753B063E908BA91C7717A433F349E1F0E77CE708E3207B1334D1033DFE3C7DC93CE1BC1899A5831361D642A17BA53496E1CEC28633AB772AD62E5D4544E72A076A792DA4C60475A162C6DBC53C926772AC5712EBC9F00721E22DB08725F483D9B07A62D5D34F0D672B5775537142EED82CB73BBE1E2F4DBB06EC85D18FB4A5FCC193B00694949B85E7E5D01784B18E8F3FAE076B8D154DB84D2C21224C5EFC3D6B943B06AD42F10B7F819941F27F3B2C93882E896A5A2CB2C20F9BCC9A6984580B77A85567CF5B9B0B6602905A4732BD7566D58395D485FD1ADDCA567F917511E57ED2CC7290AE913F7907D943107C9C0BD77A8DBBC9AB6739D4DC0DBDC2B0C1E6FAE295C21F7C87541EA94DE58F6FE5D18FD625FCC18D91F0907F6A2F44A09EAABEBE1B2BA787F5EF0AFCF40A1B4DBE95645A4A6AC065772F390187F04B14B27F046954779D7F72338BEE269949FE88FE64B642273A23D9FEBBDBC21D0533A832BBE8B75066EE55CF8ABD082A54FE40CD9E8E3CE601BFF3C496BFD3ADE2AB68AEDAFB9F0DC984A17C215DF42BE3197B97B9DF13217D8B9DE96C2DBCC4EFD0CD6F8BEB470FF9BABBDB472FBEF247877B0EFD71B55BC23A976431754ACEDA2725EA1DC9DB9A42B92637A63C3E03B31FEA5FF85E17F7C044BA77E86F84371C8CECC42E5B54A58EA2DF0383CF0B7FA6F0D80BE561F9C36271A4D8D282F29475E661E921293B077F35AAC9CF621E60EFD39568D79147BE7FF0697B6BD8C8AE401B0658D86BB7026DCD7092085B44FEE1EB7D289C81049C4B4FE674B6443BFB5917B33CC91DE9AA5ECC4F03631B6C182A56471FE2770F1BE5F3B016C39FF5BD84F3FC6F07D807F0EA12F9AE308E0FEEFD1FFDEC93BFA796B2BBBCED5DCC4BFB69A37D3F0A6EAF4B97D1037FE4E2C1EF8CF98D2EF5E7CF2C20398F5D9006C5EBD0829A75290792913A5C5A5A8ADA985D3EA84DF738BC01306FAFD7EB4BA5BD52F926A2C20E667E7E37CCA799C3C7A129B562FC40A56B359239EC1DCE1BFC2D231BF44EC8CDFE0C4BA979115371465E7A7C27475012CE5AB60ABDE8096BA58B81AB6F3FEE26DF052607BEA37C253B3069EAA250CFB39AA11EBB93A82C5E843E6D5FEBC2F9B3397D3BF86E5E463683CFA00EA0EFE07AAF67C1F15DBBE8DD28D77E3CA9A7F42FAA26FE1C4F46F61C7E8BB08DA7730F5AD7FC7E87E3FC2E76F3F8EE9A3DEC3EA2FE7E368DC51A4A6A4223B3B1B65256530D59A34F05828FFEAC5A3B327F47BFD70D95D68AA6F424D650D4A0B4A919391A3FE53C78E1DC5DED88D58B3602A164D1E8C599FBE802F3E790A0B86FF06CB3E7B1A6BA73C83ED0B5EC1C135EF237EDB509CDD3F1A178E8E474EC224E4264F452EA5516EFC68E49EF8847F89F23DE4C6BD8BCC7D2F23E7ABDF2363C79348DFFC185257F26F1C2CFE290ECEBA173B27FD1B368EFE57ACF8F85F31EF837B10D3BF2FC6BF753F3EEFFF18267CF01C668E1A88A5732663FB86B57C93137026F90C32333251545084EA8A6A343734F36FB97A6F2DF3BEEE5DF1B83C70581DA8AFAB47CD8D1A14171523272707E9E7D291742A0987E30E63E7F6ED64E612AC9D37054BA60EC3FCB16FE28B612F60CAE0673071C09318FFEE7F615CFF5F60CCEB3FC3A8D7FE935B023FC6F097EEE39CE28718FEE23DEC16CBF587182A1F737631EC8F3FC188977F8A61AF3E844F5FFB0546BDF13846BFFD6B8C1FF83B4C1BF63AE68E1B8A2533D9AF5CBE10BB6363718C6C4B3C9988B4D434E465E5A1ACA80C1537F80723EB1A952CF3397D7F1BF00C502567789C1E951BE5DDACADAE456579258A0B8A919F938FCCF44C5C387741BDF327E34FE2485C1CF6EDDC811D9BD661CBEAA5D8B0740ED6CC9F8A15B3C752CC8EC092291F633E5DC1FC893CE3DFE791ABF6F102327A49CC082C9F39065FCE9D8C358B6662C38A85885DBF067BF99CC7E28EE054FC299C4E3C8DD4B3A9945B99C8CDC955A0499130D798954C917095373F2AE1FAE7FE12A95C7E970E26FF83D6062BCCB566D455D4A1B2AC5225EA82AB05C8BB9C872C56BD8C8B19C8389F81F4D4749C4B398733A7CFE06CE2599C493C83C4C4449C3E795A0343AE27B5AB00236F847C7FDAD9349C4F3D8FF40BE9C84ACF426E662E95C115F53B4A8A4A70BDEC3AAA2AAA505757A73CAED342D0F846CB1B2E4D913FF775FDCDBE4F12B2C89E167B0B9CCD04B48980369855B89BAA4DA8BA51858AF20A549455E07AE975941497A0ACB00C250525EA14E717E3EAD5ABEA2A3956AEC585C50A1C619424FFEBD70812DD434D450DEAAAEA505F5B8FC6FA4634999B94E817A6799D5EC536C9DB7F3330FE27BF58DE6D75BC0178DD7C31B4492AE41D4E386C0E95871C4D0ED89A6CB0982D2A0DC85531D86C5657E3F38DE646F57DF6463B6C169BFA597973DC36B77AB3C42D09C314CBF8FBFE2198F63F01F7EB7E56E492219B22AFB7E2777DF39CDF20F08F8DC0FF0546234791C6CFBA560000000049454E44AE426082</ImageData>
      </Image>
    </Images>
  </PresentationTypes>
  <Presentation>
    <ConsoleTasks>
      <ConsoleTask ID="Idera.SQLDM.DMservice.LaunchConsole" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.DMservice" RequireOutput="false" Category="MonitoringObject">
        <Application>%windir%\system32\windowspowershell\v1.0\powershell.exe</Application>
        <Parameters>
          <Parameter>-WindowStyle Hidden -NonInteractive -Command "Start-Process ('"{0}SQLdmDesktopClient.exe"' -f (Get-ItemProperty HKLM:\SOFTWARE\Idera\SQLdm).Path)"</Parameter>
        </Parameters>
        <WorkingDirectory />
      </ConsoleTask>
      <ConsoleTask ID="Idera.SQLDM.SqlInstance.LaunchConsoleTask" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.SqlInstance" RequireOutput="false" Category="MonitoringObject">
        <Application>%windir%\system32\windowspowershell\v1.0\powershell.exe</Application>
        <Parameters>
          <Parameter>-WindowStyle Hidden -NonInteractive -Command "Start-Process ('"{0}SQLdmDesktopClient.exe"' -f (Get-ItemProperty HKLM:\SOFTWARE\Idera\SQLdm).Path)"</Parameter>
        </Parameters>
        <WorkingDirectory />
      </ConsoleTask>
    </ConsoleTasks>
    <Views>
      <View ID="Idera.SQLDM.Dashboard" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.DMservice" TypeID="SC!Microsoft.SystemCenter.DashboardViewType" Visible="true">
        <Category>Status</Category>
        <PanelConfiguration Columns="1" Rows="4">
          <Cell Row="1" Column="1" ViewID="Idera.SQLDM.DMservice.StateView" />
          <Cell Row="2" Column="1" ViewID="Idera.SQLDM.SqlInstance.Health" />
          <Cell Row="3" Column="1" ViewID="Idera.SQLDM.DMservice.EventView" />
          <Cell Row="4" Column="1" ViewID="Idera.SQLDM.DMservice.Alerts" />
        </PanelConfiguration>
      </View>
      <View ID="Idera.SQLDM.DMservice.Alerts" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.SqlInstance" TypeID="SC!Microsoft.SystemCenter.AlertViewType" Visible="true">
        <Category>Alert</Category>
        <Criteria>
          <ResolutionState>
            <State>0</State>
          </ResolutionState>
        </Criteria>
        <Presentation>
          <ColumnInfo Index="0" SortIndex="0" Width="22" Grouped="true" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Severity</Name>
            <Id>Severity</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" SortIndex="-1" Width="54" Grouped="false" Sorted="false" IsSortable="false" Visible="true" SortOrder="Ascending">
            <Name>Icon</Name>
            <Id>Icon</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Path</Name>
            <Id>MonitoringObjectPath</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Source</Name>
            <Id>MonitoringObjectDisplayName</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" SortIndex="-1" Width="22" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Maintenance Mode</Name>
            <Id>MonitoringObjectInMaintenanceMode</Id>
          </ColumnInfo>
          <ColumnInfo Index="5" SortIndex="-1" Width="250" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Name</Name>
            <Id>Name</Id>
          </ColumnInfo>
          <ColumnInfo Index="6" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Resolution State</Name>
            <Id>ResolutionState</Id>
          </ColumnInfo>
		  
          <ColumnInfo Index="7" SortIndex="-1" Width="150" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Created</Name>
            <Id>TimeRaised</Id>
          </ColumnInfo>
          <ColumnInfo Index="8" SortIndex="1" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="false" SortOrder="Descending">
            <Name>Age</Name>
            <Id>Age</Id>
          </ColumnInfo>
          <ColumnInfo Index="9" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Type</Name>
            <Id>Category</Id>
          </ColumnInfo>
          <ColumnInfo Index="10" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Owner</Name>
            <Id>Owner</Id>
          </ColumnInfo>
          <ColumnInfo Index="11" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Priority</Name>
            <Id>Priority</Id>
          </ColumnInfo>
          <ColumnInfo Index="12" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Latency</Name>
            <Id>Latency</Id>
          </ColumnInfo>
          <ColumnInfo Index="13" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Description</Name>
            <Id>Description</Id>
          </ColumnInfo>
          <ColumnInfo Index="14" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Connector</Name>
            <Id>ConnectorId</Id>
          </ColumnInfo>
          <ColumnInfo Index="15" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Forwarding Status</Name>
            <Id>ConnectorStatus</Id>
          </ColumnInfo>
          <ColumnInfo Index="16" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Class</Name>
            <Id>Class</Id>
          </ColumnInfo>
          <ColumnInfo Index="17" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Time in State</Name>
            <Id>TimeInState</Id>
          </ColumnInfo>
          <ColumnInfo Index="18" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 1</Name>
            <Id>CustomField1</Id>
          </ColumnInfo>
          <ColumnInfo Index="19" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 2</Name>
            <Id>CustomField2</Id>
          </ColumnInfo>
          <ColumnInfo Index="20" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 3</Name>
            <Id>CustomField3</Id>
          </ColumnInfo>
          <ColumnInfo Index="21" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 4</Name>
            <Id>CustomField4</Id>
          </ColumnInfo>
          <ColumnInfo Index="22" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 5</Name>
            <Id>CustomField5</Id>
          </ColumnInfo>
          <ColumnInfo Index="23" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 6</Name>
            <Id>CustomField6</Id>
          </ColumnInfo>
          <ColumnInfo Index="24" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 7</Name>
            <Id>CustomField7</Id>
          </ColumnInfo>
          <ColumnInfo Index="25" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 8</Name>
            <Id>CustomField8</Id>
          </ColumnInfo>
          <ColumnInfo Index="26" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 9</Name>
            <Id>CustomField9</Id>
          </ColumnInfo>
          <ColumnInfo Index="27" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Custom Field 10</Name>
            <Id>CustomField10</Id>
          </ColumnInfo>
          <ColumnInfo Index="28" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Resolved By</Name>
            <Id>ResolvedBy</Id>
          </ColumnInfo>
          <ColumnInfo Index="29" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Time Resolved</Name>
            <Id>TimeResolved</Id>
          </ColumnInfo>
          <ColumnInfo Index="30" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Last State Change</Name>
            <Id>TimeResolutionStateLastModified</Id>
          </ColumnInfo>
          <ColumnInfo Index="31" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Last Modified</Name>
            <Id>LastModified</Id>
          </ColumnInfo>
          <ColumnInfo Index="32" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Last Modified By</Name>
            <Id>LastModifiedBy</Id>
          </ColumnInfo>
          <ColumnInfo Index="33" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Management Group</Name>
            <Id>ManagementGroup</Id>
          </ColumnInfo>
          <ColumnInfo Index="34" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Site</Name>
            <Id>SiteName</Id>
          </ColumnInfo>
          <ColumnInfo Index="35" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Repeat Count</Name>
            <Id>RepeatCount</Id>
          </ColumnInfo>
          <ColumnInfo Index="36" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Ticket ID</Name>
            <Id>TicketId</Id>
          </ColumnInfo>
        </Presentation>
      </View>
      <View ID="Idera.SQLDM.DMservice.EventView" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.DMservice" TypeID="SC!Microsoft.SystemCenter.EventViewType" Visible="true">
        <Category>Custom</Category>
        <Criteria>
          <TimeGenerated>
            <WithinLast Unit="Hour">24</WithinLast>
          </TimeGenerated>
        </Criteria>
        <Presentation>
          <ColumnInfo Index="0" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Level</Name>
            <Id>LevelId</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" SortIndex="0" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Descending">
            <Name>Date and Time</Name>
            <Id>TimeGenerated</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Name</Name>
            <Id>MonitoringObjectDisplayName</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Source</Name>
            <Id>PublisherName</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>User</Name>
            <Id>User</Id>
          </ColumnInfo>
          <ColumnInfo Index="5" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Event Number</Name>
            <Id>Number</Id>
          </ColumnInfo>
          <ColumnInfo Index="6" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Log Name</Name>
            <Id>Channel</Id>
          </ColumnInfo>
          <ColumnInfo Index="7" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Logging Computer</Name>
            <Id>LoggingComputer</Id>
          </ColumnInfo>
          <ColumnInfo Index="8" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Rule Name</Name>
            <Id>MonitoringRuleDisplayName</Id>
          </ColumnInfo>
        </Presentation>
      </View>
      <View ID="Idera.SQLDM.DMservice.StateView" Accessibility="Internal" Enabled="true" Target="Idera.SQLDM.DMservice" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Custom</Category>
        <Criteria />
      </View>
      <View ID="Idera.SQLDM.SqlInstance.Health" Accessibility="Public" Enabled="true" Target="Idera.SQLDM.SqlInstance" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>AvailabilityHealth</Category>
        <Criteria>
          <InMaintenanceMode>false</InMaintenanceMode>
        </Criteria>
        <Presentation>
          <ColumnInfo Index="0" SortIndex="0" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Descending">
            <Name>State</Name>
            <Id>Idera.SQLDM.SqlInstance</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Maintenance Mode</Name>
            <Id>InMaintenanceMode</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Name</Name>
            <Id>Name</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Path</Name>
            <Id>Path</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Instance Name</Name>
            <Id>InstanceName</Id>
          </ColumnInfo>
          <ColumnInfo Index="5" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Real Server Name</Name>
            <Id>RealServerName</Id>
          </ColumnInfo>
          <ColumnInfo Index="6" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Server Version</Name>
            <Id>ServerVersion</Id>
          </ColumnInfo>
          <ColumnInfo Index="7" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Server Edition</Name>
            <Id>ServerEdition</Id>
          </ColumnInfo>
          <ColumnInfo Index="8" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="false" Visible="true" SortOrder="Ascending">
            <Name>MaintenanceModeEnabled</Name>
            <Id>MaintenanceModeEnabled</Id>
          </ColumnInfo>
          <ColumnInfo Index="9" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="false" SortOrder="Ascending">
            <Name>Display Name</Name>
            <Id>DisplayName</Id>
          </ColumnInfo>
        </Presentation>
      </View>
    </Views>
    <Folders>
      <Folder ID="Idera.SQLDM.DMservice.ViewFolder" Accessibility="Internal" ParentFolder="SC!Microsoft.SystemCenter.Monitoring.ViewFolder.Root" />
    </Folders>
    <FolderItems>
      <FolderItem ElementID="Idera.SQLDM.Dashboard" Folder="Idera.SQLDM.DMservice.ViewFolder" />
      <FolderItem ElementID="Idera.SQLDM.DMservice.Alerts" Folder="Idera.SQLDM.DMservice.ViewFolder" />
      <FolderItem ElementID="Idera.SQLDM.DMservice.EventView" Folder="Idera.SQLDM.DMservice.ViewFolder" />
      <FolderItem ElementID="Idera.SQLDM.DMservice.StateView" Folder="Idera.SQLDM.DMservice.ViewFolder" />
      <FolderItem ElementID="Idera.SQLDM.SqlInstance.Health" Folder="Idera.SQLDM.DMservice.ViewFolder" />
    </FolderItems>
    <ImageReferences>
      <ImageReference ElementID="Idera.SQLDM.DMservice" ImageID="Idera.SQLDM.16x16Image" />
      <ImageReference ElementID="Idera.SQLDM.DMservice" ImageID="Idera.SQLDM.80x80Image" />
      <ImageReference ElementID="Idera.SQLDM.SqlInstance" ImageID="Idera.SQLInst.16x16Image" />
      <ImageReference ElementID="Idera.SQLDM.SqlInstance" ImageID="Idera.SQLInst.80x80Image" />
    </ImageReferences>
    <StringResources>
      <StringResource ID="Idera.SQLDM.DMservice.CollSvcMonitor_AlertMessageResourceID" />
      <StringResource ID="Idera.SQLDM.DMservice.MgmtSvcMonitor_AlertMessageResourceID" />
      <StringResource ID="Idera.SQLDM.DMservice.PredSvcMonitor_AlertMessageResourceID" />
      <StringResource ID="Idera.SQLDM.Monitor.InstanceAlertCounts_AlertMessageResourceID" />
      <StringResource ID="Idera.SQLDM.MonitorCpuState_AlertMessageResourceID" />
      <StringResource ID="Idera.SQLDM.DataSource.SqlInst.AlertData.MapToAlert_AlertMessageResourceID" />
    </StringResources>
  </Presentation>
  <LanguagePacks>
    <LanguagePack ID="ENU" IsDefault="true">
      <DisplayStrings>
        <DisplayString ElementID="Idera.SQLDM">
          <Name>Idera SQL Diagnostic Manager</Name>
          <Description>The function of Idera SQL Diagnostic Manager is to provide database administrators with deep insights into the availability and performance of SQL Servers.  The Management Pack ensures that detailed information about SQL Server performance tracked by Diagnostic Manager is integrated into Operations Manager and its application health models.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.Dashboard">
          <Name>Dashboard</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DataSource.SqlInst.AlertCounts">
          <Name>Idera SQL DM DataSource SqlInst AlertCounts</Name>
          <Description>This module uses a schedule, PowerShell script and filter to spit out a property bag with the latest alert counts and details for a specified SQL Instance being monitored by SQL DM</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DataSource.SqlInst.AlertData">
          <Name>SQLDM DataSource to Filter AlertData by SqlInst</Name>
          <Description>This module takes the SQLDM Alert Poller property bags as input, then filters them by Sql Instance Name allowing the Alerts to be converted into events linked to the corresponding SQL instance object.  This approach also allows cookdown (the script will execute once and the property bags produced then shared across all instances)</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DataSource.SqlInst.AlertData.MapToEvent">
          <Name>Idera SQLDM DataSource Maps SqlInstance Alerts To Events</Name>
          <Description>This module maps incoming SQL DM Alerts to Operations Manager event objects.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMalert.MapToEvent.DataSource">
          <Name>Idera SQLDM DMalert MapToEvent DataSource</Name>
          <Description>This module uses the module which polls the DM database for alerts to get the new alerts since the last poll, and maps those into generic OM event objects.  This basically emulates a received Windows Event for each DM Alert found.

This module implements the mapping of DM Alert fields to Event fields</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice">
          <Name>SQL DM Service</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice" SubElementID="DmPath">
          <Name>DmPath</Name>
          <Description>Install path for SQL DM on this machine</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice" SubElementID="Version">
          <Name>DmVersion</Name>
          <Description>The installed version of SQL Diagnostic Manager</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.Alerts">
          <Name>SQL Instance Alerts</Name>
          <Description>This view shows all alerts raised when a monitored SQL Instance has an active alert present in SQL Diagnostic Manager.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.CollSvcMonitor">
          <Name>SQL DM Collection Service Monitor</Name>
          <Description>Checks the health (running state) of the SQLdmCollectionService</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.CollSvcMonitor" SubElementID="NotRunning">
          <Name>NotRunning</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.CollSvcMonitor" SubElementID="Running">
          <Name>Running</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.CollSvcMonitor_AlertMessageResourceID">
          <Name>SQL DM Collection Service Not Running</Name>
          <Description>Please see the alert context for details.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.Discovery">
          <Name>SQL DM Discovery</Name>
          <Description>This object discovers SQL DM installations by examining the registry of all managed Windows computers.  When an instance is discovered, configuration data from the SQL DM registry area is gathered as properties of the discovered objects.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.EventView">
          <Name>SQL Instance Events</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.LaunchConsole">
          <Name>Launch SQL DM Console</Name>
          <Description>This task will launch the local copy of the SQL DM console, which will connect to the most recently used SQL DM Server.  Once launched, the console may be connected to an alternate SQL DM Server using the File menu option.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.MgmtSvcMonitor">
          <Name>SQL DM Management Service Monitor</Name>
          <Description>Checks the health (running state) of the SQLdmManagementService</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.MgmtSvcMonitor" SubElementID="NotRunning">
          <Name>NotRunning</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.MgmtSvcMonitor" SubElementID="Running">
          <Name>Running</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.MgmtSvcMonitor_AlertMessageResourceID">
          <Name>SQL DM Management Service Not Running</Name>
          <Description>The SQL Diagnostic Manager service, SQLdmManagementService$Default, is not running.  This prevents SQL DM from reporting and updating current status.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.PredSvcMonitor">
          <Name>SQL DM Predictive Service Monitor</Name>
          <Description>Checks the health (running state) of the SQLdmPredictiveAnalyticsService</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.PredSvcMonitor" SubElementID="NotRunning">
          <Name>NotRunning</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.PredSvcMonitor" SubElementID="Running">
          <Name>Running</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.PredSvcMonitor_AlertMessageResourceID">
          <Name>SQL DM Predictive Service Not Running</Name>
          <Description>Please see the alert context for details.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.StateView">
          <Name>SQL DM Server Health</Name>
          <Description>This node provides a view showing the health of all the SQL Diagnostic Manager server installations.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.DMservice.ViewFolder">
          <Name>Idera SQL Diagnostic Manager</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.Monitor.InstanceAlertCounts">
          <Name>Idera SQL DM Monitor InstanceAlertCounts</Name>
          <Description>Checks the current health of the SQL DM managed instance by examining the current active alert counts in the SQL DM DB</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.Monitor.InstanceAlertCounts" SubElementID="UIGeneratedOpStateId1e5924d096484f5e963cc9c234fadc68">
          <Name>WarningState</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.Monitor.InstanceAlertCounts" SubElementID="UIGeneratedOpStateIde02721981c7244999d2daeae90698cfe">
          <Name>CriticalState</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.Monitor.InstanceAlertCounts" SubElementID="UIGeneratedOpStateIde880de805d234e169b1887758bc6feac">
          <Name>NormalState</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.Monitor.InstanceAlertCounts_AlertMessageResourceID">
          <Name>Active Alerts on this SQL Instance</Name>
          <Description>SQL Diagnostic Monitor is reporting active alerts for the status of this SQL Instance.  Descriptions of the current alerts are listed in the Alert Details..</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.MonitorCpuState_AlertMessageResourceID">
          <Name>SQL DM CPU State</Name>
          <Description>Event Description: {0}</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.MonitorType.InstanceAlertCounts">
          <Name>Idera SQL DM MonitorType Instance Alert Counts</Name>
          <Description>This MonitorType examines the alerts counts for a specified SQL Instance and generates the current health state (Critical, Warn or Normal)</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqldmHostsSqlInstance">
          <Name>SQL DM Hosts SQL Instance</Name>
          <Description>This shows the relationship between a SQL DM Installation (monitoring service) and a monitored SQL Server instance</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInst.DMAlert.Collection.Rule">
          <Name>Idera SQLDM Rule to Collect SqlInstance DM Alerts as Events</Name>
          <Description>This rule gathers SQL DM recorded Alert status changes and records them as Events within Operations Manager.  Each event is associated with the SQL Instance to which it relates.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInstance">
          <Name>SQL Instance</Name>
          <Description>This object represents a SQL Instance being monitored by a Idera SQL Diagnostic Manager service installation.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInstance" SubElementID="InstanceName">
          <Name>Instance Name</Name>
          <Description>This is the name of the monitored SQL Server instance.  If it is the default instance then it consists only of the Windows server name.  If it is a named instance then it is in the format "Server\Instance"</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInstance" SubElementID="MaintenanceModeEnabled">
          <Name>MaintenanceModeEnabled</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInstance" SubElementID="RealServerName">
          <Name>Real Server Name</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInstance" SubElementID="ServerEdition">
          <Name>Server Edition</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInstance" SubElementID="ServerVersion">
          <Name>Server Version</Name>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInstance.Discovery">
          <Name>SQL DM Instance Discovery (PowerShell)</Name>
          <Description>This object discovers SQL Server Instances which are currently being monitored by a SQL DM installations.  The discovery runs on machines with SQL DM installations and examines the SQL DM database to identify managed instances.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInstance.Health">
          <Name>SQL Instance Health</Name>
          <Description>This node offers a view of the SQL Instances currently being monitored by Diagnostic Manager servers.  The health of each monitored instance is displayed, based on the current number of alerts raised by Diagnostic Manager for that instance.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.SqlInstance.LaunchConsoleTask">
          <Name>Launch SQL DM Console</Name>
          <Description>This task will launch the local copy of the SQL DM console, which will connect to the most recently used SQL DM Server.  Once launched, the console may be connected to an alternate SQL DM Server using the File menu option.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.Timed.PoSH.DMalert.Poller">
          <Name>Idera SQL DM Timed PoSH DMalert Poller</Name>
          <Description>Executes a PowerShell script on a schedule to read the Alerts since the last invocation, and pass each alert through as a property bag.</Description>
        </DisplayString>
        <DisplayString ElementID="Idera.SQLDM.Timed.PoSh.PropertyBagProvider">
          <Name>Idera SQL DM Timed Instance Status Provider</Name>
          <Description>This module runs on a schedule, using a PowerShell script to gather and forward the Alerts counts and details for all managed instances as OpsMgr PropertyBags.

The module can be used as part of larger modules to build a health workflow or to collect status count data</Description>
        </DisplayString>
		<DisplayString ElementID="Idera.SQLDM.DataSource.SqlInst.AlertData.MapToAlert_AlertMessageResourceID">
          <Name>{1}</Name>
          <Description>{0}</Description>
        </DisplayString>
      </DisplayStrings>
      <KnowledgeArticles>
        <KnowledgeArticle ElementID="Idera.SQLDM" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Idera SQL Diagnostic Manager, as a standalone solution, provides database administrators with deep insights into the availability and performance of SQL Servers.  The Idera SQL Diagnostic Manager Management Pack ensures vital SQL Server performance data and alerts monitored and tracked by Diagnostic Manager are integrated into Operations Manager and its application health models..</maml:para>
            </maml:section>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Configuration</maml:title>
              <maml:para>As a best practice, you should import the Windows Server Management Pack for the operating system(s) you are using to host SQL Diagnostic Manager. The SQL Diagnostic Manager Management Pack uses several of the classes created by the Windows Server Management Packs.</maml:para>
              <maml:para>The Management Pack requires that the Operations Manager agent have read-access to the SQL Diagnostic Manager SQL Database.  This access should be granted prior to installing the Management Pack and enabling discovery of SQL Diagnostic Manager installed instances</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="Idera.SQLDM.DMservice.CollSvcMonitor" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This monitor checks the health (running state) of the SQLdmCollectionService</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="Idera.SQLDM.DMservice.Discovery" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This object discovers SQL DM installations by examining the registry of all managed Windows computers.  When an instance is discovered, configuration data from the SQL DM registry area is gathered as properties of the discovered objects.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="Idera.SQLDM.DMservice.MgmtSvcMonitor" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This monitor checks the health (running state) of the SQLdmManagementService</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="Idera.SQLDM.DMservice.PredSvcMonitor" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>Checks the health (running state) of the SQLdmPredictiveAnalyticsService</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="Idera.SQLDM.Monitor.InstanceAlertCounts" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This monitor checks the current health of the SQL DM managed instance by examining the current active alert counts in the SQL DM DB</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="Idera.SQLDM.SqlInst.DMAlert.Collection.Rule" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This rule gathers SQL DM recorded Alert status changes and records them as Events within Operations Manager.  Each event is associated with the SQL Instance to which it relates.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="Idera.SQLDM.SqlInstance.Discovery" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Summary</maml:title>
              <maml:para>This object discovers SQL Server Instances which are currently being monitored by a SQL DM installations.  The discovery runs on machines with SQL DM installations and examines the SQL DM database to identify managed instances.</maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
      </KnowledgeArticles>
    </LanguagePack>
  </LanguagePacks>
</ManagementPack>